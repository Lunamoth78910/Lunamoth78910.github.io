(function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"==typeof globalThis?e||self:globalThis,e.OmniCookies=i())})(this,function(){'use strict';var k=Math.E,Be=Math.abs,Se=Math.sin,xe=Math.PI,Fe=Math.max,De=Math.floor,Ne=Math.pow,Re=Math.min;function e(e,i){var a=Math.log;void 0===i&&(i=Game.priceIncrease);var n=Game.cookies;n/=Game.modifyBuildingPrice(e.name,e.basePrice);var t=e.amount-e.free;return De(a(Ne(i,t)+(i-1)*n)/a(i)-e.amount)}function i(e,i,n,t){var s=Math.ceil;void 0===n&&(n=Game.priceIncrease);var o,r=Fe(0,e.amount-e.free);if(t){if(0>=r)return 0;r--,o=a(n,Fe(0,r-i),r)}else o=a(n,r,r+i-1);return o=Game.modifyBuildingPrice(e.name,o*e.basePrice),t&&(o*=e.getSellMultiplier()),s(o)}function a(e,i,a){if(0>e)return-1;if(0==e)return 0;if(1==e)return a-i;if(i==a)return Ne(e,i);var n=(Ne(e,i)-1)/(e-1),t=(Ne(e,a+1)-1)/(e-1);return t-n}function n(e,i){var a=Date.now()/1e3/(3600*e);return i&&(a+=(new Date().getTimezoneOffset()+60)/60/e),a%=1,2*(a*xe)}function t(e,i){if(e)for(var a,n=0,t=Object.keys(e);n<t.length;n++)a=t[n],a in i&&("boolean"==typeof e[a]&&"number"==typeof i[a]&&(e[a]=e[a]?0:2),i[a]=e[a])}function s(e){var i=Game.Upgrades["Milk selector"];i.icon=0==e?Game.Milk.icon:i.choicesFunction()[e].icon,Game.upgradesToRebuild=1}function o(e){return e.grandma&&e.grandma.bought?De(Game.Objects.Grandma.amount/(e.id-1)):-1}function r(e){var i=document.getElementById("centerArea");i.style.overflowY=e}function c(e,i){var a=setInterval(function(){Game.Objects[e].minigameLoaded&&(i(),clearInterval(a))},250)}function d(e){Game.Loader.assetsLoading[e]||Game.Loader.assetsLoaded[e]||(Game.Loader.assets[e]={},Game.Loader.Replace(e,e),Game.Loader.assetsLoading.push(e))}function u(e,i,a){var n=Math.cos,t=e+Se(-a.r)*-(a.h/2-a.o),s=i+n(-a.r)*-(a.h/2-a.o),o=Math.sqrt(t*t+s*s),r=Math.atan2(s,t),c=r-a.r,d=n(c)*o,u=Se(c)*o;return!!(d>-.5*a.w&&d<.5*a.w&&u>-.5*a.h&&u<.5*a.h)}function m(e){console.warn("[Omniscient Cookies] "+e)}function p(e,i){function a(){this.constructor=e}Ze(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}function g(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var o=Array(e),r=0,n=0;n<t;n++)for(var c=arguments[n],a=0,d=c.length;a<d;a++,r++)o[r]=c[a];return o}function f(e,i){var a=Be((e-1)/i%1),n=e/i;return De(n-a)<n&&(n+=1),De(n)}var Ee,We="v2.1.1",qe={lastMilk:-1,lastAutoMilk:void 0,buffsById:[],cursedPs:0,cursedPsMult:0,ascendMeterLevel:void 0,ascendMeterPercent:void 0,levelDiff:0,patchedTrueCyclius:!1,prevShortcut:0,prestigeCookies:{},skipModifyPrice:!1,bannedGrandmas:{}};(function(e){e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL"})(Ee||(Ee={}));var ze,He=Object.freeze({__proto__:null,get ButtonType(){return Ee},calcMaxBuyBulk:function(a,n,t){void 0===t&&(t=Game.priceIncrease);var s=0,o=0,r=0;return(-1==n&&(n=1/0),Game.cookies==1/0&&n==1/0)?{totalPrice:1/0,maxPrice:1/0,maxAmount:n}:(s=i(a,n,t),r=Re(n,e(a,t)+a.free),o=i(a,r,t),{totalPrice:s,maxPrice:o,maxAmount:r})},quickCalcMaxBuy:e,quickCalcBulkPrice:i,powerSumRange:a,cycliusCalc:n,loadData:t,switchMilkIcon:s,getNumSynergyGrandmas:o,gainInstantPassiveCpS:function(e){for(var i,a=Game.cookiesPs*e,n=0,t=Game.wrinklers;n<t.length;n++)i=t[n],2==i.phase&&(i.sucked+=a*Game.cpsSucked,Game.cookiesSucked+=a*Game.cpsSucked);a*=1-Game.cpsSucked;for(var s,o=0,r=Game.ObjectsById;o<r.length;o++)s=r[o],s.totalCookies+=s.storedTotalCps*Game.globalCpsMult*e;Game.Earn(a)},scrollbarStyle:r,onMinigameLoaded:c,loadCustomAsset:d,holdingButton:function(e){return Game.keys[e]==null?0:Game.keys[e]},inRect:u});(function(e){e[e.Default=0]="Default",e[e.Fast=1]="Fast",e[e.Fancy=2]="Fancy"})(ze||(ze={}));var Xe=function(){function e(){this.version=We,this.autoScrollbar=!0,this.scrollingBuildings=!0,this.smoothBuildings=!0,this.buffTooltipDuration=!0,this.betterBuildingTooltips=!0,this.betterGrandmas=!0,this.separateTechs=!0,this.enhancedBulk=!0,this.buildingsBypassFancy=ze.Default,this.cursorsBypassFancy=ze.Default,this.wrinklersBypassFancy=ze.Default,this.optimizeBuildings=!1,this.preserveWrinklers=!1,this.detailedCyclius=!0,this.zonedCyclius=!1,this.trueCyclius=!1,this.stockValueData=!0,this.dangerousStocks=!1,this.tooltipWobble=!1,this.fancyMilkSelect=!0,this.improveMagicMeter=!0,this.skruuiaRebalance=!1,this.improveAscendMeter=!0,this.displaySeasons=!0,this.separateSeasons=!1,this.bringGrandmaToWork=!0,this.cursedFinger=!1,this.optiCookies=!1,this.dangerousBrokers=!1,this.heavenlyCookies=!0,this.buildingPriceBuff=!1}return e.prototype.set=function(e,i){typeof i==typeof this[e]&&(this[e]=i)},e.prototype.get=function(e){return this[e]},e.prototype.save=function(){return this},e.prototype.load=function(e){e.version&&t(e,this)},e}(),$e=new Xe,Ye=function(){function e(){this.version=We,this.stockAverages=[],this.frozenWrinks=null}return e.prototype.save=function(){return this.cryosleepWrinklers(),this},e.prototype.load=function(e){t(e,this),this.thawWrinklers()},e.prototype.reset=function(){this.stockAverages=[],this.frozenWrinks=null},e.prototype.cryosleepWrinklers=function(){this.frozenWrinks=$e.preserveWrinklers?Game.wrinklers:null},e.prototype.thawWrinklers=function(){if($e.preserveWrinklers&&this.frozenWrinks){var e=Game.wrinklers,i=Game.SaveWrinklers();Game.wrinklers=this.frozenWrinks;var a=Game.SaveWrinklers();if(i.number!=a.number||i.shinies!=a.shinies)return;for(var n,t=0,s=Game.wrinklers;t<s.length;t++)n=s[t],2==n.phase&&(n.sucked+=Game.cookiesPs/Game.fps*Game.cpsSucked*Game.loopT);a=Game.SaveWrinklers();var o=0==i.amount||0==a.amount?i.amount==a.amount?1:0:Re(i.amount/a.amount,a.amount/i.amount),r=0==i.amountShinies||0==a.amountShinies?i.amountShinies==a.amountShinies?1:0:Re(i.amountShinies/a.amountShinies,a.amountShinies/i.amountShinies),c=.99;if(o<c||r<c)return void(Game.wrinklers=e)}},e}(),Ve=new Ye,Ke=Object.freeze({__proto__:null,log:function(e){console.log("[Omniscient Cookies] "+e)},warn:m,error:function(e){console.error("[Omniscient Cookies] "+e)}}),Ze=function(e,i){return Ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var a in i)i.hasOwnProperty(a)&&(e[a]=i[a])},Ze(e,i)},Je="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,Qe=function(e,i){return i={exports:{}},e(i,i.exports),i.exports}(function(i){(function(a,e){i.exports=e()})(Je,function(){function xe(a,e){function n(){this.constructor=a}N(a,e),a.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Ee(c,e,n,u){return new(n||(n=Promise))(function(i,a){function o(i){try{s(u.next(i))}catch(e){a(e)}}function t(i){try{s(u["throw"](i))}catch(e){a(e)}}function s(a){a.done?i(a.value):new n(function(e){e(a.value)}).then(o,t)}s((u=u.apply(c,e||[])).next())})}function We(t,e){function n(a){return function(e){return i([a,e])}}function i(a){if(o)throw new TypeError("Generator is already executing.");for(;g;)try{if(o=1,u&&(m=2&a[0]?u["return"]:a[0]?u["throw"]||((m=u["return"])&&m.call(u),0):u.next)&&!(m=m.call(u,a[1])).done)return m;switch((u=0,m)&&(a=[2&a[0],m.value]),a[0]){case 0:case 1:m=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++,u=a[1],a=[0];continue;case 7:a=g.ops.pop(),g.trys.pop();continue;default:if((m=g.trys,!(m=0<m.length&&m[m.length-1]))&&(6===a[0]||2===a[0])){g=0;continue}if(3===a[0]&&(!m||a[1]>m[0]&&a[1]<m[3])){g.label=a[1];break}if(6===a[0]&&g.label<m[1]){g.label=m[1],m=a;break}if(m&&g.label<m[2]){g.label=m[2],g.ops.push(a);break}m[2]&&g.ops.pop(),g.trys.pop();continue;}a=e.call(t,g)}catch(e){a=[6,e],u=0}finally{o=m=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var o,u,m,p,g={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return p={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(p[Symbol.iterator]=function(){return this}),p}function qe(){for(var i=0,s=0,u=arguments.length;s<u;s++)i+=arguments[s].length;for(var o=Array(i),t=0,s=0;s<u;s++)for(var m=arguments[s],d=0,p=m.length;d<p;d++,t++)o[t]=m[d];return o}function ze(i){return i.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function a(s,r){var n=null===r[0],i=/(?:)/;null!==r[0]&&(i="string"==typeof r[0]?new RegExp(ze(r[0]),"g"):r[0],!i.test(s)&&console.warn("Nothing to inject."));var c=/(\)[^{]*{)/,a=/(}?)$/;switch(r[2]){case"before":s=n?s.replace(c,"$1"+r[1]):s.replace(i,""+r[1]+r[0]);break;case"replace":s=n?r[1]:s.replace(i,r[1]);break;case"after":s=n?s.replace(a,r[1]+"$1"):s.replace(i,""+r[0]+r[1]);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}return s}function t(t,e,n,i,o){void 0===o&&(o={});var c=Function.apply(void 0,qe(Object.keys(o),["return ("+a(t.toString(),[e,n,i])+")"])).apply(void 0,Object.values(o));return c.prototype=t.prototype,c}function s(t,e,n){void 0===n&&(n={});for(var u,m=t.toString(),p=0,g=e;p<g.length;p++)u=g[p],m=a(m,u);var d=Function.apply(void 0,qe(Object.keys(n),["return ("+m+")"])).apply(void 0,Object.values(n));return d.prototype=t.prototype,d}function He(i,e){for(var a in e)i[a]=e[a]}function c(i){return i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()}function u(i,e){return i.hasOwnProperty(e)}function r(t){for(var s,c=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],i="",d=0,u=c;d<u.length;d++)for(s=u[d];t>=s[0];)i+=s[1],t-=s[0];return i}function p(i){switch(i){case"mod":return{achievements:{},buildings:{},upgrades:{}};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!");}}function d(){return{mods:{},foreign:p("mod"),saveVer:1,dragon:p("dragon")}}function i(){Me.save=q=d()}function Xe(i){return q.foreign.buildings[i.name]||p("building")}function o(c){var e=c.amount,n=c.bought,i=c.free,o=c.totalCookies,a=c.level,r=c.muted,t=c.minigameSave,s=c.name;q.foreign.buildings[s]={amount:e,bought:n,free:i,totalCookies:o,level:a,muted:r,minigameSave:t}}function m(i){return q.foreign.upgrades[i.name]||p("upgrade")}function e(i){q.foreign.upgrades[i.name]={unlocked:!!i.unlocked,bought:!!i.bought}}function g(i){return q.foreign.achievements[i.name]||p("achievement")}function n(i){q.foreign.achievements[i.name]={won:!!i.won}}function f(){"sync"!==q.dragon.level&&q.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=q.dragon.level),"sync"!==q.dragon.auras[0]&&q.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=q.dragon.auras[0]),"sync"!==q.dragon.auras[1]&&q.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=q.dragon.auras[1])}function k(){for(var c,u=0,p=Me.customBuildings;u<p.length;u++)c=p[u],He(c,Xe(c));for(var i,k=0,h=Me.customUpgrades;k<h.length;k++)i=h[k],He(i,m(i)),i.bought&&Game.CountsAsUpgradeOwned(i.pool)&&Game.UpgradesOwned++;for(var r,b=0,y=Me.customAchievements;b<y.length;b++)r=y[b],He(r,g(r)),r.won&&Game.CountsAsAchievementOwned(r.pool)&&Game.AchievementsOwned++;f()}function h(){for(var c,u=0,m=Me.customBuildings;u<m.length;u++)c=m[u],o(c);for(var i,p=0,g=Me.customUpgrades;p<g.length;p++)i=g[p],e(i);for(var r,f=0,k=Me.customAchievements;f<k.length;f++)r=k[f],n(r)}function b(a){var e=d();if("object"!=typeof a||null===a)return e;if(!u(a,"saveVer")||"number"!=typeof a.saveVer||1<a.saveVer)return e;if(e.foreign=u(a,"foreign")?function(c){var e=p("mod");if("object"!=typeof c||null===c)return e;if(u(c,"buildings")&&"object"==typeof c.buildings&&null!==c.buildings)for(var n in c.buildings){var i=c.buildings[n];if("object"==typeof i&&null!==i)for(var o in e.buildings[n]=p("building"),i)typeof e.buildings[n][o]==typeof i[o]&&(e.buildings[n][o]=i[o])}if(u(c,"upgrades")&&"object"==typeof c.upgrades&&null!==c.upgrades)for(var m in c.upgrades){var r=c.upgrades[m];if("object"==typeof r&&null!==r)for(var o in e.upgrades[m]=p("upgrade"),e.upgrades[m])typeof e.upgrades[m][o]==typeof r[o]&&(e.upgrades[m][o]=r[o])}if(u(c,"achievements")&&"object"==typeof c.achievements&&null!==c.achievements)for(var t in c.achievements){var s=c.achievements[t];if("object"==typeof s&&null!==s)for(var o in e.achievements[t]=p("achievement"),e.achievements[t])typeof e.achievements[t][o]==typeof s[o]&&(e.achievements[t][o]=s[o])}return e}(a.foreign):p("mod"),u(a,"dragon")&&"object"==typeof a.dragon&&null!==a.dragon&&(u(a.dragon,"level")&&("number"==typeof a.dragon.level||"sync"===a.dragon.level)&&(e.dragon.level=a.dragon.level),u(a.dragon,"auras")&&a.dragon.auras instanceof Array))for(var n in a.dragon.auras){var t=a.dragon.auras[n];("number"==typeof t||"sync"===t)&&(e.dragon.auras[n]=t)}return e}function y(a){var e;try{e=JSON.parse(a)}catch(e){""!==a&&console.warn("CPPKIES: Found invalid save, creating new one..."),i()}q=Me.save=b(e),k()}function v(){return h(),JSON.stringify(q)}function O(i,e){H[i]=e}function w(i){if(X.includes(i))throw new Error("Recursive alias");return(X.push(i),i in H)?w(H[i]):(X=[],i)}function S(a){return new Promise(function(e){var n=new Image;n.addEventListener("load",function(){e(n)}),n.crossOrigin="Anonymous",n.src=a})}function j(i){return new Promise(function(a){i.canvas.toBlob(function(i){a(URL.createObjectURL(i))})})}function C(m,t,e,n,o,a){return new Promise(function(i){e[0]instanceof Array||(e=[e]),e=e;var r={};for(var s in e)for(var d in e[s])if(e[s][d]){if(e[s][d]=e[s][d].toString().toLowerCase(),!(e[s][d]in t))throw new Error("Invalid icon name");r[e[s][d]]=[parseInt(d),parseInt(s)]}var c=document.createElement("canvas").getContext("2d"),u=new Image;u.addEventListener("load",function(){for(var s in c.canvas.width=o[0],c.canvas.height=o[1],r)c.drawImage(u,r[s][0]*n[0],r[s][1]*n[1],n[0],n[1],t[s][0]*n[0],t[s][1]*n[1],n[0],n[1]);var e,m=function(){j(c).then(i)};a&&(e=a(c)),e instanceof Promise?e.then(m):m()}),u.crossOrigin="Anonymous",u.src=m})}function G(i){return i=qe(i),(void 0===i[2]||null===i[2])&&(i[2]=Me.iconLink),i[2]=w(i[2]),i}function M(a){var e=new _,n=[new R("tooltip",function(){a.tooltip=t(t(a.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new R("buy",function(){a.buy=t(a.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new R("levelUp",function(){a.levelUp=t(a.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:a})})];n.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Me.hooks.on("buildingCps",function(n){return{building:n.building,cps:Game.Objects[n.building]===a?e.emit("cps",n.cps):n.cps}}),Z[a.name]=e}function B(){for(var a,t=0,s=Game.ObjectsById;t<s.length;t++)a=s[t],Z[a.name]||M(a)}function P(i){return"fortune"===i.tier}function T(i){for(var e,t=1,s=1;s<=i;s++)t+=null!==(e=de[s])&&void 0!==e?e:de["default"];return 9*U(10,t)}function L(){Me.on("getIcon",function(a){var t=a.icon,e=a.type,i=a.tier;return Me.customTiers.forEach(function(a){a.keyName===i.toString()&&a.iconLink&&(t[2]=a.iconLink)}),{icon:t,type:e,tier:i}}),Me.on("getIcon",function(a){var t=a.icon,n=a.type,e=a.tier;return Me.customBuildings.forEach(function(i){i.name===n&&i.iconLink&&(t[2]=i.iconLink)}),{icon:t,tier:e,type:n}}),Me.on("getIcon",function(a){var e=a.icon,n=a.type,i=a.tier;return void 0!==e[2]&&null!==e[2]||u(Game.Tiers[i.toString()],"iconLink")||(e[2]=""),{icon:e,tier:i,type:n}}),Me.on("preSave",function(){if(0!==Game.dragonAura&&(q.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(q.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof je&&(q.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof je&&(q.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=E)for(q.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=E;)Game.dragonLevel--}),Me.on("postSave",function(){"sync"!==q.dragon.auras[0]&&Game.dragonAuras[q.dragon.auras[0]]&&(Game.dragonAura=q.dragon.auras[0]),"sync"!==q.dragon.auras[1]&&Game.dragonAuras[q.dragon.auras[1]]&&(Game.dragonAura2=q.dragon.auras[1]),"sync"!==q.dragon.level&&Game.dragonLevels[q.dragon.level]&&(Game.dragonLevel=q.dragon.level)}),Me.on("reset",function(){q.dragon.auras=["sync","sync"],q.dragon.level="sync"}),Me.on("specialPic",function(a){var e,t=Game.dragonLevels[Game.dragonLevel];return"dragon"===a.tab&&t instanceof Te&&(a.pic=null!==(e=t.picLink)&&void 0!==e?e:a.pic),a})}var x,A=Be,I=De,F=Re,U=Ne,D=Fe,N=function(i,e){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,e){i.__proto__=e}||function(a,e){for(var n in e)e.hasOwnProperty(n)&&(a[n]=e[n])},N(i,e)},_=function(){function i(){this._events={}}return i.prototype.on=function(i,e){this._events[i]?this._events[i].push(e):this._events[i]=[e]},i.prototype.once=function(a,e){var n=this;this.on(a,function(i){return n.off(a,e),e(i)})},i.prototype.off=function(i,e){this._events[i].splice(this._events[i].indexOf(e),1)},i.prototype.emit=function(s){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var c=e[0];this._events[s]||(this._events[s]=[]);for(var d,u=0,m=this._events[s];u<m.length;u++)d=m[u],c=d(c);return c},i.prototype.constEmit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._events[t]||(this._events[t]=[]);for(var s,c=0,d=this._events[t];c<d.length;c++)s=d[c],s(e[0])},i}(),R=function(){return function(i,e){this.value=i,this.func=e}}(),E=Game.dragonLevels.length+0,q=d(),H={},X=[],$={},z={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},Y={},V={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},Z={},ee=[],ie=function(h){function e(i,e,n,a,o,t,s,r,c,d){var u,p,y=this;if(Game.Objects[i])throw new Error("Can't create building, \""+i+"\" is already used as a building name");0!==a[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==o[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),y=h.call(this,i,e,n,o[1],a[0],t,0,s,r)||this,ee.push(y),Z[i]||M(y);var O=function(a){if(0>=parseInt(a))return"continue";var t=Game.ObjectsById[a];if(t.canvas=l("rowCanvas"+a),!t.canvas)return"continue";if(t.ctx=t.canvas.getContext("2d"),t.canvas.addEventListener("mouseover",function(){t.mouseOn=!0}),t.canvas.addEventListener("mouseout",function(){t.mouseOn=!1}),t.canvas.addEventListener("mousemove",function(a){var i=t.canvas.getBoundingClientRect();t.mousePos[0]=a.pageX-i.left,t.mousePos[1]=a.pageY-i.top}),t.minigame&&t.minigameLoaded){var e=t.minigame.save();t.minigame.launch(),t.minigame.load(e)}};for(var b in Game.ObjectsById)O(b);y.buildingLink=null!==(u=o[2])&&void 0!==u?u:Me.buildingLink,y.iconLink=w(null!==(p=a[2])&&void 0!==p?p:Me.iconLink),c&&(Game.foolObjects[i]=c),d&&(Game.goldenCookieBuildingBuffs[i]=d),y.iconLink&&Z[y.name].on("tooltip",function(i){return y.locked?i:i.replace("background-position","background-image:url("+y.iconLink+");background-position")}),Game.BuildStore(),y.buildingLink&&Me.hooks.on("buildStore",function(){l("productIcon"+y.id).style.backgroundImage="url("+y.buildingLink+")",l("productIconOff"+y.id).style.backgroundImage="url("+y.buildingLink+")"}),Game.BuildStore(),y.canvas=l("rowCanvas"+y.id),y.ctx=y.canvas.getContext("2d"),y.pics=[];var G=document.createElement("div");G.className="tinyProductIcon",G.id="mutedProduct"+y.id,G.style.display="none",y.buildingLink&&(G.style.backgroundImage="url("+y.buildingLink+")"),G.style.backgroundPositionX="-"+a[0]+"px",G.style.backgroundPositionY="-"+a[1]+"px",G.addEventListener("click",function(){y.mute(0),window.PlaySound(y.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(y.canvas,"mouseover",function(){y.mouseOn=!0}),window.AddEvent(y.canvas,"mouseout",function(){y.mouseOn=!1}),y.canvas.addEventListener("mousemove",function(i){var a=y.canvas.getBoundingClientRect();y.mousePos[0]=i.pageX-a.left,y.mousePos[1]=i.pageY-a.top}),l("buildingsMute").appendChild(G);var f=Xe(y);for(var b in f)y[b]=f[b];return Game.recalculateGains=1,y}return xe(e,h),e}(Game.Object),ae=[],ne=function(u){function e(i,e,n,a,o){void 0===o&&(o=function(){});var r=u.call(this,i,"function"==typeof e?"":e,"function"==typeof n?0:n,"function"==typeof a?[0,0]:G(a),o)||this;"function"==typeof e&&(r.descFunc=e),"function"==typeof n&&(r.priceFunc=n),"function"==typeof a&&(r.iconFunction=function(){return G(a())}),ae.push(r);var s=m(r);for(var d in s)r[d]=s[d];return Game.upgradesToRebuild=1,r.bought&&Game.CountsAsUpgradeOwned(r.pool)&&Game.UpgradesOwned++,r}return xe(e,u),e}(Game.Upgrade),te=function(c){function e(n,e,i,o,a,r,u){void 0===r&&(r=["Legacy"]),void 0===u&&(u=function(){});var m=c.call(this,n,e,i,o,u)||this;return m.pool="prestige",m.posX=a[0],m.posY=a[1],m.parents=r.map(function(i){return Game.Upgrades[i]||Game.UpgradesById[i]}),Game.PrestigeUpgrades.push(m),Game.UpgradePositions[m.id]=a,m}return xe(e,c),e}(ne),se=function(t){function e(n,e,i,s){var d=this;return"string"==typeof i&&(i=Game.Objects[i]),d=t.call(this,n,c(i.plural)+" are <b>twice</b> as efficient.<q>"+e+"</q>",i.basePrice*Game.Tiers[s].price,Game.GetIcon(i.name,s))||this,Game.SetTier(i.name,s),d.buildingTie1=i,P(d)&&(d.order=19e3,i.fortune=d),isNaN(parseInt(s.toString()))||(s=parseInt(s.toString())),"number"==typeof s&&(d.order=100*(i.id+1)+d.id/1e3,d.order-=75*D(0,F(i.id-4,3)),8<=i.id&&(d.order-=75)),"fortune"===s&&Game.Tiers[s].upgrades.push(d),i.buyFunction.apply(i),d}return xe(e,t),e}(ne),oe=function(a){function e(n,e,i,d){var u=this;if(d){if(!d.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+d+"\", URL must end with .png");d=d.substring(0,d.length-4)}"string"==typeof i&&(i=Game.Objects[i]);var m=i.id-1;return 1===m?m="grandma":m+=" grandmas",u=a.call(this,n,"Grandmas are <b>twice</b> as efficient. "+c(i.plural)+" gain <b>+1% CpS</b> per "+m+".<q>"+e+"</q>",i.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,i.grandma=u,u.buildingTie=i,u.order=250+u.id/1e3,12<=i.id&&(u.order+=5),Game.GrandmaSynergies.push(u.name),d&&Me.hooks.on("grandmaPic",function(i){return u.bought?qe(i,[d]):i}),Game.Objects.Grandma.redraw(),i.buyFunction.apply(i),u}return xe(e,a),e}(ne),re=function(u){function e(n,e,i,m,p){var r=this;"string"==typeof i&&(i=Game.Objects[i]),"string"==typeof m&&(m=Game.Objects[m]);var g=Game.GetIcon(i.name,p);if(i.basePrice>m.basePrice){var s=i;i=m,m=s}return r=u.call(this,n,c(i.plural)+" gain <b>+5% CpS</b> per "+m.name.toLowerCase()+".<br>"+c(m.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+i.name.toLowerCase()+".<q>"+e+"</q>",(10*i.basePrice+1*m.basePrice)*Game.Tiers[p].price,g)||this,r.tier=p,r.buildingTie1=i,r.buildingTie2=m,r.order=5e3+r.id/1e3,i.synergies.push(r),m.synergies.push(r),Game.Tiers[p].upgrades.push(r),Game.RebuildUpgrades(),i.buyFunction.apply(i),r}return xe(e,u),e}(ne),le=[5,7,8,9,10],ce=function(c){function e(n,e,i,o){void 0===o&&(o=20);var d=this,u=Game.Objects.Cursor,t=parseInt(i.toString());return d=c.call(this,n,"Multiplies the gain from Thousand fingers by <b>"+o+"</b>.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(t)?u.basePrice*Game.Tiers[i].price:U(10,le[F(t-4,le.length-1)]+3*D(t-8,0)),Game.GetIcon(u.name,i))||this,d.tier=i,d.pool="",d.order=100+d.id/1e3,Me.on("cursorFingerMult",function(i){return d.bought?i*o:i}),Game.Tiers[i].special||isNaN(t)||Me.buildingHooks.Cursor.on("buy",function(){u.amount>=(4===t?25:50*(t-4))&&Game.Unlock(d.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(d),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),d}return xe(e,c),e}(ne),de={1:5,2:4,4:4,default:3},ue=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],me=function(c){function e(n,e,i,o,d,r){void 0===o&&(o=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:ue[(parseInt(i.toString())-1)%(ue.length-1)]),void 0===r&&(r=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:1===i?.5:i-1);var u=c.call(this,n,"You gain <b>more CpS</b> the more milk you have.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null!==d&&void 0!==d?d:0:T(i),Game.GetIcon("Kitten",i))||this;return u.tier=i,u.kitten=!0,u.pool="",null===o&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[i].special||isNaN(parseInt(i.toString())))&&void 0===d&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==r&&Me.on("logic",function(){Game.milkProgress>=r&&Game.Unlock(u.name)}),u.order=2e4+u.id/1e3,null!==o&&Me.on("rawCpsMult",function(i){var e=u.bought?1+Game.milkProgress*o*Me.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=e,i*e}),Game.UpgradesByPool.kitten.push(u),"fortune"===i&&Game.Tiers[i].upgrades.push(u),u}return xe(e,c),e}(ne),pe=function(s){function e(n,e,i,o){void 0===o&&(o=1);var c=s.call(this,n,"Clicking gains <b>+"+o+"% of your CpS</b>.<q>"+e+"</q>",U(10,3+2*parseInt(i.toString())),Game.GetIcon("Mouse",i))||this;c.tier=i,c.pool="";var r=parseInt(i.toString());return c.order=150+c.id/1e3,Me.on("cpcAdd",function(i){return c.bought?i+Game.cookiesPs*o/100:i}),Game.Tiers[i].special||isNaN(r)||Me.on("check",function(){Game.handmadeCookies>=U(10,1+2*r)&&Game.Unlock(c.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(c),c}return xe(e,s),e}(ne),ge=function(u){function e(n,e,i,o,a,r,t){var s,m=u.call(this,n,"Cookie production multiplier <b>+"+Beautify("function"==typeof a?a():a,1)+"%</b>.<q>"+e+"</q>",i,o)||this;return m.power=a,m.pool="cookie",m.order=(null!==(s=null!==t&&void 0!==t?t:Me.cookieOrder)&&void 0!==s?s:10020)+m.id/1e3,m.unlockAt={name:n,cookies:("function"==typeof i?i():i)/20,require:null===r||void 0===r?void 0:r.require,season:null===r||void 0===r?void 0:r.season},Game.UnlockAt.push(m.unlockAt),Game.UpgradesByPool.cookie.push(m),Game.cookieUpgrades.push(m),m}return xe(e,u),e}(ne),ke=[],fe=function(){return function(u,e,n,i,m,p,g,f,k){void 0===i&&(i=!1),void 0===m&&(m="auto"),void 0===p&&(p=null),void 0===g&&(g=null),void 0===f&&(f=null),void 0===k&&(k="auto");var h;this.name=u,this.color=n,this.special=i,this.keyName="auto"===k?i?u:(Object.keys(Game.Tiers).filter(function(i){return!isNaN(parseInt(i))}).length+1).toString():k,null===p&&(this.unlock=-1),"number"==typeof p&&(this.unlock=p),(!1===i&&null===p||"auto"===p)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof g&&(this.achievUnlock=g),(!1===i&&null===g||"auto"===g)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),f&&(this.req=f),this.price="auto"===m?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(i){return!isNaN(parseInt(i))}).length.toString()].price:m,this.iconRow=e[1],this.iconLink=w(null!==(h=e[2])&&void 0!==h?h:Me.iconLink),Game.Tiers[this.keyName]=this,ke.push(this)}}(),he=[],be=function(t){function e(n,e,i){var s=t.call(this,n,e,G(i))||this;return He(s,g(s)),he.push(s),s.won&&Game.CountsAsAchievementOwned(s.pool)&&Game.AchievementsOwned++,s}return xe(e,t),e}(Game.Achievement),ye=function(t){function e(n,e,i,s){void 0===s&&(s=U(10,I(1.5*Game.BankAchievements.length+2)));var o=t.call(this,n,"Bake <b>"+toFixed(s)+"</b> cookie"+(1===A(s)?"":"s")+" in one ascension."+(i?"<q>"+i+"</q>":""),e)||this;return o.treshold=s,o.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(o),o}return xe(e,t),e}(be),ve=function(t){function e(n,e,i,s){void 0===s&&(s=U(10,I(1.2*Game.BankAchievements.length)));var o=t.call(this,n,"Bake <b>"+toFixed(s)+"</b> cookie"+(1===A(s)?"":"s")+" per second."+(i?"<q>"+i+"</q>":""),e)||this;return o.treshold=s,o.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(o),o}return xe(e,t),e}(be),Ce=function(c){function e(n,e,i,o){var a=this,u="object"==typeof i?i:Game.Objects[i],t=null,m=-1;if(0===u.id){switch(o){case"cursor2":t=[0,6],m=2;break;case"cursor50":t=[1,6],m=50;break;default:if(0>=Game.Tiers[o].achievUnlock){console.warn("Tier has invalid unlock amount");break}m=1===o?1:2*Game.Tiers[o].achievUnlock;}Me.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=m&&Game.Win(a.name)})}else m=Game.Tiers[o].achievUnlock;return a=c.call(this,n,"Have <b>"+m+"</b> "+(1===A(m)?u.single:u.plural)+"."+(e?"<q>"+e+"</q>":""),null!==t&&void 0!==t?t:Game.GetIcon(u.name,o))||this,Game.SetTier(u.name,"cursor2"===o||"cursor50"===o?1:o),u.tieredAchievs[o]=a,a.buildingTie=u,a.order=1e3+100*u.id+a.id/1e3,a.order-=75*D(0,F(u.id-4,3)),8<=u.id&&(a.order-=75),0===u.id&&(a.order+=50),a}return xe(e,c),e}(be),Oe=function(c){function e(n,e,u,o,a){var r=this;"string"==typeof e&&(e=Game.Objects[e]);var m=[e.iconColumn,21+u,e instanceof ie?e.iconLink:void 0],s=U(10,12+e.id+(null!==a&&void 0!==a?a:0)+7*(u-1));return r=c.call(this,n,"Make <b>"+toFixed(s)+"</b> cookies just from "+e.plural+"."+(o?"<q>"+o+"</q>":""),m)||this,r.order=1020+100*e.id+r.id/1e3,r.order-=75*D(0,F(e.id-4,3)),8<=e.id&&(r.order-=75),0===e.id&&(r.order+=50),e.productionAchievs.push({pow:s,achiev:r}),r}return xe(e,c),e}(be),we=function(t){function e(n,e,s){var o=this;"string"==typeof e&&(e=Game.Objects[e]);var c=[e.iconColumn,26,e instanceof ie?e.iconLink:void 0];return o=t.call(this,n,"Reach level <b>10</b> "+e.plural+"."+(s?"<q>"+s+"</q>":""),c)||this,o.order=1020+100*e.id+o.id/1e3,o.order-=75*D(0,F(e.id-4,3)),8<=e.id&&(o.order-=75),0===e.id&&(o.order+=50),e.levelAchiev10=o,o}return xe(e,t),e}(be),Se=function(t){function e(n,e,i){var s=this,o=parseInt(e.toString());return s=t.call(this,n,"Make <b>"+toFixed(U(10,1+2*o))+"</b> cookies from clicking."+(i?"<q>"+i+"</q>":""),Game.GetIcon("Mouse",e))||this,s.pool="normal",s.tier=e,s.order=1e3+s.id/1e3,Game.Tiers[e].special||isNaN(o)||Me.on("check",function(){Game.handmadeCookies>=U(10,1+2*o)&&Game.Win(s.name)}),s}return xe(e,t),e}(be),je=function(){function i(a,e,n){this.name=a,this.desc=e,"string"==typeof n&&(n=Game.Objects[n]),this.pic=n instanceof Game.Object?G([n.iconColumn,25,n instanceof ie?n.iconLink:void 0]):n,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==q.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=q.dragon.auras[0]&&(Game.dragonAura=q.dragon.auras[0]),"sync"!==q.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=q.dragon.auras[1]&&(Game.dragonAura2=q.dragon.auras[1])}return i}(),Te=function(){function c(e,n,i,o,a,r,t){void 0===t&&(t=Game.dragonLevels.length-3),this.buy=a,this.picY=0;var u=Game.dragonLevels[t-1];this.name=null!==e&&void 0!==e?e:u.name,this.action=n,this.costStr="string"==typeof i?function(){return i}:i,this.cost=o,r?(this.pic=r[0],this.picY=r[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=r[2]):(this.pic=u.pic,u instanceof c&&(this.picY=u.picY,this.picLink=u.picLink)),Game.dragonLevels.splice(t,0,this),"sync"!==q.dragon.level&&Game.dragonLevels.length>=q.dragon.level&&(Game.dragonLevel=q.dragon.level)}return c}(),Pe=function(t){function e(n,e,i){var s=this;return"string"==typeof i&&(i=Game.Objects[i]),s=t.call(this,null,"Train "+n+"<br/><small>Aura : "+e+"</small>","100 "+i.plural,function(){return 100<=i.amount},function(){return i.sacrifice(100)})||this,s}return xe(e,t),e}(Te),Le=function(){return function(a,e,n,i){if(void 0===i&&(i=!1),this.name=a,this.pic=n,this.special=i,!n.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+n+"\", the URL must end with .png!");i||(this.name="Rank "+r(Game.Milks.length+1)+" - "+a),this.pic=n.substr(0,n.length-4),G(e),this.icon=[e[0],e[1]],this.iconLink=e[2],i?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)}}(),Me={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:Z,buildingHooksById:[],hookAllBuildings:B,customBuildings:ee,customUpgrades:ae,customTiers:ke,save:q,onLoad:[],Building:ie,Upgrade:ne,TieredUpgrade:se,Tier:fe,HeavenlyUpgrade:te,GrandmaSynergy:oe,SynergyUpgrade:re,CursorUpgrade:ce,KittenUpgrade:me,MouseUpgrade:pe,CookieUpgrade:ge,Achievement:be,CpsAchievement:ve,BankAchievement:ye,TieredAchievement:Ce,ProductionAchievement:Oe,Level10Achievement:we,MouseAchievement:Se,customAchievements:he,DragonAura:je,DragonLevel:Te,DragonAuraLevel:Pe,Milk:Le,injectCode:t,injectCodes:s,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(i){return Game.GetTieredCpsMult(i)*Game.magicCpS(i.name)*i.baseCps},icons:{relinkColumn:function(u,e,a,o){return void 0===o&&(o=!1),Ee(this,void 0,void 0,function(){var t,i,i,r,m;return We(this,function(n){switch(n.label){case 0:for(i in void 0===a&&(!$[u]&&($[u]=0),a=$[u]++),t={},z)t[i]=[a,z[i][1]];for(i in Game.Tiers)t[Game.Tiers[i].name.toLowerCase()]=t[i.toString()]=[a,Game.Tiers[i].iconRow];return r=O,m=[u],[4,C(o?w(u):u,t,e,[48,48],[48*(a+1),48*(Object.values(t).reduce(function(i,e){return D(i,e[1])},-Infinity)+1)],function(e){return new Promise(function(a){if(w(u)!==u){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),a()}),i.src=w(u),i.crossOrigin="Anonymous"}else a()})})];case 1:return r.apply(void 0,m.concat([n.sent()])),[2];}})})},relinkRow:function(u,e,a,o){return void 0===o&&(o=!1),Ee(this,void 0,void 0,function(){var t,i,i,r,m;return We(this,function(n){switch(n.label){case 0:for(i in void 0===a&&(!Y[u]&&(Y[u]=0),a=Y[u]++),t={},V)t[i]=[V[i][0],a];for(i in Game.ObjectsById)t[Game.ObjectsById[i].single.toLowerCase()]=t[i]=[Game.ObjectsById[i].iconColumn,a];return r=O,m=[u],[4,C(o?w(u):u,t,e,[48,48],[48*(Object.values(t).reduce(function(i,e){return D(i,e[0])},-Infinity)+1),48*(a+1)],function(e){return new Promise(function(a){if(w(u)!==u){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),a()}),i.src=w(u),i.crossOrigin="Anonymous"}else a()})})];case 1:return r.apply(void 0,m.concat([n.sent()])),[2];}})})},patchIconsheet:function(y,e,i){var G;return void 0===i&&(i=!0),Ee(this,void 0,void 0,function(){var a,r,B,x,M,P,T,L,A,F,I,U,D,N,_;return We(this,function(n){switch(n.label){case 0:return a=document.createElement("canvas").getContext("2d"),[4,S(i?w(y):y)];case 1:for(r=n.sent(),B=[r.width,r.height],x=0,M=e;x<M.length;x++)P=M[x],48*P[0][0]>B[0]&&(B[0]=48*P[0][0]),48*P[0][1]>B[1]&&(B[1]=48*P[0][1]);a.canvas.width=B[0],a.canvas.height=B[1],a.drawImage(r,0,0),T={},L=0,A=e,n.label=2;case 2:return L<A.length?(F=A[L],I=w((null!==(G=F[1][2])&&void 0!==G?G:Me.iconLink)||"img/icons.png"),!!T[I])?[3,4]:(U=T,D=I,[4,S(I)]):[3,6];case 3:U[D]=n.sent(),n.label=4;case 4:a.clearRect(48*F[0][0],48*F[0][1],48,48),a.drawImage(T[I],48*F[1][0],48*F[1][1],48,48,48*F[0][0],48*F[0][1],48,48),n.label=5;case 5:return L++,[3,2];case 6:return N=O,_=[y],[4,j(a)];case 7:return N.apply(void 0,_.concat([n.sent()])),[2];}})})},extraColumnIcons:z,extraRowIcons:V,alias:O,aliases:H}};window.Cppkies?x=window.Cppkies:(x=Me,window.Cppkies=x,function(){return new Promise(function(a){var o=new _,e=[new R("customMenu",function(){Game.UpdateMenu=t(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","after")}),new R("preSave",function(){Game.WriteSave=t(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new R("postSave",function(){Game.WriteSave=t(Game.WriteSave,"if (type==2 || type==3)","\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"postSave\")\n\t\t\t\t\t","before")}),new R("reset",function(){Game.Reset=t(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.constEmit(\"reset\", hard)\n\t\t\t\t\t","before")}),new R("reincarnate",function(){Game.registerHook("reincarnate",function(){return o.emit("reincarnate")})}),new R("getIcon",function(){Game.GetIcon=s(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];","// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace"],["col=18;","else if (type === \"Mouse\") col = 11;","after"]])}),new R("buildStore",function(){Game.BuildStore=t(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new R("grandmaPic",function(){Game.Objects.Grandma.art.pic=t(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new R("cps",function(){Game.CalculateGains=s(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","// Cppkies injection\n\t\t\t\t\t\tmult = Cppkies.hooks.emit(\"cpsMult\", mult);\n","before"]]),Game.registerHook("cps",function(i){return o.emit("cps",i)})}),new R("cursorFingerMult",function(){Game.Objects.Cursor.cps=t(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before")}),new R("cpc",function(){Game.mouseCps=s(Game.mouseCps,[["var num=0;","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before"],["var out","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cpcAdd\", add);\n","before"]]),Game.registerHook("cookiesPerClick",function(i){return o.emit("cpc",i)})}),new R("buildingCps",function(){Game.CalculateGains=t(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")}),new R("logic",function(){Game.registerHook("logic",function(){return o.emit("logic")})}),new R("draw",function(){Game.registerHook("draw",function(){return o.emit("draw")})}),new R("check",function(){Game.registerHook("check",function(){return o.emit("check")})}),new R("ticker",function(){Game.getNewTicker=t(Game.getNewTicker,"Game.TickerAge=Game.fps*10;","// Cppkies injection\nlist = Cppkies.hooks.emit(\"ticker\", list);\n","before")}),new R("specialPic",function(){Game.DrawSpecial=t(Game.DrawSpecial,"if (hovered || selected)","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","before"),Game.ToggleSpecialMenu=t(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","after")})];e.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Game.Loader.Load=t(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=s(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]]),Game.ToggleSpecialMenu=s(Game.ToggleSpecialMenu,[[">=5",">=Game.dragonLevels.findIndex(val => val.name === \"Krumblor, cookie hatchling\")","replace"],[">=25",">=Game.dragonLevels.findIndex(val => val.action === \"Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>\") + 1","replace"]]),Game.Objects.Cursor.buyFunction=t(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=t(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=t(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),a(o)})}().then(function(i){x.hooks=i,x.on=i.on.bind(i),Game.Notify("Cppkies loaded!","",[32,17],1.5);var e=document.createElement("div");e.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(e,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:v,load:y}),Game.Win("Third-party"),B(),Me.onLoad.forEach(function(i){return i()}),Me.onLoad=new Proxy(Me.onLoad,{set:function(a,e,n){return"length"!==e&&n(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(i){return i()}),window.CPPKIES_ONLOAD=new Proxy(Me.onLoad,{set:function(a,e,n){return"length"!==e&&n(),!0}}),L()}));var Ge=x;return Ge})}),ei=function(){function e(e,i){this.patchFunc=e,this.removeFunc=i,this.applied=!1}return e.prototype.apply=function(){this.applied||(this.patchFunc(),this.applied=!0)},e.prototype.remove=function(){this.applied&&this.removeFunc&&(this.removeFunc(),this.applied=!1)},e.prototype.toggle=function(e){var i=!this.applied;"undefined"!=typeof e&&(i=e),i?this.apply():this.remove()},e}(),ii=new ei(function(){return r("auto")},function(){return r("scroll")}),ai=new ei(function(){Game.DrawBuildings=Qe.injectCode(Game.DrawBuildings,"Game.drawT%3==0","OmniCookies.settings.smoothBuildings || ","before")}),ni=new ei(function(){var e=[["if (this.toResize)","if (this.toResize || this.canvas.width != this.canvas.clientWidth || this.canvas.height != this.canvas.clientHeight)","replace"],["this.toResize=false;","$&;this.forceDraw=true;","replace"],["if (typeof(bg)=='string') ctx.fillPattern","let synergyAmount = OmniCookies.settings.bringGrandmaToWork ? OmniCookies.Util.getNumSynergyGrandmas(this) : -1;\n\t\t\tif(OmniCookies.settings.optimizeBuildings && !this.hasUnloadedImages && !this.forceDraw && !this.lastMouseOn && !this.mouseOn && (this.lastAmount == this.amount) && (this.name == 'Grandma' ? true : this.lastSynergyAmount == synergyAmount)) return;\n\t\t\tthis.forceDraw = false;\n\t\t\tthis.lastAmount = this.amount;\n\t\t\tthis.lastMouseOn = this.mouseOn;\n\t\t\tthis.lastSynergyAmount = synergyAmount;\n\t\t\tthis.hasUnloadedImages = Game.Loader.assetsLoaded.indexOf(this.art.bg) == -1;\n\t\t\tlet hasGrandmas = false;\n","before"],["var sprite=Pic(pic.pic);","\nthis.hasUnloadedImages = this.hasUnloadedImages || sprite == Game.Loader.blank;","after"],["0,0,this.canvas.width,this.canvas.height,128,128",",-this.scrollOffX","after"],["var maxI=Math.floor(this.canvas.width","var minI=Math.max(0, Math.floor((-50 + this.scrollOffX) / (w/rows)));\n\t\t\tvar maxI=Math.floor((this.canvas.width + 50 + this.scrollOffX)","replace"],["var i=this.pics.length;","this.pics = [];\nvar i=minI;","replace"],["var usedPic=(typeof(pic)=='string'?pic:pic(this,i));","x-=this.scrollOffX;\n","before"],["var selected=-1;","var speed = 20;\n\t\t\tif(!OmniCookies.settings.smoothBuildings) speed *= 3;\n\t\t\tif(this.mousePos[0] >= (this.canvas.width) - 100 && maxI <= this.amount + rows * 3) {\n\t\t\t\tthis.scrollOffX += Math.floor(speed * ((this.mousePos[0] - (this.canvas.width - 100)) / 100));\n\t\t\t}\n\t\t\tif(this.mousePos[0] <= 100 && this.scrollOffX > 0) {\n\t\t\t\tthis.scrollOffX -= Math.floor(speed * (1 - this.mousePos[0] / 100));\n\t\t\t}\n\t\t\tif(this.scrollOffX < 0 || !OmniCookies.settings.scrollingBuildings) this.scrollOffX = 0;\n","before"],["ctx.drawImage(sprite,Math.floor(pic.x+Math.random()*4-2),Math.floor(pic.y+Math.random()*4-2));","if(Game.drawT%3==0) {\n\t\t\t\tthis.lastRandX = Math.random()*4;\n\t\t\t\tthis.lastRandY = Math.random()*4;\n\t\t\t}\n\t\t\tctx.drawImage(sprite,Math.floor(pic.x+this.lastRandX-2),Math.floor(pic.y+this.lastRandY-2));","replace"],["this.pics.push({x:Math.floor(x),y:Math.floor(y),z:y,pic:usedPic,id:i,frame:frame});","\nif(OmniCookies.settings.bringGrandmaToWork) {\n\t\t\t\tlet grandmas = OmniCookies.GrandmaSupport.tryDrawGrandmas(this, this.pics[this.pics.length-1], i);\n\t\t\t\tif(grandmas && grandmas.length > 0){\n\t\t\t\t\thasGrandmas = true;\n\t\t\t\t\tthis.pics = this.pics.concat(grandmas);\n\t\t\t\t}\n\t\t\t}","after"],["if (this.name=='Grandma')","if (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && hasGrandmas))","replace"],["if (selected==i && this.name=='Grandma')","if (selected==i && (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && pic.grandma)))","replace"],["if (this.mousePos[0]>=pic.x-marginW && this.m","if(this.name == 'Grandma' ? false : !pic.grandma) continue;\n","before"],["/*+' '+pic.id*/","+(this.name == 'Grandma' ? '' : ' '+this.name)","replace"]],a=[["this.muted=val;","\nthis.forceDraw=true;","after"]],n=[["me.pics=[];","\nif(OmniCookies.settings.optimizeBuildings) {\n\t\t\t\tme.forceDraw = true;\n\t\t\t}","after"]];for(var t in Game.Objects){var i=Game.Objects[t];0!=i.id&&(i.scrollOffX=0,i.lastRandX=0,i.lastRandY=0,i.lastOffX=0,i.lastMouseOn=i.mouseOn,i.lastAmount=i.amount,i.lastSynergyAmount=0,i.hasUnloadedImages=!0,i.forceDraw=!0,i.draw=Qe.injectCodes(i.draw,e),i.mute=Qe.injectCodes(i.mute,a),i.redraw=Qe.injectCodes(i.redraw,n))}Game.Object=Qe.injectCodes(Game.Object,e),Game.Object=Qe.injectCode(Game.Object,"//building canvas","this.scrollOffX = 0;\n\t\tthis.lastRandX = 0;\n\t\tthis.lastRandY = 0;\n\t\tthis.lastOffX = 0;\n\t\tthis.lastMouseOn = this.mouseOn;\n\t\tthis.lastAmount = this.amount;\n\t\tthis.lastSynergyAmount = 0;\n\t\tthis.hasUnloadedImages = true;\n\t\tthis.forceDraw = true;\n","before"),Game.Object=Qe.injectCodes(Game.Object,a),Game.Object=Qe.injectCodes(Game.Object,n),Game.Objects.Grandma.art.pic=Qe.injectCode(Game.Objects.Grandma.art.pic,"return","for(let i = list.length; i > 0; i--) {\n\t\t\tlet gran = list[i];\n\t\t\tif(gran in OmniCookies.vars.bannedGrandmas) {\n\t\t\t\tlist.splice(i, 1);\n\t\t\t}\n\t\t}\n","before"),qe.bannedGrandmas={farmerGrandma:!0,workerGrandma:!0,minerGrandma:!0,cosmicGrandma:!0,transmutedGrandma:!0,alteredGrandma:!0,grandmasGrandma:!0,antiGrandma:!0,rainbowGrandma:!0,bankGrandma:!0,templeGrandma:!0,witchGrandma:!0,luckyGrandma:!0,metaGrandma:!0,alternateGrandma:!0}}),ti=new ei(function(){var e=[["if (synergiesStr!='') synergiesStr+=', ';","if (OmniCookies.settings.betterBuildingTooltips || synergiesStr != '')\n\t\t\t\tsynergiesStr += OmniCookies.settings.betterBuildingTooltips \n\t\t\t\t\t? '<br>&nbsp;&nbsp;&nbsp;&nbsp;- '\n\t\t\t\t\t: ', ';","replace"],["synergiesStr+=i+' +'+Beautify(synergiesWith[i]*100,1)+'%';","synergiesStr+=i+' '+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '<b>' : '')+\n\t\t\t'+'+Beautify(synergiesWith[i]*100,1)+'%'+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '</b>' : '');","replace"],["synergiesStr='...also boosting some other buildings : '+synergiesStr+' - all","synergiesStr='...also boosting some other buildings'+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips \n\t\t\t\t? ': '+synergiesStr+'<br>&bull; ' \n\t\t\t\t: ' : '+synergiesStr+' - ')+'all","replace"],["<div class=\"data\"","$& '+(OmniCookies.settings.betterBuildingTooltips ? 'style=\"white-space:nowrap;\"' : '')+'","replace"]];for(var a in Game.Objects){var i=Game.Objects[a];i.tooltip=Qe.injectCodes(i.tooltip,e)}Game.Object=Qe.injectCodes(Game.Object,e)}),si=new ei(function(){qe.buffsById=[];var e=function(e){var i=Game.buffs[e];qe.buffsById[i.id]=i;var a=Game.buffsL.getElementsByClassName("crate enabled buff")[i.id];a.removeAttribute("onmouseover"),a.onmouseover=function(){Game.mouseDown||(Game.setOnCrate(this),Game.tooltip.dynamic=1,Game.tooltip.draw(this,function(){return qe.GetBuffTooltipFunc(i.id)()},"left"),Game.tooltip.wobble())}};for(var a in Game.buffs)e(a);Game.gainBuff=Qe.injectCodes(Game.gainBuff,[["Game.buffsL.","OmniCookies.vars.buffsById[buff.id] = buff;\n","before"],["//new duration is set to new","var tempBuff=type.func(buff.time/Game.fps,arg1,arg2,arg3);\n\t\t\tbuff.desc = tempBuff.desc;","after"],[/Game\.getTooltip\([\s\S]+\):''\)\+' /,"Game.getDynamicTooltip('(OmniCookies.vars.GetBuffTooltipFunc('+buff.id+'))', 'left', true):'')+' ","replace"]]);var i=document.createElement("div");i.className="prompt";var n=document.createElement("h3");i.id="OmniCookies_width_test",i.appendChild(n),i.style.visibility="hidden",document.getElementById("game").appendChild(i),qe.GetBuffTooltipFunc=function(e){return function(){var i=qe.buffsById[e];n.textContent=i.name;var a=Fe(200,n.clientWidth+78),t=i.desc.replace(Game.sayTime(i.maxTime,-1),"$&"),s="<div class=\"prompt\" style=\"white-space:nowrap;min-width:"+a+"px;text-align:center;font-size:11px;margin:8px 0px;\"><h3>"+i.name+"</h3><div class=\"line\"></div>"+t;return $e.buffTooltipDuration&&(s+="<div class=\"line\"></div>"+Game.sayTime(i.time,-1)+" left"),s+="</div>",s}};var t=setInterval(function(){var e=Game.Objects["Wizard tower"].minigame;e&&(e.spells["stretch time"].win=Qe.injectCode(e.spells["stretch time"].win,"me.maxTime+=gain;","let timePattern = RegExp(Game.sayTime(me.maxTime,-1), 'g');\n\t\t\t\tme.desc = me.desc.replace(timePattern, Game.sayTime(me.maxTime + gain,-1));\n","before"),clearInterval(t))},250)}),oi=new ei(function(){for(var e=0,a=Game.GrandmaSynergies;e<a.length;e++){var n=a[e],i=Game.Upgrades[n];i.desc=i.desc.replace(/(efficient\.) /,"$1<br>"),i.baseDesc=i.desc}Game.Upgrades["Cosmic grandmas"].order+=.2,Game.Upgrades["Transmuted grandmas"].order+=.2,Game.Upgrades["Altered grandmas"].order+=.2,Game.Upgrades["Grandmas' grandmas"].order+=.2,Game.GrandmaSynergies.sort(function(e,i){return Game.Upgrades[e].order-Game.Upgrades[i].order});var t=Game.Upgrades["Script grannies"];t.buyFunction=t.buyFunction?Qe.injectCode(t.buyFunction,null,"Game.Objects['Grandma'].redraw();","before"):function(){Game.Objects.Grandma.redraw()},Game.Objects.Portal.tooltip=Qe.injectCode(Game.Objects.Portal.tooltip,"synergiesWith[other.plural]+=boost/(other.storedTotalCps*Game.globalCpsMult);","synergiesWith[other.plural]+=(me.amount*0.05)/other.baseCps;","replace"),Game.Objects.Grandma.tooltip=Qe.injectCode(Game.Objects.Grandma.tooltip,"for (var i in Game.GrandmaSynergies)","let selfBoost = 0;\n\t\tif(Game.Has('One mind')) selfBoost += (me.amount * 0.02)/me.baseCps;\n\t\tif(Game.Has('Communal brainsweep')) selfBoost += (me.amount * 0.02)/me.baseCps;\n\t\tif(selfBoost > 0) {\n\t\t\tif(!synergiesWith[me.plural]) synergiesWith[me.plural] = 0;\n\t\t\tsynergiesWith[me.plural] += selfBoost;\n\t\t}\n\t\tsynergyBoost += selfBoost;\n","before")}),ri=new ei(function(){Game.UpdateMenu=Qe.injectCodes(Game.UpdateMenu,[["var cookieUpgrades='';","\nvar techUpgrades = '';\n\t\t\tvar seasonalUpgrades = '';","after"],["else if (me.pool=='cookie'","else if (OmniCookies.settings.separateTechs && me.pool == 'tech') techUpgrades+=str2;\n\t\t\telse if(OmniCookies.settings.separateSeasons && me.unlockAt && (me.unlockAt.season || me.unlockAt.displaySeason)) seasonalUpgrades+=str2;\n","before"],["cookieUpgrades+'</div>'):'')+","(techUpgrades!=''?('<div class=\"listing\"><b>Technologies</b></div>'+\n\t\t\t'<div class=\"listing crateBox\">'+techUpgrades+'</div>'):'')+\n\t\t\t(seasonalUpgrades!=''?('<div class=\"listing\"><b>Seasonal</b></div>'+\n\t\t\t'<div class=\"listing crateBox\">'+seasonalUpgrades+'</div>'):'')+","after"]])}),li=new ei(function(){function e(e,i){"string"==typeof e&&(e=Game.Upgrades[e]),e.unlockAt||(e.unlockAt={cookies:0,name:e.name}),e.unlockAt.displaySeason=i}var i=Game.santaDrops.slice(0,Game.santaDrops.length);i.push("A festive hat"),i.push("Santa's dominion"),Game.crateTooltip=Qe.injectCodes(Game.crateTooltip,[[/(\/\*|\*\/)/g,"","replace"],["else if (me.unlockAt.season"," && me.unlockAt.season","after"],["else if (me.unlockAt.text)","else if (OmniCookies.settings.displaySeasons && me.unlockAt.displaySeason)\n\t\t\t{\n\t\t\t\tvar it=Game.seasons[me.unlockAt.displaySeason];\n\t\t\t\tdesc='<div style=\"font-size:80%;text-align:center;\">From <div class=\"icon\" style=\"vertical-align:middle;display:inline-block;'+(Game.Upgrades[it.trigger].icon[2]?'background-image:url('+Game.Upgrades[it.trigger].icon[2]+');':'')+'background-position:'+(-Game.Upgrades[it.trigger].icon[0]*48)+'px '+(-Game.Upgrades[it.trigger].icon[1]*48)+'px;transform:scale(0.5);margin:-16px;\"></div> '+it.name+'</div><div class=\"line\"></div>'+desc;\n\t\t\t}\n","before"]],{mysterious:0});for(var a,n=0,t=Game.reindeerDrops;n<t.length;n++)a=t[n],e(a,"christmas");for(var s,o=0,r=i;o<r.length;o++)s=r[o],e(s,"christmas");for(var c,d=0,u=Game.halloweenDrops;d<u.length;d++)c=u[d],e(c,"halloween");for(var m,p=0,g=Game.easterEggs;p<g.length;p++)m=g[p],e(m,"easter")}),ci=new ei(function(){Game.UpdateWrinklers=Qe.injectCode(Game.UpdateWrinklers,/(var godLvl=)(Game\.hasGod\('scorn'\))(;\s*if \(godLvl==1\) me\.sucked\*=1\.15;)/m,"$1OmniCookies.settings.skruuiaRebalance ? 0 : $2$3","replace",{inRect:u})}),di=new ei(function(){qe.cursedPs=Game.cookiesPs,qe.cursedPsMult=Game.globalCpsMult;var e=Game.buffTypesByName["cursed finger"];e.func=Qe.injectCodes(e.func,[["multCpS:0,","multCpS:1,","replace"],["<br>but each click is worth ","<br>but each click generates ","replace"]]),ui.apply();var i=Game.hasBuff("Cursed finger");i&&(i.multCpS=1,i.desc=i.desc.replace("is worth","generates"),Game.recalculateGains=1)},function(){var e=Game.buffTypesByName["cursed finger"];e.func=Qe.injectCodes(e.func,[["multCpS:1,","multCpS:0,","replace"],["<br>but each click generates ","<br>but each click is worth ","replace"]]);var i=Game.hasBuff("Cursed finger");i&&(i.multCpS=0,i.desc=i.desc.replace("generates","is worth"),i.power=qe.cursedPs*i.maxTime/Game.fps,Game.recalculateGains=1)}),ui=new ei(function(){Game.CalculateGains=Qe.injectCode(Game.CalculateGains,"Game.computedMouseCps=Game.mouseCps();","\nif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\n\t\t\tOmniCookies.vars.cursedPs = Game.cookiesPs;\n\t\t\tOmniCookies.vars.cursedPsMult = Game.globalCpsMult;\n\t\t\tGame.globalCpsMult = 0;\n\t\t\tGame.cookiesPs = 0;\n\t\t\tGame.computedMouseCps = 0;\n\t\t}","after");var e=document.getElementById("bigCookie");e.removeEventListener("click",Game.ClickCookie),Game.ClickCookie=Qe.injectCode(Game.ClickCookie,"Game.handmadeCookies+=amount;","\nif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\n\t\t\tGame.Dissolve(amount);\n\t\t\tGame.handmadeCookies-=amount;\n\t\t\tamount = OmniCookies.vars.cursedPs * Game.buffs['Cursed finger'].maxTime/Game.fps;\n\t\t\tGame.cookiesPs = OmniCookies.vars.cursedPs;\n\t\t\tGame.globalCpsMult = OmniCookies.vars.cursedPsMult;\n\t\t\tOmniCookies.Util.gainInstantPassiveCpS(Game.buffs['Cursed finger'].maxTime/Game.fps);\n\t\t\tGame.cookiesPs = 0;\n\t\t\tGame.globalCpsMult = 0;\n\t\t}","after"),AddEvent(e,"click",Game.ClickCookie)}),mi=new ei(function(){Game.tooltip.wobble=Qe.injectCode(Game.tooltip.wobble,"if (false)","if (OmniCookies.settings.tooltipWobble)","replace")}),pi=new ei(function(){Game.CalculateGains=Qe.injectCode(Game.CalculateGains,/\(Date\.now\(\)\/1000\/\(60\*60\*(\d+)\)\)\*Math\.PI\*2/g,"OmniCookies.Util.cycliusCalc($1, OmniCookies.settings.zonedCyclius)","replace")}),gi=new ei(function(){c("Bank",function(){var e=Game.Objects.Bank.minigame;e.buyGood=Qe.injectCode(e.buyGood,"return true;","let realCostInS = costInS * overhead;\n\t\t\tif(!OmniCookies.saveData.stockAverages[id] || me.stock == n) {\n\t\t\t\tOmniCookies.saveData.stockAverages[id] = {\n\t\t\t\t\tavgValue: realCostInS,\n\t\t\t\t\ttotalValue: realCostInS*n\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\n\t\t\t\tavg.totalValue += realCostInS*n;\n\t\t\t\tavg.avgValue = avg.totalValue/me.stock;\n\t\t\t}\n","before",{M:e}),e.sellGood=Qe.injectCode(e.sellGood,"return true;","if(OmniCookies.saveData.stockAverages[id]) {\n\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\n\t\t\t\tavg.totalValue -= avg.avgValue*n;\n\t\t\t}\n","before",{M:e}),e.drawGraph=Qe.injectCode(e.drawGraph,null,"if(OmniCookies.settings.stockValueData && M.hoverOnGood != -1) {\n\t\t\t\tlet me = M.goodsById[M.hoverOnGood];\n\t\t\t\tif(me.stock > 0 && OmniCookies.saveData.stockAverages[M.hoverOnGood]) {\n\t\t\t\t\tctx.strokeStyle='#00ff00'; // green\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tlet lineHeight = Math.floor(height-OmniCookies.saveData.stockAverages[M.hoverOnGood].avgValue*M.graphScale)+0.5;\n\t\t\t\t\tctx.moveTo(width-1, lineHeight);\n\t\t\t\t\tctx.lineTo(width-span*rows-1, lineHeight);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}","after",{M:e}),e.draw=Qe.injectCode(e.draw,"//if (me.stock>0) me.stockL.style.color='#fff';","if(OmniCookies.settings.stockValueData) {\n\t\t\t\tif(!me.avgL) {\n\t\t\t\t\tlet avgSpan = document.createElement('span');\n\t\t\t\t\tavgSpan.id = 'bankGood-'+me.id+'-avg';\n\t\t\t\t\tavgSpan.innerHTML = '(-)';\n\t\t\t\t\tdocument.getElementById('bankGood-'+me.id+'-stockBox').appendChild(avgSpan);\n\t\t\t\t\tme.avgL = avgSpan;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(OmniCookies.saveData.stockAverages[me.id] && me.stock > 0) {\n\t\t\t\t\tme.avgL.style.visibility = 'visible';\n\t\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[me.id];\n\t\t\t\t\tme.avgL.innerHTML = ' ($$'+Beautify(avg.avgValue,2)+')';\n\t\t\t\t\tif(avg.avgValue < me.val) {\n\t\t\t\t\t\tme.avgL.classList.remove('red');\n\t\t\t\t\t\tme.avgL.classList.add('green');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.avgL.classList.remove('green');\n\t\t\t\t\t\tme.avgL.classList.add('red');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.avgL.style.visibility = 'hidden';\n\t\t\t\t\tme.avgL.innerHTML = '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(me.avgL) {\n\t\t\t\t\tme.avgL.remove();\n\t\t\t\t\tme.avgL = undefined;\n\t\t\t\t}\n\t\t\t}\n","before",{M:e}),e.toRedraw=1})}),fi=new ei(function(){Game.Draw=Qe.injectCode(Game.Draw,"if (Game.prefs.animate && ((Game.prefs.fancy && Game.drawT%1==0)","if (Game.prefs.animate && ((((Game.prefs.fancy || OmniCookies.settings.buildingsBypassFancy == 0) && OmniCookies.settings.buildingsBypassFancy != 1) && Game.drawT%1==0)","replace")}),ki=new ei(function(){Game.DrawBackground=Qe.injectCode(Game.DrawBackground,/(var fancy=)(Game\.prefs\.fancy)(;)/,"$1($2 || OmniCookies.settings.cursorsBypassFancy == 0) && OmniCookies.settings.cursorsBypassFancy != 1$3","replace")}),hi=new ei(function(){Game.UpdateWrinklers=Qe.injectCode(Game.UpdateWrinklers,/Game\.prefs\.fancy/g,"($& || OmniCookies.settings.wrinklersBypassFancy == 0) && OmniCookies.settings.wrinklersBypassFancy != 1","replace",{inRect:u})}),bi=new ei(function(){var e=[["l('productPriceMult'+me.id).textContent=(Game.buyBulk>1)?('x'+Game.buyBulk+' '):'';","if(OmniCookies.settings.enhancedBulk) {\n\t\t\t\tlet bulkAmount = -1;\n\t\t\t\tlet bulkPrice = -1;\n\t\t\t\tif(Game.buyMode == -1) {\n\t\t\t\t\tbulkAmount = (Game.buyBulk > -1) ? Math.min(Game.buyBulk, me.amount) : me.amount;\n\t\t\t\t} else {\n\t\t\t\t\tlet scaling = Game.priceIncrease;\n\t\t\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\t\t\tscaling = 1+Game.modifyBuildingPrice(me, scaling-1);\n\t\t\t\t\t}\n\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(me, Game.buyBulk, scaling);\n\t\t\t\t\tbulkAmount = bulk.maxAmount;\n\t\t\t\t\tbulkPrice = bulk.maxPrice;\n\t\t\t\t}\n\t\t\t\tl('productPriceMult'+me.id).textContent = bulkAmount > 1 ? 'x' + bulkAmount + ' ' : '';\n\t\t\t} else {\n\t\t\t\t$&\n\t\t\t}","replace"]],a=[["if (Game.buyMode==1) this.bulkPrice=this.getSumPrice(Game.buyBulk);","if (Game.buyMode==1) {\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\n\t\t\t\t\tlet scaling = Game.priceIncrease;\n\t\t\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\t\t\tscaling = 1+Game.modifyBuildingPrice(this, scaling-1);\n\t\t\t\t\t}\n\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(this,Game.buyBulk,scaling);\n\t\t\t\t\tthis.bulkPrice = bulk.maxPrice > 0 ? bulk.maxPrice : this.price;\n\t\t\t\t} else {\n\t\t\t\t\tthis.bulkPrice=this.getSumPrice(Game.buyBulk);\n\t\t\t\t}\n\t\t\t}","replace"],["else if (Game.buyMode==-1 && Game.buyBulk==-1) this.bulkPrice=this.getReverseSumPrice(","OmniCookies.settings.enhancedBulk ? this.amount : ","after"]],n=[["if (amount==-1) amount=1000;","if (amount==-1) amount=Infinity;","replace"],[/success=1;\s*}/,"$& else break;","replace"]];for(var t in Game.Objects){var i=Game.Objects[t];i.rebuild=Qe.injectCodes(i.rebuild,e),i.refresh=Qe.injectCodes(i.refresh,a),i.buy=Qe.injectCodes(i.buy,n)}Game.Object=Qe.injectCodes(Game.Object,e),Game.Object=Qe.injectCodes(Game.Object,a),Game.Object=Qe.injectCodes(Game.Object,n),Game.storeBulkButton=Qe.injectCodes(Game.storeBulkButton,[["if (Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;","if(id == 0 || id == 1) {\n\t\t\t\tlet text = 'all';\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\n\t\t\t\t\tif(Game.buyMode == -1) text = 'ALL';\n\t\t\t\t\telse text = 'MAX';\n\t\t\t\t}\n\t\t\t\tl('storeBulkMax').textContent = text;\n\t\t\t}\n\t\t\tif (!OmniCookies.settings.enhancedBulk && Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;","replace"],["l('storeBulkMax').style.visibility='hidden';","if(!OmniCookies.settings.enhancedBulk) ","before"]]),Game.Logic=Qe.injectCodes(Game.Logic,[["if (!Game.promptOn)","let activeShortcut = (OmniCookies.Util.holdingButton(16)*2) | (OmniCookies.Util.holdingButton(17));\n","before"],["if ((Game.keys[16] || Game.keys[17]) && !Game.buyBulkShortcut)","if (activeShortcut != OmniCookies.vars.prevShortcut && (OmniCookies.settings.enhancedBulk ? true : activeShortcut == 2 || activeShortcut == 1))","replace"],["Game.buyBulkOld=Game.buyBulk;","if(OmniCookies.vars.prevShortcut == 0) ","before"],["if (Game.keys[17]) Game.buyBulk=10;","if(activeShortcut == 3 && OmniCookies.settings.enhancedBulk) Game.buyBulk = -1;","after"],["//handle cookies","OmniCookies.vars.prevShortcut = activeShortcut;\n","before"]]),yi()}),yi=function(){1==Game.buyMode&&(-1==Game.buyBulk&&!$e.enhancedBulk&&Game.storeBulkButton(4),l("storeBulkMax").style.visibility=$e.enhancedBulk?"visible":"hidden");var e="all";$e.enhancedBulk&&(-1==Game.buyMode?e="ALL":e="MAX"),l("storeBulkMax").textContent=e,Game.RefreshStore()},vi=new ei(function(){c("Bank",function(){var e=Game.Objects.Bank.minigame;e.buyGood=Qe.injectCode(e.buyGood,"Game.Spend(cost*n);","if(OmniCookies.settings.dangerousStocks) {\n\t\t\t\tGame.Dissolve(cost*n);\n\t\t\t} else {\n\t\t\t\t$&\n\t\t\t}","replace",{M:e}),e.sellGood=Qe.injectCodes(e.sellGood,[["//Game.Earn","if(OmniCookies.settings.dangerousStocks) Game.Earn","replace"],[/\tGame\.cookies/gm,"if(!OmniCookies.settings.dangerousStocks) $&","replace"]],{M:e})})}),Ci=new ei(function(){c("Temple",function(){var e=Game.Objects.Temple.minigame,i=[/\+me\.desc(\w+)\+/g,"+((typeof me.desc$1 == 'function') ? me.desc$1() : me.desc$1)+","replace"];e.godTooltip=Qe.injectCode.apply(Qe,g([e.godTooltip],i,[{M:e}])),e.slotTooltip=Qe.injectCode.apply(Qe,g([e.slotTooltip],i,[{M:e}]));var a=function(e){return function(){var i="";if($e.detailedCyclius){var a=100*(.15*Se(n(e,$e.zonedCyclius))),t=0<a?"green":"red",s=0<a?"+":"",o=Beautify(a,2);"0"==o&&(t=""),-.1>a&&"0"==o&&(t="red"),0>a&&!o.includes("-")&&(o="-"+o),i="<div style=\"display:inline-block;text-align:right;width:50%;\" class=\""+t+"\">"+s+o+"% base CpS.</div>"}return"<div style=\"display:inline-block;width:49%;\">Effect cycles over "+e+" hours.</div>"+i}},t=e.gods.ages;Oi(),t.desc1=a(3),t.desc2=a(12),t.desc3=a(24)})}),Oi=function(){var e=Game.Objects.Temple.minigame,i=e.gods.ages;i.activeDescFunc?(i.activeDescBackup=i.activeDescFunc,i.activeDescFunc=void 0):(i.activeDescFunc=i.activeDescBackup,i.activeDescBackup=void 0)},wi=new ei(function(){Game.Draw=Qe.injectCode(Game.Draw,"if (price<lastPrice) Game.storeToRefresh=1;","if (price<lastPrice && price!=0) Game.upgradesToRebuild=1;","replace"),this.applied&&console.log("what the fuck?!");for(var e,i=0,a=Game.ObjectsById;i<a.length;i++)e=a[i],e.getSumPrice=Qe.injectCodes(e.getSumPrice,[[/(for \(var i=)(Math\.max\(0,this\.amount\))(;)/,"$1Infinity$3","replace"],["=Game.modifyBuildingPrice(this,price);","=OmniCookies.Util.quickCalcBulkPrice(this, amount);","replace"]]),e.getReverseSumPrice=Qe.injectCodes(e.getReverseSumPrice,[[/(for \(var i=)(Math\.max\(0,\(this\.amount\)-amount\))(;)/,"$1Infinity$3","replace"],["=Game.modifyBuildingPrice(this,price);","=OmniCookies.Util.quickCalcBulkPrice(this, amount, undefined, true);","replace"],["price*=this.getSellMult","//","before"]])}),Gi=new ei(function(){c("Bank",function(){var i=Game.Objects.Bank.minigame,a=l("bankBrokersBuy"),n=a.parentElement,t=document.createElement("div");t.classList.add("bankButton","bankButtonBuy","bankButtonOff"),t.id="bankBrokersBuy",t.innerHTML="Hire",t.onclick=function(a){i.brokers<i.getMaxBrokers()&&Game.cookies>=i.getBrokerPrice()&&($e.dangerousBrokers&&$e.dangerousStocks?Game.Dissolve(i.getBrokerPrice()):Game.Spend(i.getBrokerPrice()),i.brokers+=1,$e.dangerousBrokers&&(i.profit-=1200),PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(a.target))},a.remove(),n.appendChild(t)})}),Bi=new ei(function(){Game.crateTooltip=Qe.injectCode(Game.crateTooltip,"if (me.tier!=0 && Game.Has('Label printer')) tags.push('Tier : '","if(OmniCookies.settings.heavenlyCookies) {\n\t\t\tif(OmniCookies.vars.prestigeCookies[me.name]) {\n\t\t\t\ttags.push('Cookie', 0);\n\t\t\t}\n\t\t}\n","before",{mysterious:0}),Game.particleAdd=Qe.injectCode(Game.particleAdd,/(if \(cookie\.bought>0 && )(cookie\.pool=='cookie')(\) cookies\.push\(cookie\.icon\);)/,"$1($2 || (OmniCookies.settings.heavenlyCookies && cookie.pool == 'prestige' && Game.Has(cookie.name) && OmniCookies.vars.prestigeCookies[cookie.name]))$3","replace"),qe.prestigeCookies["Heavenly cookies"]=!0,qe.prestigeCookies["Wrinkly cookies"]=!0,qe.prestigeCookies["Sugar crystal cookies"]=!0}),Si=new ei(function(){for(var e,i=[[null,"let oldPriceIncrease = Game.priceIncrease;\n\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\tGame.priceIncrease = 1+Game.modifyBuildingPrice(this, oldPriceIncrease-1);\n\t\t\t\tOmniCookies.vars.skipModifyPrice = true;\n\t\t\t}","before"],["return","if(OmniCookies.settings.buildingPriceBuff) Game.priceIncrease = oldPriceIncrease;\n","before"]],a=0,n=Game.ObjectsById;a<n.length;a++)e=n[a],e.getPrice=Qe.injectCodes(e.getPrice,i),e.getSumPrice=Qe.injectCodes(e.getSumPrice,i),e.getReverseSumPrice=Qe.injectCodes(e.getReverseSumPrice,i);Game.modifyBuildingPrice=Qe.injectCode(Game.modifyBuildingPrice,null,"if(OmniCookies.vars.skipModifyPrice) {\n\t\t\tOmniCookies.vars.skipModifyPrice = false;\n\t\t\treturn price;\n\t\t}","before")}),xi=Object.freeze({__proto__:null,Patch:ei,scrollbarStyle:ii,smoothBuildings:ai,scrollingBuildings:ni,buildingTooltips:ti,buffTooltips:si,miscGrandmaFixes:oi,statsUpgradeCategories:ri,displaySeasonUnlock:li,skruuiaRebalance:ci,cursedFingerTweaks:di,tooltipWobble:mi,cycliusGains:pi,stockInfo:gi,fancyBuildings:fi,fancyCursors:ki,fancyWrinklers:hi,buySellBulk:bi,updateBulkAll:yi,dangerousStocks:vi,cycliusInfo:Ci,toggleCyclius:Oi,optiCookies:wi,dangerousBrokers:Gi,heavenlyCookies:Bi,buildingPriceBuff:Si}),Mi=function(){function e(e,i,a){this.settingName=e,this.options=i,this.desc=a,this.id="OmniCookiesButton_"+this.settingName}return e.prototype.display=function(){var e=document.createElement("div"),i=+$e[this.settingName],n=this.options[i],t=document.createElement("a");t.id=this.id,t.className="option"+(n.off?" off":""),t.onclick=this.toggleFunction(),t.innerHTML=n.text,e.appendChild(t);var a=document.createElement("label");return a.innerHTML=this.desc,e.appendChild(a),e},e.prototype.toggleFunction=function(){var e=this.settingName,i=this.options,a=this.id;return function(){$e[e]++,$e[e]>=i.length&&($e[e]=0);var n=document.getElementById(a),t=i[$e[e]];t.off?n.classList.add("off"):n.classList.remove("off"),t.func&&t.func(),n.innerHTML=t.text,PlaySound("snd/tick.mp3")}},e}(),ji=function(e){function i(i,a,n,t){var s=e.call(this,i,[n,a],t)||this;return s.onOption=a,s.offOption=n,n.off=!0,s}return p(i,e),i}(Mi),Pi=function(){function e(e){this.text=e}return e.prototype.display=function(){var e=document.createElement("div");return e.className="listing",e.style.padding="5px 16px",e.style.opacity="0.7",e.style.fontSize="17px",e.style.fontFamily="\"Kavoon\", Georgia, serif",e.appendChild(document.createTextNode(this.text)),e},e}(),Ti=function(){function e(e){this.text=e}return e.prototype.display=function(){var e=document.createElement("div");return e.className="title",e.innerHTML=this.text,e},e}(),Li=function(){function e(e){this.elements=e}return e.prototype.display=function(){var e=document.createElement("div");e.className="listing";for(var i,a=0,n=this.elements;a<n.length;a++)i=n[a],e.appendChild(i.display());return e},e}(),Ai=function(){function e(e){this.elements=e}return e.prototype.display=function(){for(var e,i=document.createDocumentFragment(),a=0,n=this.elements;a<n.length;a++)e=n[a],i.appendChild(e.display());return i},e}(),Fi=new Ai([new Ti("Omniscient Cookies "+We),new Pi("Graphical tweaks"),new Li([new ji("autoScrollbar",{text:"Autohide center scrollbar ON",func:function(){return r("auto")}},{text:"Autohide center scrollbar OFF",func:function(){return r("scroll")}},"(the scrollbar in the center view will hide itself when appropriate)"),new ji("scrollingBuildings",{text:"Scroll buildings ON"},{text:"Scroll buildings OFF"},"(hovering over the left/right edges of buildings produces a scroll effect)"),new ji("smoothBuildings",{text:"Smooth buildings ON"},{text:"Smooth buildings OFF"},"(buildings draw every frame, instead of every 3 frames)"),new ji("betterBuildingTooltips",{text:"Improved building tooltips ON",func:function(){return ti.apply()}},{text:"Improved building tooltips OFF"},"(building tooltips in the shop look a little better)"),new ji("betterGrandmas",{text:"Grandma fixes ON",func:function(){return oi.apply()}},{text:"Grandma fixes OFf"},"(text and ordering fixes for grandma synergy upgrades; disabling requires refresh)"),new ji("bringGrandmaToWork",{text:"Bring grandma to work day ON"},{text:"Bring grandma to work day OFF"},"(synergy grandmas make an appearance in their respective building views)"),new ji("separateTechs",{text:"Separate techs ON",func:function(){return ri.apply()}},{text:"Separate techs OFF"},"(gives tech upgrades their own upgrade category under cookies)"),new ji("separateSeasons",{text:"Separate seasons ON",func:function(){return ri.apply()}},{text:"Separate seasons OFF"},"(gives seasonal upgrades their own upgrade category under cookies)"),new ji("displaySeasons",{text:"Display seasonal sources ON",func:function(){return li.apply()}},{text:"Display seasonal sources OFF"},"(shows source season in upgrade tooltips)"),new ji("fancyMilkSelect",{text:"Fancy milk select ON"},{text:"Fancy milk select OFF",func:function(){s(1),qe.lastMilk=-1,qe.lastAutoMilk=-1}},"(milk selector icon changes with selected milk)"),new ji("tooltipWobble",{text:"Tooltip wobble ON"},{text:"Tooltip wobble OFF",func:function(){return Game.tooltip.tt.className="framed"}},"(enables the tooltip wobble animation)"),new ji("improveAscendMeter",{text:"Fancy ascend meter ON"},{text:"Fancy ascend meter OFF",func:function(){return Game.ascendMeter.style.removeProperty("width")}},"(meter and number total update faster and smoother)"),new ji("heavenlyCookies",{text:"Heavenly cookies ON",func:function(){return Bi.apply()}},{text:"Heavenly cookies OFF"},"(certain heavenly upgrades act like cookie upgrades)"),new Mi("buildingsBypassFancy",[{text:"Buildings always FANCY"},{text:"Buildings always FAST"},{text:"Buildings always DEFAULT",off:!0}],"(buildings follow this setting rather than default)"),new Mi("cursorsBypassFancy",[{text:"Cursors always FANCY"},{text:"Cursors always FAST"},{text:"Cursors always DEFAULT",off:!0}],"(cursors follow this setting rather than default)"),new Mi("wrinklersBypassFancy",[{text:"Wrinklers always FANCY"},{text:"Wrinklers always FAST"},{text:"Wrinklers always DEFAULT",off:!0}],"(wrinklers follow this setting rather than default)")]),new Pi("Quality of Life"),new Li([new ji("enhancedBulk",{text:"Enhanced bulk ON",func:function(){return yi()}},{text:"Enhanced bulk OFF",func:function(){return yi()}},"(allows partial and maximum bulk purchases)"),new ji("buffTooltipDuration",{text:"Show buff duration in tooltip ON"},{text:"Show buff duration in tooltip OFF"},"(buffs will show their current duration in their tooltip)")]),new Pi("Stock Market"),new Li([new ji("stockValueData",{text:"Stock value data ON"},{text:"Stock value data OFF"},"(displays information about how profitable your stocks are)"),new ji("dangerousStocks",{text:"Dangerous stocks ON"},{text:"Dangerous stocks OFF"},"(stock market affects total cookies earned)"),new ji("dangerousBrokers",{text:"Dangerous brokers ON",func:function(){return Gi.apply()}},{text:"Dangerous brokers OFF"},"(hiring brokers reduces your Stock Market profits)")]),new Pi("Pantheon"),new Li([new ji("detailedCyclius",{text:"Cyclius details ON",func:function(){return Oi()}},{text:"Cyclius details OFF",func:function(){return Oi()}},"(shows Cyclius' current cycles in his tooltip)"),new ji("zonedCyclius",{text:"Zoned Cyclius ON",func:function(){return Game.recalculateGains=1}},{text:"Zoned Cyclius OFF",func:function(){return Game.recalculateGains=1}},"(offsets Cyclius based on your time zone, towards GMT+1)"),new ji("trueCyclius",{text:"True Cyclius ON"},{text:"True Cyclius OFF"},"(cosmetic; Cyclius shows off his power with style)"),new ji("skruuiaRebalance",{text:"Skruuia rebalance ON"},{text:"Skruuia rebalance OFF"},"(Skruuia's bonus applies to wrinkler suck rate rather than wrinkler pop multiplier)")]),new Pi("Grimoire"),new Li([new ji("improveMagicMeter",{text:"Improved magic meter ON"},{text:"Improved magic meter OFF"},"(slight improvements to the magic meter; disabling requires refresh)")]),new Pi("Experimental"),new Li([new ji("optimizeBuildings",{text:"Buildings draw smart ON"},{text:"Buildings draw smart OFF"},"(buildings attempt to skip unnecessary draw frames)"),new ji("preserveWrinklers",{text:"Preserve wrinklers ON"},{text:"Preserve wrinklers OFF"},"(attempts to preserve all wrinkler data on game save/load)"),new ji("cursedFinger",{text:"Cursed Finger tweaks ON",func:function(){return di.apply()}},{text:"Cursed Finger tweaks OFF",func:function(){return di.remove()}},"(CF does not snapshot and counts as real passive CpS)"),new ji("buildingPriceBuff",{text:"Building price buff ON",func:function(){Si.apply(),Game.storeToRefresh=1}},{text:"Building price buff OFF",func:function(){Game.storeToRefresh=1}},"(building price modifiers instead affect price scaling; <span class=\"warning\">balance warning</span>)"),new ji("optiCookies",{text:"OptiCookies ON",func:function(){return wi.apply()}},{text:"OptiCookies OFF"},"(a couple of small performance tweaks; disabling requires refresh)")])]),Ii=Object.freeze({__proto__:null,customOptionsMenu:function(){if("prefs"==Game.onMenu){var e=Fi.display();l("menu").childNodes[2].insertBefore(e,l("menu").childNodes[2].childNodes[l("menu").childNodes[2].childNodes.length-1])}}}),Ui=function(){return function(e,i){void 0===i&&(i=function(){return!0}),this.func=e,this.enabled=i}}(),Di=function(){function e(e){void 0===e&&(e={}),this.routines=e}return e.prototype.run=function(){for(var e in this.routines)this.routines[e].enabled&&this.routines[e].enabled()&&this.routines[e].func()},e.prototype.register=function(e,i){this.routines[e]=new Ui(i)},e}(),Ni=function(){return function(){}}(),_i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.improveAscendMeter=new Ui(function(){var e=Game.ascendMeter,i=Game.ascendNumber,a=Game.HowMuchPrestige(Game.cookiesReset),n=De(Game.HowMuchPrestige(Game.cookiesReset+Game.cookiesEarned)),t=n-De(a),s=window.Spice;"undefined"!=typeof s&&s.settings.numericallyStableHeavenlyChipGains&&(t=s.stableHeavenlyChipGains());var o=Game.HowManyCookiesReset(De(a+t+1))-Game.HowManyCookiesReset(De(a+t)),r=Game.HowManyCookiesReset(n+1)-(Game.cookiesEarned+Game.cookiesReset),c=1-r/o;qe.ascendMeterPercent||(qe.ascendMeterPercent=c),qe.ascendMeterLevel||(qe.ascendMeterLevel=t),t!=qe.ascendMeterLevel&&(qe.levelDiff+=t-qe.ascendMeterLevel,qe.ascendMeterLevel=t),Game.ascendMeterPercent=qe.ascendMeterPercent;var d=.1*(qe.levelDiff+c-Game.ascendMeterPercent);Game.ascendMeterPercent+=d;var u=!1,m=!1;2<=Game.ascendMeterPercent&&(u=!0),-1>=Game.ascendMeterPercent&&(m=!0),1<=Game.ascendMeterPercent&&(qe.levelDiff-=De(Game.ascendMeterPercent)),0>Game.ascendMeterPercent&&(qe.levelDiff-=De(Game.ascendMeterPercent)),0>Game.ascendMeterPercent&&(Game.ascendMeterPercent=1-Be(Game.ascendMeterPercent)),Game.ascendMeterPercent%=1,e.style.transform="";var p=100*Game.ascendMeterPercent;p=u?100:p,p=m?0:p,e.style.width=p+"%",i.textContent="+"+window.SimpleBeautify(t-qe.levelDiff),qe.ascendMeterPercent=Game.ascendMeterPercent},function(){if($e.improveAscendMeter)return!0;var e=Game.ascendMeter;return e.style.removeProperty("width"),!1}),i.updateSkruuiaRebalance=new Ui(function(){var e=1;if($e.skruuiaRebalance&&Game.hasGod){var i=Game.hasGod("scorn");1===i?e=1.15:2===i?e=1.1:3===i?e=1.05:void 0}var a=Game.Objects.Temple.minigame;a&&("undefined"==typeof a.effs&&(a.effs={}),e!=a.effs.wrinklerEat&&(Game.recalculateGains=1),a.effs.wrinklerEat=e)}),i.bulkStoreRefresh=new Ui(function(){return Game.storeToRefresh=1},function(){return $e.enhancedBulk&&0==Game.T%10}),i}return p(i,e),i}(Ni),Ri=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i}(Di),Ei=new Ri(new _i()),Wi=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.updateMilkIcon=new Ui(function(){0==Game.milkType&&Game.Milk!=qe.lastAutoMilk?(s(0),qe.lastAutoMilk=Game.Milk):Game.milkType!=qe.lastMilk&&(s(Game.milkType),qe.lastMilk=Game.milkType)},function(){return $e.fancyMilkSelect}),i.grimoireMeterFix=new Ui(function(){var e=Number.parseFloat;this.hasRun=!0;var i=document.getElementById("grimoireBar");if(i){var a=document.getElementById("grimoireBarFull");if(i.className.includes("meterContainer")){a.style.height="8px",a.style.transform="scale(2,2)",a.style.transformOrigin="0 0";var n=document.createElement("div");n.className=i.className,n.style.overflow="hidden",n.style.height="100%",i.className="",i.style.position="relative",i.replaceChild(n,a),n.appendChild(a)}a.style.width=e(a.style.width)/2+"%"}},function(){return $e.improveMagicMeter||this.hasRun}),i.trueCyclius=new Ui(function(){var e=document.getElementById("templeGod3");if(e){var i=e.getElementsByClassName("usesIcon")[0],a=Game.hasGod("ages");if(a){if(i.classList.contains("shadowFilter")){var t=document.createElement("div");t.classList.add("templeIcon"),t.classList.add("shadowFilter"),t.style.margin="unset",i.classList.remove("shadowFilter"),i.style.animation="none",e.removeChild(i),e.appendChild(t),t.appendChild(i),qe.patchedTrueCyclius=!0}var s=0,o=0;$e.trueCyclius?(1===a?s=3:2===a?s=12:3===a?s=24:void 0,o=n(s,$e.zonedCyclius)-xe/2,i.style.setProperty("transform","rotate("+o+"rad)")):i.style.removeProperty("transform")}else qe.patchedTrueCyclius&&i.style.removeProperty("transform")}else qe.patchedTrueCyclius=!1}),i}return p(i,e),i}(Ni),qi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i}(Di),zi=new qi(new Wi()),Hi=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.resetSaveData=new Ui(function(){return Ve.reset()}),i.resetScroll=new Ui(function(){for(var e in Game.Objects){var i=Game.Objects[e];i.scrollOffX&&(i.scrollOffX=0)}}),i}return p(i,e),i}(Ni),Xi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i}(Di),$i=new Xi(new Hi()),Yi=Object.freeze({__proto__:null,logicRoutine:Ei,drawRoutine:zi,resetRoutine:$i}),Vi={Farm:{building:Game.Objects.Farm,frequency:1,drawGrandma:function(e,i){return{x:e.x+De(40*(Math.random()-.5)),y:e.y+De(10*(Math.random()-.5))+5,z:e.y+.1,id:i,pic:"farmerGrandma.png",frame:-1,grandma:!0}}},Mine:{building:Game.Objects.Mine,frequency:1,drawGrandma:function(e,i){return{x:e.x+De(25*(Math.random()-.5))+10,y:e.y+De(5*(Math.random()-.4))+2,z:e.y+.1,id:i,pic:"minerGrandma.png",frame:-1,grandma:!0}}},Factory:{building:Game.Objects.Factory,frequency:1,drawGrandma:function(e,i){return{x:e.x+De(50*(Math.random()-.5)),y:e.y,z:e.y+.1,id:i,pic:"workerGrandma.png",frame:-1,grandma:!0}}},Bank:{building:Game.Objects.Bank,frequency:k/2,drawGrandma:function(e,i){return{x:e.x+De(40*(Math.random()-.5)),y:e.y+De(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"bankGrandma.png",frame:-1,grandma:!0}}},Temple:{building:Game.Objects.Temple,frequency:1,drawGrandma:function(e,i){return{x:e.x+De(25*(Math.random()-.5)),y:e.y+De(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"templeGrandma.png",frame:-1,grandma:!0}}},"Wizard tower":{building:Game.Objects["Wizard tower"],frequency:3,drawGrandma:function(e,i){return{x:e.x+De(35*(Math.random()-.5))+20,y:De(12*(Math.random()-.5))+60,z:e.y+50,id:i,pic:"witchGrandma.png",frame:-1,grandma:!0}}},Shipment:{building:Game.Objects.Shipment,frequency:.5,drawGrandma:function(e,i){var a="0.1"==(i-e.id).toFixed(1)?-1:1,n=e.x+De(5*(Math.random()*a))+15*a,t=e.y+De(20*Math.random())+-1*(15*a);return{x:n,y:t,z:t+i%1,id:i,pic:"cosmicGrandma.png",frame:-1,grandma:!0}}},"Alchemy lab":{building:Game.Objects["Alchemy lab"],frequency:1,drawGrandma:function(e,i){return{x:e.x+De(45*(Math.random()-.5)),y:e.y+De(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"transmutedGrandma.png",frame:-1,grandma:!0}}},Portal:{building:Game.Objects.Portal,frequency:xe/2,drawGrandma:function(e,i){var a=De(70*Math.random());return{x:e.x+De(35*(Math.random()-.5)),y:a,z:999+a+i,id:i,pic:"alteredGrandma.png",frame:-1,grandma:!0}}},"Time machine":{building:Game.Objects["Time machine"],frequency:1,drawGrandma:function(e,i){return d("https://gamrguy.github.io/OmniscientCookies/img/timemachine_front.png"),[{x:e.x-5,y:e.y-2,z:999+e.id,id:i,pic:"grandmasGrandma.png",frame:-1,grandma:!0},{x:e.x,y:e.y,z:1e3+e.id,id:i+.01,pic:"https://gamrguy.github.io/OmniscientCookies/img/timemachine_front.png",frame:-1}]}},"Antimatter condenser":{building:Game.Objects["Antimatter condenser"],frequency:1,drawGrandma:function(e,i){return{x:e.x,y:e.y-6,z:999+e.id,id:i,pic:"antiGrandma.png",frame:-1,grandma:!0}}},Prism:{building:Game.Objects.Prism,frequency:1,drawGrandma:function(e,i){return{x:e.x+De(45*(Math.random()-.5)),y:e.y+De(8*(Math.random()-.5))+8,z:e.y+.1,id:i,pic:"rainbowGrandma.png",frame:-1,grandma:!0}}},Chancemaker:{building:Game.Objects.Chancemaker,frequency:2,drawGrandma:function(e,i){return{x:e.x+De(50*(Math.random()-.5)),y:70,z:777+e.id,id:i,pic:"luckyGrandma.png",frame:-1,grandma:!0}}},"Fractal engine":{building:Game.Objects["Fractal engine"],frequency:xe/4,drawGrandma:function(e,i){var a=Math.sign,n=(i-e.id).toFixed(1);this.prevX&&"0.1"!=n&&n!=this.prevID||(this.prevX=0,this.prevY=0);var t=e.x+De(35*(Math.random()-.5)),s=De(70*Math.random());return this.prevX&&30>Be(t-this.prevX)&&(t+=30*a(t-e.x)),this.prevY&&30>Be(s-this.prevY)&&(s+=30*a(e.y-s)),this.prevX=t,this.prevY=s,this.prevID=n,{x:t,y:s,z:999+s+i,id:i,pic:"metaGrandma.png",frame:-1,grandma:!0}}},Idleverse:{building:Game.Objects.Idleverse,frequency:xe/1.5,drawGrandma:function(e,i){return{x:e.x+De(15*(Math.random()-.5)),y:e.y+De(15*(Math.random()-.5))-25,z:e.y+1,id:i,pic:"alternateGrandma.png",frame:-1,grandma:!0}}}},Ki=Object.freeze({__proto__:null,registerSupport:function(e,i){Vi[e.building.name]&&m("Replacing custom grandma support for '"+e.building.name+"'!"),Vi[e.building.name]=e,i&&(qe.bannedGrandmas[i]=!0)},tryDrawGrandmas:function(e,a,n){var t=Vi[e.name];if(t){var s=!t.frequency||0>=t.frequency?1:t.frequency,r=o(e),c=f(n,s),d=f(n-1,s),u=c-d;u=De(Fe(0,Re(u,r-c)));for(var m=[],p=0;p<u;p++)n+=.1,m=m.concat(t.drawGrandma(a,n));return m}},grandmaProperties:Vi}),Zi="Omniscient Cookies",Ji=We,Qi=He,ea=Ii,ia=xi,aa=Ke,na=Yi,ta=$e,sa=Ve,oa=[choose(["nice grandmas","hard-working grandmas","old ladies"]),"farmers","miners","workers",choose(["bankers","brokers","financial advisors","accountants"]),"priestesses","witches",choose(["aliens","bounty hunters","spice traders","kessel runners"]),choose(["full-cookie alchemists","golden grans"]),choose(["elder abominations","flesh piles","doughy beings"]),choose(["time policemas","nice old lady's nice old ladies"]),"antimatter constructs","living rainbows","leprechauns","Cyriak wannabes",choose(["NaNnies","[Error: cookie is not defined]s","['g','r','a','n']s"]),choose(["spaghetti bakers","pancake flippers","not-cookie productionists","pastry panhandlers"])],ra=choose(Game.ObjectsById.slice(0,18));ra==Game.Objects.Cursor&&(ra=Game.Objects.Grandma);var la=0;la=ra==Game.Objects.Grandma?Game.Objects.Grandma.amount:Qi.getNumSynergyGrandmas(ra);var ca="Your <b>"+la+" "+oa[ra.id-1]+"</b> missed you!";(0==ra.amount||0>=la)&&(ca=". . . but nobody came");var da,ua=["And then he said,<br>'Let there be cookies'","Some dude called "+choose(["theGameMaster1234","RobotLucca","gamrguy","theMineMaster2","DeadlyFez"])+" made this","That ascend meter was getting antsy",ca,"The cookies have eyes.<br>Watch yourself out there","Over the river and through the cookies","Thank you for choosing the "+choose(["Typescript","Cppkies"])+" edition of Omniscient Cookies!<br>(No warranties, no refunds)","What do Omniscient Cookies taste like?<br>Study reveals a flavor 'somewhere between amateur Javascript and messy programming'","Also try <a href=\"https://github.com/staticvariablejames/SpicedCookies/\" target=\"_blank\">Spiced Cookies</a>!","You stared into the cookie,<br>and the cookie stared back","Check out the <a href=\"https://github.com/gamrguy/OmniscientCookies/\" target=\"_blank\">GitHub page</a>!"],ma={init:function(){ia.smoothBuildings.apply(),ia.scrollingBuildings.apply(),ia.buffTooltips.apply(),ia.tooltipWobble.apply(),ia.cycliusGains.apply(),ia.stockInfo.apply(),ia.fancyBuildings.apply(),ia.fancyCursors.apply(),ia.fancyWrinklers.apply(),ia.skruuiaRebalance.apply(),ia.dangerousStocks.apply(),ia.cycliusInfo.apply(),Qe.on("draw",function(){return na.drawRoutine.run()}),Qe.on("logic",function(){return na.logicRoutine.run()}),Qe.on("reset",function(){return na.resetRoutine.run()}),Qe.on("optionsMenu",function(){return ea.customOptionsMenu()}),Game.Notify("Loaded "+Zi+" "+Ji,"<q>"+choose(ua)+"</q>",[10,31],6)},save:function(){return JSON.stringify({settings:ta.save(),saveData:sa.save()})},load:function(e){var i=JSON.parse(e);ta.load(i.settings),sa.load(i.saveData),ia.buySellBulk.apply(),ia.scrollbarStyle.toggle(ta.autoScrollbar),ia.buildingTooltips.toggle(ta.betterBuildingTooltips),ia.miscGrandmaFixes.toggle(ta.betterGrandmas),ia.cursedFingerTweaks.toggle(ta.cursedFinger),ia.displaySeasonUnlock.toggle(ta.displaySeasons),ia.statsUpgradeCategories.toggle(ta.separateTechs||ta.separateSeasons),ia.optiCookies.toggle(ta.optiCookies),ia.dangerousBrokers.toggle(ta.dangerousBrokers),ia.heavenlyCookies.toggle(ta.heavenlyCookies),ia.buildingPriceBuff.toggle(ta.buildingPriceBuff)}},pa=Object.freeze({__proto__:null,name:Zi,version:Ji,Util:Qi,Config:ea,Patches:ia,Logger:aa,Routines:na,GrandmaSupport:Ki,vars:qe,settings:ta,saveData:sa,mod:ma});window.OmniCookies?(aa.warn("Mod loaded twice???"),da=window.OmniCookies):(Qe.onLoad.push(function(){Game.registerMod(Zi,ma)}),da=pa,window.OmniCookies=pa);var ga=da;return ga});
//# sourceMappingURL=main.js.map
