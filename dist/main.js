(function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"==typeof globalThis?e||self:globalThis,e.OmniCookies=i())})(this,function(){'use strict';var k=Math.E,xe=Math.abs,Oe=Math.sin,we=Math.PI,Be=Math.max,Fe=Math.floor,Ee=Math.pow,De=Math.min;function e(e,i){var t=Math.log;void 0===i&&(i=Game.priceIncrease);var n=Game.cookies;n/=Game.modifyBuildingPrice(e.name,e.basePrice);var a=e.amount-e.free;return Fe(t(Ee(i,a)+(i-1)*n)/t(i)-e.amount)}function i(e,i,n,a){var s=Math.ceil;void 0===n&&(n=Game.priceIncrease);var o,r=Be(0,e.amount-e.free);if(a){if(0>=r)return 0;r--,o=t(n,Be(0,r-i),r)}else o=t(n,r,r+i-1);return o=Game.modifyBuildingPrice(e.name,o*e.basePrice),a&&(o*=e.getSellMultiplier()),s(o)}function t(e,i,t){if(0>e)return-1;if(0==e)return 0;if(1==e)return t-i;if(i==t)return Ee(e,i);var n=(Ee(e,i)-1)/(e-1),a=(Ee(e,t+1)-1)/(e-1);return a-n}function n(e,i){var t=Date.now()/1e3/(3600*e);return i&&(t+=(new Date().getTimezoneOffset()+60)/60/e),t%=1,2*(t*we)}function a(e,i){if(e)for(var t,n=0,a=Object.keys(e);n<a.length;n++)t=a[n],t in i&&(i[t]=e[t])}function s(e){var i=Game.Upgrades["Milk selector"];i.icon=0==e?Game.Milk.icon:i.choicesFunction()[e].icon,Game.upgradesToRebuild=1}function o(e){return e.grandma&&e.grandma.bought?Fe(Game.Objects.Grandma.amount/(e.id-1)):-1}function r(e){var i=document.getElementById("centerArea");i.style.overflowY=e}function d(e,i){var t=setInterval(function(){Game.Objects[e].minigameLoaded&&(i(),clearInterval(t))},250)}function c(e){Game.Loader.assetsLoading[e]||Game.Loader.assetsLoaded[e]||(Game.Loader.assets[e]={},Game.Loader.Replace(e,e),Game.Loader.assetsLoading.push(e))}function p(e,i,t){var n=Math.cos,a=e+Oe(-t.r)*-(t.h/2-t.o),s=i+n(-t.r)*-(t.h/2-t.o),o=Math.sqrt(a*a+s*s),r=Math.atan2(s,a),d=r-t.r,c=n(d)*o,p=Oe(d)*o;return!!(c>-.5*t.w&&c<.5*t.w&&p>-.5*t.h&&p<.5*t.h)}function u(e){console.warn("[Omniscient Cookies] "+e)}function m(e,i){function t(){this.constructor=e}Ve(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),r=0,t=0;t<n;t++)for(var d=arguments[t],a=0,c=d.length;a<c;a++,r++)o[r]=d[a];return o}function f(e,i){var t=xe((e-1)/i%1),n=e/i;return Fe(n-t)<n&&(n+=1),Fe(n)}var Ue,Ne="v2.2.4",Re={lastMilk:-1,lastAutoMilk:void 0,buffsById:[],cursedPs:0,cursedPsMult:0,ascendMeterLevel:void 0,ascendMeterPercent:void 0,levelDiff:0,patchedTrueCyclius:!1,prevShortcut:0,bannedPseudoCookies:{},skipModifyPrice:!1,bannedGrandmas:{}};(function(e){e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL"})(Ue||(Ue={}));var _e,He=Object.freeze({__proto__:null,get ButtonType(){return Ue},calcMaxBuyBulk:function(t,n,a){void 0===a&&(a=Game.priceIncrease);var s=0,o=0,r=0;return(-1==n&&(n=1/0),Game.cookies==1/0&&n==1/0)?{totalPrice:1/0,maxPrice:1/0,maxAmount:n}:(s=i(t,n,a),r=De(n,e(t,a)+t.free),o=i(t,r,a),{totalPrice:s,maxPrice:o,maxAmount:r})},quickCalcMaxBuy:e,quickCalcBulkPrice:i,powerSumRange:t,cycliusCalc:n,loadData:a,switchMilkIcon:s,getNumSynergyGrandmas:o,gainInstantPassiveCpS:function(e){for(var i,t=Game.cookiesPs*e,n=0,a=Game.wrinklers;n<a.length;n++)i=a[n],2==i.phase&&(i.sucked+=t*Game.cpsSucked,Game.cookiesSucked+=t*Game.cpsSucked);t*=1-Game.cpsSucked;for(var s,o=0,r=Game.ObjectsById;o<r.length;o++)s=r[o],s.totalCookies+=s.storedTotalCps*Game.globalCpsMult*e;Game.Earn(t)},scrollbarStyle:r,onMinigameLoaded:d,loadCustomAsset:c,holdingButton:function(e){return Game.keys[e]==null?0:Game.keys[e]},inRect:p});(function(e){e[e.Default=0]="Default",e[e.Fast=1]="Fast",e[e.Fancy=2]="Fancy"})(_e||(_e={}));var We=function(){function e(){this.version=Ne,this.autoScrollbar=!0,this.scrollingBuildings=!0,this.smoothBuildings=!0,this.buffTooltipDuration=!0,this.betterBuildingTooltips=!0,this.betterGrandmas=!0,this.separateTechs=!0,this.enhancedBulk=!0,this.buildingsBypassFancy=_e.Default,this.cursorsBypassFancy=_e.Default,this.wrinklersBypassFancy=_e.Default,this.optimizeBuildings=!1,this.preserveWrinklers=!1,this.detailedCyclius=!0,this.zonedCyclius=!1,this.trueCyclius=!1,this.stockValueData=!0,this.dangerousStocks=!1,this.tooltipWobble=!1,this.fancyMilkSelect=!0,this.improveMagicMeter=!0,this.skruuiaRebalance=!1,this.improveAscendMeter=!0,this.displaySeasons=!0,this.separateSeasons=!1,this.bringGrandmaToWork=!0,this.cursedFinger=!1,this.optiCookies=!1,this.dangerousBrokers=!1,this.heavenlyCookies=!0,this.buildingPriceBuff=!1,this.drawTimerFix=!1,this.alternateStockMarket=!1}return e.prototype.set=function(e,i){typeof i==typeof this[e]&&(this[e]=i)},e.prototype.get=function(e){return this[e]},e.prototype.save=function(){return this},e.prototype.load=function(e){e.version&&a(e,this)},e}(),qe=new We,ze=function(){function e(){this.version=Ne,this.stockAverages=[],this.frozenWrinks=null}return e.prototype.save=function(){return this.cryosleepWrinklers(),this},e.prototype.load=function(e){a(e,this),this.thawWrinklers()},e.prototype.reset=function(){this.stockAverages=[],this.frozenWrinks=null},e.prototype.cryosleepWrinklers=function(){this.frozenWrinks=qe.preserveWrinklers?Game.wrinklers:null},e.prototype.thawWrinklers=function(){if(qe.preserveWrinklers&&this.frozenWrinks){var e=Game.wrinklers,i=Game.SaveWrinklers();Game.wrinklers=this.frozenWrinks;var t=Game.SaveWrinklers();if(i.number!=t.number||i.shinies!=t.shinies)return;for(var n,a=0,s=Game.wrinklers;a<s.length;a++)n=s[a],2==n.phase&&(n.sucked+=Game.cookiesPs/Game.fps*Game.cpsSucked*Game.loopT);t=Game.SaveWrinklers();var o=0==i.amount||0==t.amount?i.amount==t.amount?1:0:De(i.amount/t.amount,t.amount/i.amount),r=0==i.amountShinies||0==t.amountShinies?i.amountShinies==t.amountShinies?1:0:De(i.amountShinies/t.amountShinies,t.amountShinies/i.amountShinies),d=.99;if(o<d||r<d)return void(Game.wrinklers=e)}},e}(),$e=new ze,Xe=Object.freeze({__proto__:null,log:function(e){console.log("[Omniscient Cookies] "+e)},warn:u,error:function(e){console.error("[Omniscient Cookies] "+e)}}),Ve=function(e,i){return Ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])},Ve(e,i)},Ye="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,Ke=function(e,i){return i={exports:{}},e(i,i.exports),i.exports}(function(i){(function(t,e){i.exports=e()})(Ye,function(){function Ne(t,e){function n(){this.constructor=t}U(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Re(c,e,n,p){return new(n||(n=Promise))(function(i,a){function o(i){try{s(p.next(i))}catch(e){a(e)}}function t(i){try{s(p["throw"](i))}catch(e){a(e)}}function s(a){a.done?i(a.value):new n(function(e){e(a.value)}).then(o,t)}s((p=p.apply(c,e||[])).next())})}function He(t,e){function n(t){return function(e){return i([t,e])}}function i(a){if(o)throw new TypeError("Generator is already executing.");for(;g;)try{if(o=1,p&&(u=2&a[0]?p["return"]:a[0]?p["throw"]||((u=p["return"])&&u.call(p),0):p.next)&&!(u=u.call(p,a[1])).done)return u;switch((p=0,u)&&(a=[2&a[0],u.value]),a[0]){case 0:case 1:u=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++,p=a[1],a=[0];continue;case 7:a=g.ops.pop(),g.trys.pop();continue;default:if((u=g.trys,!(u=0<u.length&&u[u.length-1]))&&(6===a[0]||2===a[0])){g=0;continue}if(3===a[0]&&(!u||a[1]>u[0]&&a[1]<u[3])){g.label=a[1];break}if(6===a[0]&&g.label<u[1]){g.label=u[1],u=a;break}if(u&&g.label<u[2]){g.label=u[2],g.ops.push(a);break}u[2]&&g.ops.pop(),g.trys.pop();continue;}a=e.call(t,g)}catch(e){a=[6,e],p=0}finally{o=u=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var o,p,u,m,g={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return m={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m}function We(){for(var i=0,s=0,p=arguments.length;s<p;s++)i+=arguments[s].length;for(var o=Array(i),t=0,s=0;s<p;s++)for(var u=arguments[s],d=0,m=u.length;d<m;d++,t++)o[t]=u[d];return o}function qe(i){return i.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function a(s,r){var n=null===r[0],i=/(?:)/;null!==r[0]&&(i="string"==typeof r[0]?new RegExp(qe(r[0]),"g"):r[0],!i.test(s)&&console.warn("Nothing to inject."));var d=/(\)[^{]*{)/,a=/(}?)$/;switch(r[2]){case"before":s=n?s.replace(d,"$1"+r[1]):s.replace(i,""+r[1]+r[0]);break;case"replace":s=n?r[1]:s.replace(i,r[1]);break;case"after":s=n?s.replace(a,r[1]+"$1"):s.replace(i,""+r[0]+r[1]);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}return s}function t(t,e,n,i,o){void 0===o&&(o={});var d=Function.apply(void 0,We(Object.keys(o),["return ("+a(t.toString(),[e,n,i])+")"])).apply(void 0,Object.values(o));return d.prototype=t.prototype,d}function s(t,e,n){void 0===n&&(n={});for(var p,u=t.toString(),m=0,g=e;m<g.length;m++)p=g[m],u=a(u,p);var d=Function.apply(void 0,We(Object.keys(n),["return ("+u+")"])).apply(void 0,Object.values(n));return d.prototype=t.prototype,d}function ze(i,e){for(var t in e)i[t]=e[t]}function c(i){return i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()}function u(i,e){return i.hasOwnProperty(e)}function r(t){for(var s,d=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],i="",c=0,p=d;c<p.length;c++)for(s=p[c];t>=s[0];)i+=s[1],t-=s[0];return i}function p(i){switch(i){case"mod":return{achievements:{},buildings:{},upgrades:{}};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!");}}function d(){return{mods:{},foreign:p("mod"),saveVer:1,dragon:p("dragon")}}function i(){Me.save=H=d()}function $e(i){return H.foreign.buildings[i.name]||p("building")}function o(c){var e=c.amount,n=c.bought,i=c.free,o=c.totalCookies,a=c.level,r=c.muted,t=c.minigameSave,s=c.name;H.foreign.buildings[s]={amount:e,bought:n,free:i,totalCookies:o,level:a,muted:r,minigameSave:t}}function m(i){return H.foreign.upgrades[i.name]||p("upgrade")}function e(i){H.foreign.upgrades[i.name]={unlocked:!!i.unlocked,bought:!!i.bought}}function g(i){return H.foreign.achievements[i.name]||p("achievement")}function n(i){H.foreign.achievements[i.name]={won:!!i.won}}function f(){"sync"!==H.dragon.level&&H.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=H.dragon.level),"sync"!==H.dragon.auras[0]&&H.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=H.dragon.auras[0]),"sync"!==H.dragon.auras[1]&&H.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=H.dragon.auras[1])}function k(){for(var c,p=0,u=Me.customBuildings;p<u.length;p++)c=u[p],ze(c,$e(c));for(var i,k=0,h=Me.customUpgrades;k<h.length;k++)i=h[k],ze(i,m(i)),i.bought&&Game.CountsAsUpgradeOwned(i.pool)&&Game.UpgradesOwned++;for(var r,y=0,b=Me.customAchievements;y<b.length;y++)r=b[y],ze(r,g(r)),r.won&&Game.CountsAsAchievementOwned(r.pool)&&Game.AchievementsOwned++;f()}function h(){for(var c,p=0,u=Me.customBuildings;p<u.length;p++)c=u[p],o(c);for(var i,m=0,g=Me.customUpgrades;m<g.length;m++)i=g[m],e(i);for(var r,f=0,k=Me.customAchievements;f<k.length;f++)r=k[f],n(r)}function y(t){var e=d();if("object"!=typeof t||null===t)return e;if(!u(t,"saveVer")||"number"!=typeof t.saveVer||1<t.saveVer)return e;if(e.foreign=u(t,"foreign")?function(c){var e=p("mod");if("object"!=typeof c||null===c)return e;if(u(c,"buildings")&&"object"==typeof c.buildings&&null!==c.buildings)for(var n in c.buildings){var i=c.buildings[n];if("object"==typeof i&&null!==i)for(var o in e.buildings[n]=p("building"),i)typeof e.buildings[n][o]==typeof i[o]&&(e.buildings[n][o]=i[o])}if(u(c,"upgrades")&&"object"==typeof c.upgrades&&null!==c.upgrades)for(var m in c.upgrades){var r=c.upgrades[m];if("object"==typeof r&&null!==r)for(var o in e.upgrades[m]=p("upgrade"),e.upgrades[m])typeof e.upgrades[m][o]==typeof r[o]&&(e.upgrades[m][o]=r[o])}if(u(c,"achievements")&&"object"==typeof c.achievements&&null!==c.achievements)for(var t in c.achievements){var s=c.achievements[t];if("object"==typeof s&&null!==s)for(var o in e.achievements[t]=p("achievement"),e.achievements[t])typeof e.achievements[t][o]==typeof s[o]&&(e.achievements[t][o]=s[o])}return e}(t.foreign):p("mod"),u(t,"dragon")&&"object"==typeof t.dragon&&null!==t.dragon&&(u(t.dragon,"level")&&("number"==typeof t.dragon.level||"sync"===t.dragon.level)&&(e.dragon.level=t.dragon.level),u(t.dragon,"auras")&&t.dragon.auras instanceof Array))for(var n in t.dragon.auras){var a=t.dragon.auras[n];("number"==typeof a||"sync"===a)&&(e.dragon.auras[n]=a)}return e}function b(t){var e;try{e=JSON.parse(t)}catch(e){""!==t&&console.warn("CPPKIES: Found invalid save, creating new one..."),i()}H=Me.save=y(e),k()}function v(){return h(),JSON.stringify(H)}function O(i,e){q[i]=e}function w(i){if($.includes(i))throw new Error("Recursive alias");return($.push(i),i in q)?w(q[i]):($=[],i)}function S(t){return new Promise(function(e){var n=new Image;n.addEventListener("load",function(){e(n)}),n.crossOrigin="Anonymous",n.src=t})}function L(i){return new Promise(function(t){i.canvas.toBlob(function(i){t(URL.createObjectURL(i))})})}function C(m,t,e,n,o,a){return new Promise(function(i){e[0]instanceof Array||(e=[e]),e=e;var r={};for(var s in e)for(var d in e[s])if(e[s][d]){if(e[s][d]=e[s][d].toString().toLowerCase(),!(e[s][d]in t))throw new Error("Invalid icon name");r[e[s][d]]=[parseInt(d),parseInt(s)]}var c=document.createElement("canvas").getContext("2d"),u=new Image;u.addEventListener("load",function(){for(var s in c.canvas.width=o[0],c.canvas.height=o[1],r)c.drawImage(u,r[s][0]*n[0],r[s][1]*n[1],n[0],n[1],t[s][0]*n[0],t[s][1]*n[1],n[0],n[1]);var e,p=function(){L(c).then(i)};a&&(e=a(c)),e instanceof Promise?e.then(p):p()}),u.crossOrigin="Anonymous",u.src=m})}function G(i){return i=We(i),(void 0===i[2]||null===i[2])&&(i[2]=Me.iconLink),i[2]=w(i[2]),i}function M(a){var e=new N,n=[new R("tooltip",function(){a.tooltip=t(t(a.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new R("buy",function(){a.buy=t(a.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new R("levelUp",function(){a.levelUp=t(a.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:a})})];n.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Me.hooks.on("buildingCps",function(t){return{building:t.building,cps:Game.Objects[t.building]===a?e.emit("cps",t.cps):t.cps}}),Z[a.name]=e}function B(){for(var t,a=0,s=Game.ObjectsById;a<s.length;a++)t=s[a],Z[t.name]||M(t)}function T(i){return"fortune"===i.tier}function j(i){for(var e,t=1,s=1;s<=i;s++)t+=null!==(e=ce[s])&&void 0!==e?e:ce["default"];return 9*E(10,t)}function P(){Me.on("getIcon",function(t){var a=t.icon,e=t.type,i=t.tier;return Me.customTiers.forEach(function(t){t.keyName===i.toString()&&t.iconLink&&(a[2]=t.iconLink)}),{icon:a,type:e,tier:i}}),Me.on("getIcon",function(t){var a=t.icon,n=t.type,e=t.tier;return Me.customBuildings.forEach(function(i){i.name===n&&i.iconLink&&(a[2]=i.iconLink)}),{icon:a,tier:e,type:n}}),Me.on("getIcon",function(t){var e=t.icon,n=t.type,i=t.tier;return void 0!==e[2]&&null!==e[2]||u(Game.Tiers[i.toString()],"iconLink")||(e[2]=""),{icon:e,tier:i,type:n}}),Me.on("preSave",function(){if(0!==Game.dragonAura&&(H.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(H.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof Le&&(H.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof Le&&(H.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=_)for(H.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=_;)Game.dragonLevel--}),Me.on("postSave",function(){"sync"!==H.dragon.auras[0]&&Game.dragonAuras[H.dragon.auras[0]]&&(Game.dragonAura=H.dragon.auras[0]),"sync"!==H.dragon.auras[1]&&Game.dragonAuras[H.dragon.auras[1]]&&(Game.dragonAura2=H.dragon.auras[1]),"sync"!==H.dragon.level&&Game.dragonLevels[H.dragon.level]&&(Game.dragonLevel=H.dragon.level)}),Me.on("reset",function(){H.dragon.auras=["sync","sync"],H.dragon.level="sync"}),Me.on("specialPic",function(t){var e,a=Game.dragonLevels[Game.dragonLevel];return"dragon"===t.tab&&a instanceof Te&&(t.pic=null!==(e=a.picLink)&&void 0!==e?e:t.pic),t})}var x,A=xe,I=Fe,F=De,E=Ee,D=Be,U=function(i,e){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,e){i.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},U(i,e)},N=function(){function i(){this._events={}}return i.prototype.on=function(i,e){this._events[i]?this._events[i].push(e):this._events[i]=[e]},i.prototype.once=function(t,e){var n=this;this.on(t,function(i){return n.off(t,e),e(i)})},i.prototype.off=function(i,e){this._events[i].splice(this._events[i].indexOf(e),1)},i.prototype.emit=function(s){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var d=e[0];this._events[s]||(this._events[s]=[]);for(var c,p=0,u=this._events[s];p<u.length;p++)c=u[p],d=c(d);return d},i.prototype.constEmit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._events[t]||(this._events[t]=[]);for(var s,d=0,c=this._events[t];d<c.length;d++)s=c[d],s(e[0])},i}(),R=function(){return function(i,e){this.value=i,this.func=e}}(),_=Game.dragonLevels.length+0,H=d(),q={},$=[],X={},z={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},V={},Y={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},Z={},ee=[],ie=function(h){function e(i,e,n,a,o,t,s,r,d,c){var p,u,y=this;if(Game.Objects[i])throw new Error("Can't create building, \""+i+"\" is already used as a building name");0!==a[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==o[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),y=h.call(this,i,e,n,o[1],a[0],t,0,s,r)||this,ee.push(y),Z[i]||M(y);var x=function(t){if(0>=parseInt(t))return"continue";var a=Game.ObjectsById[t];if(a.canvas=l("rowCanvas"+t),!a.canvas)return"continue";if(a.ctx=a.canvas.getContext("2d"),a.canvas.addEventListener("mouseover",function(){a.mouseOn=!0}),a.canvas.addEventListener("mouseout",function(){a.mouseOn=!1}),a.canvas.addEventListener("mousemove",function(t){var i=a.canvas.getBoundingClientRect();a.mousePos[0]=t.pageX-i.left,a.mousePos[1]=t.pageY-i.top}),a.minigame&&a.minigameLoaded){var e=a.minigame.save();a.minigame.launch(),a.minigame.load(e)}};for(var b in Game.ObjectsById)x(b);y.buildingLink=null!==(p=o[2])&&void 0!==p?p:Me.buildingLink,y.iconLink=w(null!==(u=a[2])&&void 0!==u?u:Me.iconLink),d&&(Game.foolObjects[i]=d),c&&(Game.goldenCookieBuildingBuffs[i]=c),y.iconLink&&Z[y.name].on("tooltip",function(i){return y.locked?i:i.replace("background-position","background-image:url("+y.iconLink+");background-position")}),Game.BuildStore(),y.buildingLink&&Me.hooks.on("buildStore",function(){l("productIcon"+y.id).style.backgroundImage="url("+y.buildingLink+")",l("productIconOff"+y.id).style.backgroundImage="url("+y.buildingLink+")"}),Game.BuildStore(),y.canvas=l("rowCanvas"+y.id),y.ctx=y.canvas.getContext("2d"),y.pics=[];var O=document.createElement("div");O.className="tinyProductIcon",O.id="mutedProduct"+y.id,O.style.display="none",y.buildingLink&&(O.style.backgroundImage="url("+y.buildingLink+")"),O.style.backgroundPositionX="-"+a[0]+"px",O.style.backgroundPositionY="-"+a[1]+"px",O.addEventListener("click",function(){y.mute(0),window.PlaySound(y.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(y.canvas,"mouseover",function(){y.mouseOn=!0}),window.AddEvent(y.canvas,"mouseout",function(){y.mouseOn=!1}),y.canvas.addEventListener("mousemove",function(i){var t=y.canvas.getBoundingClientRect();y.mousePos[0]=i.pageX-t.left,y.mousePos[1]=i.pageY-t.top}),l("buildingsMute").appendChild(O);var f=$e(y);for(var b in f)y[b]=f[b];return Game.recalculateGains=1,y}return Ne(e,h),e}(Game.Object),ne=[],te=function(p){function e(i,e,n,a,o){void 0===o&&(o=function(){});var r=p.call(this,i,"function"==typeof e?"":e,"function"==typeof n?0:n,"function"==typeof a?[0,0]:G(a),o)||this;"function"==typeof e&&(r.descFunc=e),"function"==typeof n&&(r.priceFunc=n),"function"==typeof a&&(r.iconFunction=function(){return G(a())}),ne.push(r);var s=m(r);for(var d in s)r[d]=s[d];return Game.upgradesToRebuild=1,r.bought&&Game.CountsAsUpgradeOwned(r.pool)&&Game.UpgradesOwned++,r}return Ne(e,p),e}(Game.Upgrade),ae=function(c){function e(n,e,i,o,a,r,p){void 0===r&&(r=["Legacy"]),void 0===p&&(p=function(){});var u=c.call(this,n,e,i,o,p)||this;return u.pool="prestige",u.posX=a[0],u.posY=a[1],u.parents=r.map(function(i){return Game.Upgrades[i]||Game.UpgradesById[i]}),Game.PrestigeUpgrades.push(u),Game.UpgradePositions[u.id]=a,u}return Ne(e,c),e}(te),se=function(t){function e(n,e,i,s){var d=this;return"string"==typeof i&&(i=Game.Objects[i]),d=t.call(this,n,c(i.plural)+" are <b>twice</b> as efficient.<q>"+e+"</q>",i.basePrice*Game.Tiers[s].price,Game.GetIcon(i.name,s))||this,Game.SetTier(i.name,s),d.buildingTie1=i,T(d)&&(d.order=19e3,i.fortune=d),isNaN(parseInt(s.toString()))||(s=parseInt(s.toString())),"number"==typeof s&&(d.order=100*(i.id+1)+d.id/1e3,d.order-=75*D(0,F(i.id-4,3)),8<=i.id&&(d.order-=75)),"fortune"===s&&Game.Tiers[s].upgrades.push(d),i.buyFunction.apply(i),d}return Ne(e,t),e}(te),oe=function(a){function e(n,e,i,d){var p=this;if(d){if(!d.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+d+"\", URL must end with .png");d=d.substring(0,d.length-4)}"string"==typeof i&&(i=Game.Objects[i]);var u=i.id-1;return 1===u?u="grandma":u+=" grandmas",p=a.call(this,n,"Grandmas are <b>twice</b> as efficient. "+c(i.plural)+" gain <b>+1% CpS</b> per "+u+".<q>"+e+"</q>",i.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,i.grandma=p,p.buildingTie=i,p.order=250+p.id/1e3,12<=i.id&&(p.order+=5),Game.GrandmaSynergies.push(p.name),d&&Me.hooks.on("grandmaPic",function(i){return p.bought?We(i,[d]):i}),Game.Objects.Grandma.redraw(),i.buyFunction.apply(i),p}return Ne(e,a),e}(te),re=function(p){function e(n,e,i,u,m){var r=this;"string"==typeof i&&(i=Game.Objects[i]),"string"==typeof u&&(u=Game.Objects[u]);var g=Game.GetIcon(i.name,m);if(i.basePrice>u.basePrice){var s=i;i=u,u=s}return r=p.call(this,n,c(i.plural)+" gain <b>+5% CpS</b> per "+u.name.toLowerCase()+".<br>"+c(u.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+i.name.toLowerCase()+".<q>"+e+"</q>",(10*i.basePrice+1*u.basePrice)*Game.Tiers[m].price,g)||this,r.tier=m,r.buildingTie1=i,r.buildingTie2=u,r.order=5e3+r.id/1e3,i.synergies.push(r),u.synergies.push(r),Game.Tiers[m].upgrades.push(r),Game.RebuildUpgrades(),i.buyFunction.apply(i),r}return Ne(e,p),e}(te),le=[5,7,8,9,10],de=function(d){function e(n,e,i,o){void 0===o&&(o=20);var c=this,p=Game.Objects.Cursor,t=parseInt(i.toString());return c=d.call(this,n,"Multiplies the gain from Thousand fingers by <b>"+o+"</b>.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(t)?p.basePrice*Game.Tiers[i].price:E(10,le[F(t-4,le.length-1)]+3*D(t-8,0)),Game.GetIcon(p.name,i))||this,c.tier=i,c.pool="",c.order=100+c.id/1e3,Me.on("cursorFingerMult",function(i){return c.bought?i*o:i}),Game.Tiers[i].special||isNaN(t)||Me.buildingHooks.Cursor.on("buy",function(){p.amount>=(4===t?25:50*(t-4))&&Game.Unlock(c.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(c),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),c}return Ne(e,d),e}(te),ce={1:5,2:4,4:4,default:3},pe=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],ue=function(d){function e(n,e,i,o,c,r){void 0===o&&(o=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:pe[(parseInt(i.toString())-1)%(pe.length-1)]),void 0===r&&(r=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:1===i?.5:i-1);var p=d.call(this,n,"You gain <b>more CpS</b> the more milk you have.<q>"+e+"</q>",Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null!==c&&void 0!==c?c:0:j(i),Game.GetIcon("Kitten",i))||this;return p.tier=i,p.kitten=!0,p.pool="",null===o&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[i].special||isNaN(parseInt(i.toString())))&&void 0===c&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==r&&Me.on("logic",function(){Game.milkProgress>=r&&Game.Unlock(p.name)}),p.order=2e4+p.id/1e3,null!==o&&Me.on("rawCpsMult",function(i){var e=p.bought?1+Game.milkProgress*o*Me.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=e,i*e}),Game.UpgradesByPool.kitten.push(p),"fortune"===i&&Game.Tiers[i].upgrades.push(p),p}return Ne(e,d),e}(te),me=function(s){function e(n,e,i,o){void 0===o&&(o=1);var d=s.call(this,n,"Clicking gains <b>+"+o+"% of your CpS</b>.<q>"+e+"</q>",E(10,3+2*parseInt(i.toString())),Game.GetIcon("Mouse",i))||this;d.tier=i,d.pool="";var r=parseInt(i.toString());return d.order=150+d.id/1e3,Me.on("cpcAdd",function(i){return d.bought?i+Game.cookiesPs*o/100:i}),Game.Tiers[i].special||isNaN(r)||Me.on("check",function(){Game.handmadeCookies>=E(10,1+2*r)&&Game.Unlock(d.name)}),"fortune"===i&&Game.Tiers[i].upgrades.push(d),d}return Ne(e,s),e}(te),ge=function(p){function e(n,e,i,o,a,r,t){var s,u=p.call(this,n,"Cookie production multiplier <b>+"+Beautify("function"==typeof a?a():a,1)+"%</b>.<q>"+e+"</q>",i,o)||this;return u.power=a,u.pool="cookie",u.order=(null!==(s=null!==t&&void 0!==t?t:Me.cookieOrder)&&void 0!==s?s:10020)+u.id/1e3,u.unlockAt={name:n,cookies:("function"==typeof i?i():i)/20,require:null===r||void 0===r?void 0:r.require,season:null===r||void 0===r?void 0:r.season},Game.UnlockAt.push(u.unlockAt),Game.UpgradesByPool.cookie.push(u),Game.cookieUpgrades.push(u),u}return Ne(e,p),e}(te),ke=[],fe=function(){return function(p,e,n,i,u,m,g,f,k){void 0===i&&(i=!1),void 0===u&&(u="auto"),void 0===m&&(m=null),void 0===g&&(g=null),void 0===f&&(f=null),void 0===k&&(k="auto");var h;this.name=p,this.color=n,this.special=i,this.keyName="auto"===k?i?p:(Object.keys(Game.Tiers).filter(function(i){return!isNaN(parseInt(i))}).length+1).toString():k,null===m&&(this.unlock=-1),"number"==typeof m&&(this.unlock=m),(!1===i&&null===m||"auto"===m)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof g&&(this.achievUnlock=g),(!1===i&&null===g||"auto"===g)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),f&&(this.req=f),this.price="auto"===u?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(i){return!isNaN(parseInt(i))}).length.toString()].price:u,this.iconRow=e[1],this.iconLink=w(null!==(h=e[2])&&void 0!==h?h:Me.iconLink),Game.Tiers[this.keyName]=this,ke.push(this)}}(),he=[],ye=function(t){function e(n,e,i){var s=t.call(this,n,e,G(i))||this;return ze(s,g(s)),he.push(s),s.won&&Game.CountsAsAchievementOwned(s.pool)&&Game.AchievementsOwned++,s}return Ne(e,t),e}(Game.Achievement),be=function(t){function e(n,e,i,s){void 0===s&&(s=E(10,I(1.5*Game.BankAchievements.length+2)));var o=t.call(this,n,"Bake <b>"+toFixed(s)+"</b> cookie"+(1===A(s)?"":"s")+" in one ascension."+(i?"<q>"+i+"</q>":""),e)||this;return o.treshold=s,o.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(o),o}return Ne(e,t),e}(ye),ve=function(t){function e(n,e,i,s){void 0===s&&(s=E(10,I(1.2*Game.BankAchievements.length)));var o=t.call(this,n,"Bake <b>"+toFixed(s)+"</b> cookie"+(1===A(s)?"":"s")+" per second."+(i?"<q>"+i+"</q>":""),e)||this;return o.treshold=s,o.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(o),o}return Ne(e,t),e}(ye),Ce=function(c){function e(n,e,i,o){var a=this,p="object"==typeof i?i:Game.Objects[i],t=null,u=-1;if(0===p.id){switch(o){case"cursor2":t=[0,6],u=2;break;case"cursor50":t=[1,6],u=50;break;default:if(0>=Game.Tiers[o].achievUnlock){console.warn("Tier has invalid unlock amount");break}u=1===o?1:2*Game.Tiers[o].achievUnlock;}Me.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=u&&Game.Win(a.name)})}else u=Game.Tiers[o].achievUnlock;return a=c.call(this,n,"Have <b>"+u+"</b> "+(1===A(u)?p.single:p.plural)+"."+(e?"<q>"+e+"</q>":""),null!==t&&void 0!==t?t:Game.GetIcon(p.name,o))||this,Game.SetTier(p.name,"cursor2"===o||"cursor50"===o?1:o),p.tieredAchievs[o]=a,a.buildingTie=p,a.order=1e3+100*p.id+a.id/1e3,a.order-=75*D(0,F(p.id-4,3)),8<=p.id&&(a.order-=75),0===p.id&&(a.order+=50),a}return Ne(e,c),e}(ye),Oe=function(c){function e(n,e,p,o,a){var r=this;"string"==typeof e&&(e=Game.Objects[e]);var u=[e.iconColumn,21+p,e instanceof ie?e.iconLink:void 0],s=E(10,12+e.id+(null!==a&&void 0!==a?a:0)+7*(p-1));return r=c.call(this,n,"Make <b>"+toFixed(s)+"</b> cookies just from "+e.plural+"."+(o?"<q>"+o+"</q>":""),u)||this,r.order=1020+100*e.id+r.id/1e3,r.order-=75*D(0,F(e.id-4,3)),8<=e.id&&(r.order-=75),0===e.id&&(r.order+=50),e.productionAchievs.push({pow:s,achiev:r}),r}return Ne(e,c),e}(ye),we=function(t){function e(n,e,s){var o=this;"string"==typeof e&&(e=Game.Objects[e]);var d=[e.iconColumn,26,e instanceof ie?e.iconLink:void 0];return o=t.call(this,n,"Reach level <b>10</b> "+e.plural+"."+(s?"<q>"+s+"</q>":""),d)||this,o.order=1020+100*e.id+o.id/1e3,o.order-=75*D(0,F(e.id-4,3)),8<=e.id&&(o.order-=75),0===e.id&&(o.order+=50),e.levelAchiev10=o,o}return Ne(e,t),e}(ye),Se=function(t){function e(n,e,i){var s=this,o=parseInt(e.toString());return s=t.call(this,n,"Make <b>"+toFixed(E(10,1+2*o))+"</b> cookies from clicking."+(i?"<q>"+i+"</q>":""),Game.GetIcon("Mouse",e))||this,s.pool="normal",s.tier=e,s.order=1e3+s.id/1e3,Game.Tiers[e].special||isNaN(o)||Me.on("check",function(){Game.handmadeCookies>=E(10,1+2*o)&&Game.Win(s.name)}),s}return Ne(e,t),e}(ye),Le=function(){function i(t,e,n){this.name=t,this.desc=e,"string"==typeof n&&(n=Game.Objects[n]),this.pic=n instanceof Game.Object?G([n.iconColumn,25,n instanceof ie?n.iconLink:void 0]):n,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==H.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=H.dragon.auras[0]&&(Game.dragonAura=H.dragon.auras[0]),"sync"!==H.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=H.dragon.auras[1]&&(Game.dragonAura2=H.dragon.auras[1])}return i}(),Te=function(){function c(e,n,i,o,a,r,t){void 0===t&&(t=Game.dragonLevels.length-3),this.buy=a,this.picY=0;var p=Game.dragonLevels[t-1];this.name=null!==e&&void 0!==e?e:p.name,this.action=n,this.costStr="string"==typeof i?function(){return i}:i,this.cost=o,r?(this.pic=r[0],this.picY=r[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=r[2]):(this.pic=p.pic,p instanceof c&&(this.picY=p.picY,this.picLink=p.picLink)),Game.dragonLevels.splice(t,0,this),"sync"!==H.dragon.level&&Game.dragonLevels.length>=H.dragon.level&&(Game.dragonLevel=H.dragon.level)}return c}(),je=function(t){function e(n,e,i){var s=this;return"string"==typeof i&&(i=Game.Objects[i]),s=t.call(this,null,"Train "+n+"<br/><small>Aura : "+e+"</small>","100 "+i.plural,function(){return 100<=i.amount},function(){return i.sacrifice(100)})||this,s}return Ne(e,t),e}(Te),Pe=function(){return function(t,e,n,i){if(void 0===i&&(i=!1),this.name=t,this.pic=n,this.special=i,!n.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+n+"\", the URL must end with .png!");i||(this.name="Rank "+r(Game.Milks.length+1)+" - "+t),this.pic=n.substr(0,n.length-4),G(e),this.icon=[e[0],e[1]],this.iconLink=e[2],i?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)}}(),Me={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:Z,buildingHooksById:[],hookAllBuildings:B,customBuildings:ee,customUpgrades:ne,customTiers:ke,save:H,onLoad:[],Building:ie,Upgrade:te,TieredUpgrade:se,Tier:fe,HeavenlyUpgrade:ae,GrandmaSynergy:oe,SynergyUpgrade:re,CursorUpgrade:de,KittenUpgrade:ue,MouseUpgrade:me,CookieUpgrade:ge,Achievement:ye,CpsAchievement:ve,BankAchievement:be,TieredAchievement:Ce,ProductionAchievement:Oe,Level10Achievement:we,MouseAchievement:Se,customAchievements:he,DragonAura:Le,DragonLevel:Te,DragonAuraLevel:je,Milk:Pe,injectCode:t,injectCodes:s,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(i){return Game.GetTieredCpsMult(i)*Game.magicCpS(i.name)*i.baseCps},icons:{relinkColumn:function(p,e,a,o){return void 0===o&&(o=!1),Re(this,void 0,void 0,function(){var t,i,i,r,u;return He(this,function(n){switch(n.label){case 0:for(i in void 0===a&&(!X[p]&&(X[p]=0),a=X[p]++),t={},z)t[i]=[a,z[i][1]];for(i in Game.Tiers)t[Game.Tiers[i].name.toLowerCase()]=t[i.toString()]=[a,Game.Tiers[i].iconRow];return r=O,u=[p],[4,C(o?w(p):p,t,e,[48,48],[48*(a+1),48*(Object.values(t).reduce(function(i,e){return D(i,e[1])},-Infinity)+1)],function(e){return new Promise(function(t){if(w(p)!==p){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),t()}),i.src=w(p),i.crossOrigin="Anonymous"}else t()})})];case 1:return r.apply(void 0,u.concat([n.sent()])),[2];}})})},relinkRow:function(p,e,a,o){return void 0===o&&(o=!1),Re(this,void 0,void 0,function(){var t,i,i,r,u;return He(this,function(n){switch(n.label){case 0:for(i in void 0===a&&(!V[p]&&(V[p]=0),a=V[p]++),t={},Y)t[i]=[Y[i][0],a];for(i in Game.ObjectsById)t[Game.ObjectsById[i].single.toLowerCase()]=t[i]=[Game.ObjectsById[i].iconColumn,a];return r=O,u=[p],[4,C(o?w(p):p,t,e,[48,48],[48*(Object.values(t).reduce(function(i,e){return D(i,e[0])},-Infinity)+1),48*(a+1)],function(e){return new Promise(function(t){if(w(p)!==p){var i=new Image;i.addEventListener("load",function(){e.drawImage(i,0,0),t()}),i.src=w(p),i.crossOrigin="Anonymous"}else t()})})];case 1:return r.apply(void 0,u.concat([n.sent()])),[2];}})})},patchIconsheet:function(y,e,i){var x;return void 0===i&&(i=!0),Re(this,void 0,void 0,function(){var a,r,G,B,M,T,j,P,A,F,I,E,D,U,N;return He(this,function(t){switch(t.label){case 0:return a=document.createElement("canvas").getContext("2d"),[4,S(i?w(y):y)];case 1:for(r=t.sent(),G=[r.width,r.height],B=0,M=e;B<M.length;B++)T=M[B],48*T[0][0]>G[0]&&(G[0]=48*T[0][0]),48*T[0][1]>G[1]&&(G[1]=48*T[0][1]);a.canvas.width=G[0],a.canvas.height=G[1],a.drawImage(r,0,0),j={},P=0,A=e,t.label=2;case 2:return P<A.length?(F=A[P],I=w((null!==(x=F[1][2])&&void 0!==x?x:Me.iconLink)||"img/icons.png"),!!j[I])?[3,4]:(E=j,D=I,[4,S(I)]):[3,6];case 3:E[D]=t.sent(),t.label=4;case 4:a.clearRect(48*F[0][0],48*F[0][1],48,48),a.drawImage(j[I],48*F[1][0],48*F[1][1],48,48,48*F[0][0],48*F[0][1],48,48),t.label=5;case 5:return P++,[3,2];case 6:return U=O,N=[y],[4,L(a)];case 7:return U.apply(void 0,N.concat([t.sent()])),[2];}})})},extraColumnIcons:z,extraRowIcons:Y,alias:O,aliases:q}};window.Cppkies?x=window.Cppkies:(x=Me,window.Cppkies=x,function(){return new Promise(function(a){var o=new N,e=[new R("customMenu",function(){Game.UpdateMenu=t(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","after")}),new R("preSave",function(){Game.WriteSave=t(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new R("postSave",function(){Game.WriteSave=t(Game.WriteSave,"if (type==2 || type==3)","\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"postSave\")\n\t\t\t\t\t","before")}),new R("reset",function(){Game.Reset=t(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.constEmit(\"reset\", hard)\n\t\t\t\t\t","before")}),new R("reincarnate",function(){Game.registerHook("reincarnate",function(){return o.emit("reincarnate")})}),new R("getIcon",function(){Game.GetIcon=s(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];","// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace"],["col=18;","else if (type === \"Mouse\") col = 11;","after"]])}),new R("buildStore",function(){Game.BuildStore=t(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new R("grandmaPic",function(){Game.Objects.Grandma.art.pic=t(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new R("cps",function(){Game.CalculateGains=s(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","// Cppkies injection\n\t\t\t\t\t\tmult = Cppkies.hooks.emit(\"cpsMult\", mult);\n","before"]]),Game.registerHook("cps",function(i){return o.emit("cps",i)})}),new R("cursorFingerMult",function(){Game.Objects.Cursor.cps=t(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before")}),new R("cpc",function(){Game.mouseCps=s(Game.mouseCps,[["var num=0;","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before"],["var out","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cpcAdd\", add);\n","before"]]),Game.registerHook("cookiesPerClick",function(i){return o.emit("cpc",i)})}),new R("buildingCps",function(){Game.CalculateGains=t(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")}),new R("logic",function(){Game.registerHook("logic",function(){return o.emit("logic")})}),new R("draw",function(){Game.registerHook("draw",function(){return o.emit("draw")})}),new R("check",function(){Game.registerHook("check",function(){return o.emit("check")})}),new R("ticker",function(){Game.getNewTicker=t(Game.getNewTicker,"Game.TickerAge=Game.fps*10;","// Cppkies injection\nlist = Cppkies.hooks.emit(\"ticker\", list);\n","before")}),new R("specialPic",function(){Game.DrawSpecial=t(Game.DrawSpecial,"if (hovered || selected)","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","before"),Game.ToggleSpecialMenu=t(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","after")})];e.forEach(function(i){var e;null===(e=i.func)||void 0===e?void 0:e.call(i)}),Game.Loader.Load=t(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=s(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]]),Game.ToggleSpecialMenu=s(Game.ToggleSpecialMenu,[[">=5",">=Game.dragonLevels.findIndex(val => val.name === \"Krumblor, cookie hatchling\")","replace"],[">=25",">=Game.dragonLevels.findIndex(val => val.action === \"Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>\") + 1","replace"]]),Game.Objects.Cursor.buyFunction=t(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=t(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=t(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),a(o)})}().then(function(i){x.hooks=i,x.on=i.on.bind(i),Game.Notify("Cppkies loaded!","",[32,17],1.5);var e=document.createElement("div");e.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(e,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:v,load:b}),Game.Win("Third-party"),B(),Me.onLoad.forEach(function(i){return i()}),Me.onLoad=new Proxy(Me.onLoad,{set:function(t,e,n){return"length"!==e&&n(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(i){return i()}),window.CPPKIES_ONLOAD=new Proxy(Me.onLoad,{set:function(t,e,n){return"length"!==e&&n(),!0}}),P()}));var Ge=x;return Ge})}),Ze=function(){function e(e,i){this.patchFunc=e,this.removeFunc=i,this.applied=!1}return e.prototype.apply=function(){this.applied||(this.applied=!0,this.patchFunc())},e.prototype.remove=function(){this.applied&&this.removeFunc&&(this.applied=!1,this.removeFunc())},e.prototype.toggle=function(e){var i=!this.applied;"undefined"!=typeof e&&(i=e),i?this.apply():this.remove()},e}(),Je=new Ze(function(){return r("auto")},function(){return r("scroll")}),Qe=new Ze(function(){Game.DrawBuildings=Ke.injectCode(Game.DrawBuildings,"Game.drawT%3==0","OmniCookies.settings.smoothBuildings || ","before")}),ei=new Ze(function(){var e=[["if (this.toResize)","if (this.toResize || this.canvas.width != this.canvas.clientWidth || this.canvas.height != this.canvas.clientHeight)","replace"],["this.toResize=false;","$&;this.forceDraw=true;","replace"],["if (typeof(bg)=='string') ctx.fillPattern","let synergyAmount = OmniCookies.settings.bringGrandmaToWork ? OmniCookies.Util.getNumSynergyGrandmas(this) : -1;\n\t\t\tif(OmniCookies.settings.optimizeBuildings && !this.hasUnloadedImages && !this.forceDraw && !this.lastMouseOn && !this.mouseOn && (this.lastAmount == this.amount) && (this.name == 'Grandma' ? true : this.lastSynergyAmount == synergyAmount)) return;\n\t\t\tthis.forceDraw = false;\n\t\t\tthis.lastAmount = this.amount;\n\t\t\tthis.lastMouseOn = this.mouseOn;\n\t\t\tthis.lastSynergyAmount = synergyAmount;\n\t\t\tthis.hasUnloadedImages = Game.Loader.assetsLoaded.indexOf(this.art.bg) == -1;\n\t\t\tlet hasGrandmas = false;\n","before"],["var sprite=Pic(pic.pic);","\nthis.hasUnloadedImages = this.hasUnloadedImages || sprite == Game.Loader.blank;","after"],["0,0,this.canvas.width,this.canvas.height,128,128",",-this.scrollOffX","after"],["var maxI=Math.floor(this.canvas.width","var minI=Math.max(0, Math.floor((-50 + this.scrollOffX) / (w/rows)));\n\t\t\tvar maxI=Math.floor((this.canvas.width + 50 + this.scrollOffX)","replace"],["var i=this.pics.length;","this.pics = [];\nvar i=minI;","replace"],["var usedPic=(typeof(pic)=='string'?pic:pic(this,i));","x-=this.scrollOffX;\n","before"],["var selected=-1;","var speed = 20;\n\t\t\tif(!OmniCookies.settings.smoothBuildings) speed *= 3;\n\t\t\tif(this.mousePos[0] >= (this.canvas.width) - 100 && maxI <= this.amount + rows * 3) {\n\t\t\t\tthis.scrollOffX += Math.floor(speed * ((this.mousePos[0] - (this.canvas.width - 100)) / 100));\n\t\t\t}\n\t\t\tif(this.mousePos[0] <= 100 && this.scrollOffX > 0) {\n\t\t\t\tthis.scrollOffX -= Math.floor(speed * (1 - this.mousePos[0] / 100));\n\t\t\t}\n\t\t\tif(this.scrollOffX < 0 || !OmniCookies.settings.scrollingBuildings) this.scrollOffX = 0;\n","before"],["ctx.drawImage(sprite,Math.floor(pic.x+Math.random()*4-2),Math.floor(pic.y+Math.random()*4-2));","if(Game.drawT%3==0) {\n\t\t\t\tthis.lastRandX = Math.random()*4;\n\t\t\t\tthis.lastRandY = Math.random()*4;\n\t\t\t}\n\t\t\tctx.drawImage(sprite,Math.floor(pic.x+this.lastRandX-2),Math.floor(pic.y+this.lastRandY-2));","replace"],["this.pics.push({x:Math.floor(x),y:Math.floor(y),z:y,pic:usedPic,id:i,frame:frame});","\nif(OmniCookies.settings.bringGrandmaToWork) {\n\t\t\t\tlet grandmas = OmniCookies.GrandmaSupport.tryDrawGrandmas(this, this.pics[this.pics.length-1], i);\n\t\t\t\tif(grandmas && grandmas.length > 0){\n\t\t\t\t\thasGrandmas = true;\n\t\t\t\t\tthis.pics = this.pics.concat(grandmas);\n\t\t\t\t}\n\t\t\t}","after"],["if (this.name=='Grandma')","if (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && hasGrandmas))","replace"],["if (selected==i && this.name=='Grandma')","if (selected==i && (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && pic.grandma)))","replace"],["if (this.mousePos[0]>=pic.x-marginW && this.m","if(this.name == 'Grandma' ? false : !pic.grandma) continue;\n","before"],["/*+' '+pic.id*/","+(this.name == 'Grandma' ? '' : ' '+this.name)","replace"]],t=[["this.muted=val;","\nthis.forceDraw=true;","after"]],n=[["me.pics=[];","\nif(OmniCookies.settings.optimizeBuildings) {\n\t\t\t\tme.forceDraw = true;\n\t\t\t}","after"]];for(var a in Game.Objects){var i=Game.Objects[a];0!=i.id&&(i.scrollOffX=0,i.lastRandX=0,i.lastRandY=0,i.lastOffX=0,i.lastMouseOn=i.mouseOn,i.lastAmount=i.amount,i.lastSynergyAmount=0,i.hasUnloadedImages=!0,i.forceDraw=!0,i.draw=Ke.injectCodes(i.draw,e),i.mute=Ke.injectCodes(i.mute,t),i.redraw=Ke.injectCodes(i.redraw,n))}Game.Object=Ke.injectCodes(Game.Object,e),Game.Object=Ke.injectCode(Game.Object,"//building canvas","this.scrollOffX = 0;\n\t\tthis.lastRandX = 0;\n\t\tthis.lastRandY = 0;\n\t\tthis.lastOffX = 0;\n\t\tthis.lastMouseOn = this.mouseOn;\n\t\tthis.lastAmount = this.amount;\n\t\tthis.lastSynergyAmount = 0;\n\t\tthis.hasUnloadedImages = true;\n\t\tthis.forceDraw = true;\n","before"),Game.Object=Ke.injectCodes(Game.Object,t),Game.Object=Ke.injectCodes(Game.Object,n),Game.Objects.Grandma.art.pic=Ke.injectCode(Game.Objects.Grandma.art.pic,"return","for(let i = list.length; i > 0; i--) {\n\t\t\tlet gran = list[i];\n\t\t\tif(gran in OmniCookies.vars.bannedGrandmas) {\n\t\t\t\tlist.splice(i, 1);\n\t\t\t}\n\t\t}\n","before"),Re.bannedGrandmas={farmerGrandma:!0,workerGrandma:!0,minerGrandma:!0,cosmicGrandma:!0,transmutedGrandma:!0,alteredGrandma:!0,grandmasGrandma:!0,antiGrandma:!0,rainbowGrandma:!0,bankGrandma:!0,templeGrandma:!0,witchGrandma:!0,luckyGrandma:!0,metaGrandma:!0,alternateGrandma:!0}}),ii=new Ze(function(){var e=[["if (synergiesStr!='') synergiesStr+=', ';","if (OmniCookies.settings.betterBuildingTooltips || synergiesStr != '')\n\t\t\t\tsynergiesStr += OmniCookies.settings.betterBuildingTooltips \n\t\t\t\t\t? '<br>&nbsp;&nbsp;&nbsp;&nbsp;- '\n\t\t\t\t\t: ', ';","replace"],["synergiesStr+=i+' +'+Beautify(synergiesWith[i]*100,1)+'%';","synergiesStr+=i+' '+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '<b>' : '')+\n\t\t\t'+'+Beautify(synergiesWith[i]*100,1)+'%'+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '</b>' : '');","replace"],["synergiesStr='...also boosting some other buildings : '+synergiesStr+' - all","synergiesStr='...also boosting some other buildings'+\n\t\t\t(OmniCookies.settings.betterBuildingTooltips \n\t\t\t\t? ': '+synergiesStr+'<br>&bull; ' \n\t\t\t\t: ' : '+synergiesStr+' - ')+'all","replace"],["<div class=\"data\"","$& '+(OmniCookies.settings.betterBuildingTooltips ? 'style=\"white-space:nowrap;\"' : '')+'","replace"]];for(var t in Game.Objects){var i=Game.Objects[t];i.tooltip=Ke.injectCodes(i.tooltip,e)}Game.Object=Ke.injectCodes(Game.Object,e)}),ti=new Ze(function(){Re.buffsById=[];var e=function(e){var i=Game.buffs[e];Re.buffsById[i.id]=i;var t=Game.buffsL.getElementsByClassName("crate enabled buff")[i.id];t.removeAttribute("onmouseover"),t.onmouseover=function(){Game.mouseDown||(Game.setOnCrate(this),Game.tooltip.dynamic=1,Game.tooltip.draw(this,function(){return Re.GetBuffTooltipFunc(i.id)()},"left"),Game.tooltip.wobble())}};for(var t in Game.buffs)e(t);Game.gainBuff=Ke.injectCodes(Game.gainBuff,[["Game.buffsL.innerHTML=","OmniCookies.vars.buffsById[buff.id] = buff;\n","before"],["//new duration is set to new","var tempBuff=type.func(buff.time/Game.fps,arg1,arg2,arg3);\n\t\t\tbuff.desc = tempBuff.desc;","after"],[/Game\.getTooltip\([\s\S]+\):''\)\+' /,"Game.getDynamicTooltip('(OmniCookies.vars.GetBuffTooltipFunc('+buff.id+'))', 'left', true):'')+' ","replace"]]);var i=document.createElement("div");i.className="prompt";var n=document.createElement("h3");i.id="OmniCookies_width_test",i.appendChild(n),i.style.visibility="hidden",document.getElementById("game").appendChild(i),Re.GetBuffTooltipFunc=function(e){return function(){var i=Re.buffsById[e];n.textContent=i.name;var t=Be(200,n.clientWidth+78),a=i.desc.replace(Game.sayTime(i.maxTime,-1),"$&");"Devastation"==i.name&&(i.desc=i.desc.replace(/(\+)\d+(%)/,"$1"+Fe(100*(i.multClick-1))+"$2"));var s="<div class=\"prompt\" style=\"white-space:nowrap;min-width:"+t+"px;text-align:center;font-size:11px;margin:8px 0px;\"><h3>"+i.name+"</h3><div class=\"line\"></div>"+a;return qe.buffTooltipDuration&&(s+="<div class=\"line\"></div>"+Game.sayTime(i.time,-1)+" left"),s+="</div>",s}};var a=setInterval(function(){var e=Game.Objects["Wizard tower"].minigame;e&&(e.spells["stretch time"].win=Ke.injectCode(e.spells["stretch time"].win,"me.maxTime+=gain;","let timePattern = RegExp(Game.sayTime(me.maxTime,-1), 'g');\n\t\t\t\tme.desc = me.desc.replace(timePattern, Game.sayTime(me.maxTime + gain,-1));\n","before"),clearInterval(a))},250)}),ni=new Ze(function(){for(var e=0,t=Game.GrandmaSynergies;e<t.length;e++){var n=t[e],i=Game.Upgrades[n];i.desc=i.desc.replace(/(efficient\.) /,"$1<br>"),i.baseDesc=i.desc}Game.Upgrades["Cosmic grandmas"].order+=.2,Game.Upgrades["Transmuted grandmas"].order+=.2,Game.Upgrades["Altered grandmas"].order+=.2,Game.Upgrades["Grandmas' grandmas"].order+=.2,Game.GrandmaSynergies.sort(function(e,i){return Game.Upgrades[e].order-Game.Upgrades[i].order});var a=Game.Upgrades["Script grannies"];a.buyFunction=a.buyFunction?Ke.injectCode(a.buyFunction,null,"Game.Objects['Grandma'].redraw();","before"):function(){Game.Objects.Grandma.redraw()},Game.Objects.Portal.tooltip=Ke.injectCode(Game.Objects.Portal.tooltip,"synergiesWith[other.plural]+=boost/(other.storedTotalCps*Game.globalCpsMult);","synergiesWith[other.plural]+=(me.amount*0.05)/other.baseCps;","replace"),Game.Objects.Grandma.tooltip=Ke.injectCode(Game.Objects.Grandma.tooltip,"for (var i in Game.GrandmaSynergies)","let selfBoost = 0;\n\t\tif(Game.Has('One mind')) selfBoost += (me.amount * 0.02)/me.baseCps;\n\t\tif(Game.Has('Communal brainsweep')) selfBoost += (me.amount * 0.02)/me.baseCps;\n\t\tif(selfBoost > 0) {\n\t\t\tif(!synergiesWith[me.plural]) synergiesWith[me.plural] = 0;\n\t\t\tsynergiesWith[me.plural] += selfBoost;\n\t\t}\n\t\tsynergyBoost += selfBoost;\n","before")}),ai=new Ze(function(){Game.UpdateMenu=Ke.injectCodes(Game.UpdateMenu,[["var cookieUpgrades='';","\nvar techUpgrades = '';\n\t\t\tvar seasonalUpgrades = '';","after"],["else if (me.pool=='cookie'","else if (OmniCookies.settings.separateTechs && me.pool == 'tech') techUpgrades+=str2;\n\t\t\telse if(OmniCookies.settings.separateSeasons && me.unlockAt && (me.unlockAt.season || me.unlockAt.displaySeason)) seasonalUpgrades+=str2;\n","before"],["cookieUpgrades+'</div>'):'')+","(techUpgrades!=''?('<div class=\"listing\"><b>Technologies</b></div>'+\n\t\t\t'<div class=\"listing crateBox\">'+techUpgrades+'</div>'):'')+\n\t\t\t(seasonalUpgrades!=''?('<div class=\"listing\"><b>Seasonal</b></div>'+\n\t\t\t'<div class=\"listing crateBox\">'+seasonalUpgrades+'</div>'):'')+","after"]])}),si=new Ze(function(){function e(e,i){"string"==typeof e&&(e=Game.Upgrades[e]),e.unlockAt||(e.unlockAt={cookies:0,name:e.name}),e.unlockAt.displaySeason=i}var i=Game.santaDrops.slice(0,Game.santaDrops.length);i.push("A festive hat"),i.push("Santa's dominion"),Game.crateTooltip=Ke.injectCodes(Game.crateTooltip,[[/(\/\*|\*\/)/g,"","replace"],["else if (me.unlockAt.season"," && me.unlockAt.season","after"],["else if (me.unlockAt.text)","else if (OmniCookies.settings.displaySeasons && me.unlockAt.displaySeason)\n\t\t\t{\n\t\t\t\tvar it=Game.seasons[me.unlockAt.displaySeason];\n\t\t\t\tdesc='<div style=\"font-size:80%;text-align:center;\">From <div class=\"icon\" style=\"vertical-align:middle;display:inline-block;'+(Game.Upgrades[it.trigger].icon[2]?'background-image:url('+Game.Upgrades[it.trigger].icon[2]+');':'')+'background-position:'+(-Game.Upgrades[it.trigger].icon[0]*48)+'px '+(-Game.Upgrades[it.trigger].icon[1]*48)+'px;transform:scale(0.5);margin:-16px;\"></div> '+it.name+'</div><div class=\"line\"></div>'+desc;\n\t\t\t}\n","before"]],{mysterious:0});for(var t,n=0,a=Game.reindeerDrops;n<a.length;n++)t=a[n],e(t,"christmas");for(var s,o=0,r=i;o<r.length;o++)s=r[o],e(s,"christmas");for(var d,c=0,p=Game.halloweenDrops;c<p.length;c++)d=p[c],e(d,"halloween");for(var u,m=0,g=Game.easterEggs;m<g.length;m++)u=g[m],e(u,"easter")}),oi=new Ze(function(){Game.UpdateWrinklers=Ke.injectCode(Game.UpdateWrinklers,/(var godLvl=)(Game\.hasGod\('scorn'\))(;\s*if \(godLvl==1\) me\.sucked\*=1\.15;)/m,"$1OmniCookies.settings.skruuiaRebalance ? 0 : $2$3","replace",{inRect:p})}),ri=new Ze(function(){Re.cursedPs=Game.cookiesPs,Re.cursedPsMult=Game.globalCpsMult;var e=Game.buffTypesByName["cursed finger"];e.func=Ke.injectCodes(e.func,[["multCpS:0,","multCpS:1,","replace"],["<br>but each click is worth ","<br>but each click generates ","replace"]]),li.apply();var i=Game.hasBuff("Cursed finger");i&&(i.multCpS=1,i.desc=i.desc.replace("is worth","generates"),Game.recalculateGains=1)},function(){var e=Game.buffTypesByName["cursed finger"];e.func=Ke.injectCodes(e.func,[["multCpS:1,","multCpS:0,","replace"],["<br>but each click generates ","<br>but each click is worth ","replace"]]);var i=Game.hasBuff("Cursed finger");i&&(i.multCpS=0,i.desc=i.desc.replace("generates","is worth"),i.power=Re.cursedPs*i.maxTime/Game.fps,Game.recalculateGains=1)}),li=new Ze(function(){Game.CalculateGains=Ke.injectCode(Game.CalculateGains,"Game.computedMouseCps=Game.mouseCps();","\nif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\n\t\t\tOmniCookies.vars.cursedPs = Game.cookiesPs;\n\t\t\tOmniCookies.vars.cursedPsMult = Game.globalCpsMult;\n\t\t\tGame.globalCpsMult = 0;\n\t\t\tGame.cookiesPs = 0;\n\t\t\tGame.computedMouseCps = 0;\n\t\t}","after");var e=document.getElementById("bigCookie");e.removeEventListener("click",Game.ClickCookie),Game.ClickCookie=Ke.injectCode(Game.ClickCookie,"Game.handmadeCookies+=amount;","\nif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\n\t\t\tGame.Dissolve(amount);\n\t\t\tGame.handmadeCookies-=amount;\n\t\t\tamount = OmniCookies.vars.cursedPs * Game.buffs['Cursed finger'].maxTime/Game.fps;\n\t\t\tGame.cookiesPs = OmniCookies.vars.cursedPs;\n\t\t\tGame.globalCpsMult = OmniCookies.vars.cursedPsMult;\n\t\t\tOmniCookies.Util.gainInstantPassiveCpS(Game.buffs['Cursed finger'].maxTime/Game.fps);\n\t\t\tGame.cookiesPs = 0;\n\t\t\tGame.globalCpsMult = 0;\n\t\t}","after"),AddEvent(e,"click",Game.ClickCookie)}),di=new Ze(function(){Game.tooltip.wobble=Ke.injectCode(Game.tooltip.wobble,"if (false)","if (OmniCookies.settings.tooltipWobble)","replace")}),ci=new Ze(function(){Game.CalculateGains=Ke.injectCode(Game.CalculateGains,/\(Date\.now\(\)\/1000\/\(60\*60\*(\d+)\)\)\*Math\.PI\*2/g,"OmniCookies.Util.cycliusCalc($1, OmniCookies.settings.zonedCyclius)","replace")}),pi=new Ze(function(){d("Bank",function(){var e=Game.Objects.Bank.minigame;e.buyGood=Ke.injectCode(e.buyGood,"return true;","let realCostInS = costInS * overhead;\n\t\t\tif(!OmniCookies.saveData.stockAverages[id] || me.stock == n) {\n\t\t\t\tOmniCookies.saveData.stockAverages[id] = {\n\t\t\t\t\tavgValue: realCostInS,\n\t\t\t\t\ttotalValue: realCostInS*n\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\n\t\t\t\tavg.totalValue += realCostInS*n;\n\t\t\t\tavg.avgValue = avg.totalValue/me.stock;\n\t\t\t}\n","before",{M:e}),e.sellGood=Ke.injectCode(e.sellGood,"return true;","if(OmniCookies.saveData.stockAverages[id]) {\n\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\n\t\t\t\tavg.totalValue -= avg.avgValue*n;\n\t\t\t}\n","before",{M:e}),e.drawGraph=Ke.injectCode(e.drawGraph,null,"if(OmniCookies.settings.stockValueData && M.hoverOnGood != -1) {\n\t\t\t\tlet me = M.goodsById[M.hoverOnGood];\n\t\t\t\tif(me.stock > 0 && OmniCookies.saveData.stockAverages[M.hoverOnGood]) {\n\t\t\t\t\tctx.strokeStyle='#00ff00'; // green\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tlet lineHeight = Math.floor(height-OmniCookies.saveData.stockAverages[M.hoverOnGood].avgValue*M.graphScale)+0.5;\n\t\t\t\t\tctx.moveTo(width-1, lineHeight);\n\t\t\t\t\tctx.lineTo(width-span*rows-1, lineHeight);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}","after",{M:e}),e.draw=Ke.injectCode(e.draw,"//if (me.stock>0) me.stockL.style.color='#fff';","if(OmniCookies.settings.stockValueData) {\n\t\t\t\tif(!me.avgL) {\n\t\t\t\t\tlet avgSpan = document.createElement('span');\n\t\t\t\t\tavgSpan.id = 'bankGood-'+me.id+'-avg';\n\t\t\t\t\tavgSpan.innerHTML = '$$--.--';\n\t\t\t\t\tdocument.getElementById('bankGood-'+me.id+'-stockBox').appendChild(avgSpan);\n\t\t\t\t\tme.avgL = avgSpan;\n\t\t\t\t}\n\n\t\t\t\tif(OmniCookies.settings.alternateStockMarket && (!me.avgL.parentElement || me.avgL.parentElement.id.includes('-stockBox'))) {\n\t\t\t\t\tlet newCell = l('bankGood-'+me.id+'-boughtValueBox');\n\t\t\t\t\tif(newCell) {\n\t\t\t\t\t\tme.avgL.style.marginLeft = '4px';\n\t\t\t\t\t\tnewCell.appendChild(me.avgL);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(OmniCookies.saveData.stockAverages[me.id] && me.stock > 0) {\n\t\t\t\t\tme.avgL.style.visibility = 'visible';\n\t\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[me.id];\n\t\t\t\t\tme.avgL.innerHTML = '$$'+Beautify(avg.avgValue,2);\n\t\t\t\t\tif(!OmniCookies.settings.alternateStockMarket) {\n\t\t\t\t\t\tme.avgL.innerHTML = ' ('+me.avgL.innerHTML+')';\n\t\t\t\t\t}\n\t\t\t\t\tif(avg.avgValue < me.val) {\n\t\t\t\t\t\tme.avgL.classList.remove('red');\n\t\t\t\t\t\tme.avgL.classList.add('green');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.avgL.classList.remove('green');\n\t\t\t\t\t\tme.avgL.classList.add('red');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!OmniCookies.settings.alternateStockMarket) {\n\t\t\t\t\t\tme.avgL.style.visibility = 'hidden';\n\t\t\t\t\t\tme.avgL.innerHTML = '';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.avgL.style.visibility = 'visible';\n\t\t\t\t\t\tme.avgL.innerHTML = '$$--.--';\n\t\t\t\t\t}\n\t\t\t\t\tme.avgL.classList.remove('red');\n\t\t\t\t\tme.avgL.classList.remove('green');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(me.avgL) {\n\t\t\t\t\tme.avgL.remove();\n\t\t\t\t\tme.avgL = undefined;\n\t\t\t\t}\n\t\t\t}\n","before",{M:e}),e.toRedraw=2})}),ui=new Ze(function(){Game.Draw=Ke.injectCode(Game.Draw,"if (Game.prefs.animate && ((Game.prefs.fancy && Game.drawT%1==0)","if (Game.prefs.animate && ((((Game.prefs.fancy || OmniCookies.settings.buildingsBypassFancy == 0) && OmniCookies.settings.buildingsBypassFancy != 1) && Game.drawT%1==0)","replace")}),mi=new Ze(function(){Game.DrawBackground=Ke.injectCode(Game.DrawBackground,/(var fancy=)(Game\.prefs\.fancy)(;)/,"$1($2 || OmniCookies.settings.cursorsBypassFancy == 0) && OmniCookies.settings.cursorsBypassFancy != 1$3","replace")}),gi=new Ze(function(){Game.UpdateWrinklers=Ke.injectCode(Game.UpdateWrinklers,/Game\.prefs\.fancy/g,"($& || OmniCookies.settings.wrinklersBypassFancy == 0) && OmniCookies.settings.wrinklersBypassFancy != 1","replace",{inRect:p})}),fi=new Ze(function(){var e=[["l('productPriceMult'+me.id).textContent=(Game.buyBulk>1)?('x'+Game.buyBulk+' '):'';","if(OmniCookies.settings.enhancedBulk) {\n\t\t\t\tlet bulkAmount = -1;\n\t\t\t\tlet bulkPrice = -1;\n\t\t\t\tif(Game.buyMode == -1) {\n\t\t\t\t\tbulkAmount = (Game.buyBulk > -1) ? Math.min(Game.buyBulk, me.amount) : me.amount;\n\t\t\t\t} else {\n\t\t\t\t\tlet scaling = Game.priceIncrease;\n\t\t\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\t\t\tscaling = 1+Game.modifyBuildingPrice(me, scaling-1);\n\t\t\t\t\t}\n\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(me, Game.buyBulk, scaling);\n\t\t\t\t\tbulkAmount = bulk.maxAmount;\n\t\t\t\t\tbulkPrice = bulk.maxPrice;\n\t\t\t\t}\n\t\t\t\tl('productPriceMult'+me.id).textContent = bulkAmount > 1 ? 'x' + bulkAmount + ' ' : '';\n\t\t\t} else {\n\t\t\t\t$&\n\t\t\t}","replace"]],t=[["if (Game.buyMode==1) this.bulkPrice=this.getSumPrice(Game.buyBulk);","if (Game.buyMode==1) {\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\n\t\t\t\t\tlet scaling = Game.priceIncrease;\n\t\t\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\t\t\tscaling = 1+Game.modifyBuildingPrice(this, scaling-1);\n\t\t\t\t\t}\n\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(this,Game.buyBulk,scaling);\n\t\t\t\t\tthis.bulkPrice = bulk.maxPrice > 0 ? bulk.maxPrice : this.price;\n\t\t\t\t} else {\n\t\t\t\t\tthis.bulkPrice=this.getSumPrice(Game.buyBulk);\n\t\t\t\t}\n\t\t\t}","replace"],["else if (Game.buyMode==-1 && Game.buyBulk==-1) this.bulkPrice=this.getReverseSumPrice(","OmniCookies.settings.enhancedBulk ? this.amount : ","after"]],n=[["if (amount==-1) amount=1000;","if (amount==-1) amount=Infinity;","replace"],[/success=1;\s*}/,"$& else break;","replace"]];for(var a in Game.Objects){var i=Game.Objects[a];i.rebuild=Ke.injectCodes(i.rebuild,e),i.refresh=Ke.injectCodes(i.refresh,t),i.buy=Ke.injectCodes(i.buy,n)}Game.Object=Ke.injectCodes(Game.Object,e),Game.Object=Ke.injectCodes(Game.Object,t),Game.Object=Ke.injectCodes(Game.Object,n),Game.storeBulkButton=Ke.injectCodes(Game.storeBulkButton,[["if (Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;","if(id == 0 || id == 1) {\n\t\t\t\tlet text = 'all';\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\n\t\t\t\t\tif(Game.buyMode == -1) text = 'ALL';\n\t\t\t\t\telse text = 'MAX';\n\t\t\t\t}\n\t\t\t\tl('storeBulkMax').textContent = text;\n\t\t\t}\n\t\t\tif (!OmniCookies.settings.enhancedBulk && Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;","replace"],["l('storeBulkMax').style.visibility='hidden';","if(!OmniCookies.settings.enhancedBulk) ","before"]]),Game.Logic=Ke.injectCodes(Game.Logic,[["if (!Game.promptOn)","let activeShortcut = (OmniCookies.Util.holdingButton(16)*2) | (OmniCookies.Util.holdingButton(17));\n","before"],["if ((Game.keys[16] || Game.keys[17]) && !Game.buyBulkShortcut)","if (activeShortcut != OmniCookies.vars.prevShortcut && (OmniCookies.settings.enhancedBulk ? true : activeShortcut == 2 || activeShortcut == 1))","replace"],["Game.buyBulkOld=Game.buyBulk;","if(OmniCookies.vars.prevShortcut == 0) ","before"],["if (Game.keys[17]) Game.buyBulk=10;","if(activeShortcut == 3 && OmniCookies.settings.enhancedBulk) Game.buyBulk = -1;","after"],["//handle cookies","OmniCookies.vars.prevShortcut = activeShortcut;\n","before"]]),ki()}),ki=function(){1==Game.buyMode&&(-1==Game.buyBulk&&!qe.enhancedBulk&&Game.storeBulkButton(4),l("storeBulkMax").style.visibility=qe.enhancedBulk?"visible":"hidden");var e="all";qe.enhancedBulk&&(-1==Game.buyMode?e="ALL":e="MAX"),l("storeBulkMax").textContent=e,Game.RefreshStore()},hi=new Ze(function(){d("Bank",function(){var e=Game.Objects.Bank.minigame;e.buyGood=Ke.injectCode(e.buyGood,"Game.Spend(cost*n);","if(OmniCookies.settings.dangerousStocks) {\n\t\t\t\tGame.Dissolve(cost*n);\n\t\t\t} else {\n\t\t\t\t$&\n\t\t\t}","replace",{M:e}),e.sellGood=Ke.injectCodes(e.sellGood,[["//Game.Earn","if(OmniCookies.settings.dangerousStocks) Game.Earn","replace"],[/\tGame\.cookies/gm,"if(!OmniCookies.settings.dangerousStocks) $&","replace"]],{M:e})})}),yi=new Ze(function(){d("Temple",function(){var e=Game.Objects.Temple.minigame,i=[/\+me\.desc(\w+)\+/g,"+((typeof me.desc$1 == 'function') ? me.desc$1() : me.desc$1)+","replace"];e.godTooltip=Ke.injectCode.apply(Ke,g([e.godTooltip],i,[{M:e}])),e.slotTooltip=Ke.injectCode.apply(Ke,g([e.slotTooltip],i,[{M:e}]));var t=function(e){return function(){var i="";if(qe.detailedCyclius){var t=100*(.15*Oe(n(e,qe.zonedCyclius))),a=0<t?"green":"red",s=0<t?"+":"",o=Beautify(t,2);"0"==o&&(a=""),-.1>t&&"0"==o&&(a="red"),0>t&&!o.includes("-")&&(o="-"+o),i="<div style=\"display:inline-block;text-align:right;width:50%;\" class=\""+a+"\">"+s+o+"% base CpS.</div>"}return"<div style=\"display:inline-block;width:49%;\">Effect cycles over "+e+" hours.</div>"+i}},a=e.gods.ages;bi(),a.desc1=t(3),a.desc2=t(12),a.desc3=t(24)})}),bi=function(){var e=Game.Objects.Temple.minigame,i=e.gods.ages;i.activeDescFunc?(i.activeDescBackup=i.activeDescFunc,i.activeDescFunc=void 0):(i.activeDescFunc=i.activeDescBackup,i.activeDescBackup=void 0)},vi=new Ze(function(){Game.Draw=Ke.injectCode(Game.Draw,"if (price<lastPrice) Game.storeToRefresh=1;","if (price<lastPrice && price!=0) Game.upgradesToRebuild=1;","replace");for(var e,i=0,t=Game.ObjectsById;i<t.length;i++)e=t[i],e.getSumPrice=Ke.injectCodes(e.getSumPrice,[[/(for \(var i=)(Math\.max\(0,this\.amount\))(;)/,"$1Infinity$3","replace"],["=Game.modifyBuildingPrice(this,price);","=OmniCookies.Util.quickCalcBulkPrice(this, amount);","replace"]]),e.getReverseSumPrice=Ke.injectCodes(e.getReverseSumPrice,[[/(for \(var i=)(Math\.max\(0,\(this\.amount\)-amount\))(;)/,"$1Infinity$3","replace"],["=Game.modifyBuildingPrice(this,price);","=OmniCookies.Util.quickCalcBulkPrice(this, amount, undefined, true);","replace"],["price*=this.getSellMult","//","before"]])}),Ci=new Ze(function(){d("Bank",function(){var i=Game.Objects.Bank.minigame,t=l("bankBrokersBuy"),n=t.parentElement,a=document.createElement("div");a.classList.add("bankButton","bankButtonBuy","bankButtonOff"),a.id="bankBrokersBuy",a.innerHTML="Hire",a.onclick=function(t){i.brokers<i.getMaxBrokers()&&Game.cookies>=i.getBrokerPrice()&&(qe.dangerousBrokers&&qe.dangerousStocks?Game.Dissolve(i.getBrokerPrice()):Game.Spend(i.getBrokerPrice()),i.brokers+=1,qe.dangerousBrokers&&(i.profit-=1200),PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(t.target))},t.remove(),n.appendChild(a)})}),xi=new Ze(function(){Game.crateTooltip=Ke.injectCode(Game.crateTooltip,"if (me.tier!=0 && Game.Has('Label printer')) tags.push('Tier : '","if(OmniCookies.settings.heavenlyCookies && me.pseudoCookie) {\n\t\t\tif(!OmniCookies.vars.bannedPseudoCookies[me.name]) {\n\t\t\t\ttags.push('Cookie', 0);\n\t\t\t}\n\t\t}\n","before",{mysterious:0}),Game.particleAdd=Ke.injectCode(Game.particleAdd,/(if \(cookie\.bought>0 && )(cookie\.pool=='cookie')(\) cookies\.push\(cookie\.icon\);)/,"$1($2 || (OmniCookies.settings.heavenlyCookies && cookie.pseudoCookie && Game.Has(cookie.name) && !OmniCookies.vars.bannedPseudoCookies[cookie.name]))$3","replace")}),Oi=new Ze(function(){for(var e,i=[[null,"let oldPriceIncrease = Game.priceIncrease;\n\t\t\tif(OmniCookies.settings.buildingPriceBuff) {\n\t\t\t\tGame.priceIncrease = 1+Game.modifyBuildingPrice(this, oldPriceIncrease-1);\n\t\t\t\tOmniCookies.vars.skipModifyPrice = true;\n\t\t\t}","before"],["return Mat","if(OmniCookies.settings.buildingPriceBuff) Game.priceIncrease = oldPriceIncrease;\n","before"]],t=0,n=Game.ObjectsById;t<n.length;t++)e=n[t],e.getPrice=Ke.injectCodes(e.getPrice,i),e.getSumPrice=Ke.injectCodes(e.getSumPrice,i),e.getReverseSumPrice=Ke.injectCodes(e.getReverseSumPrice,i);Game.modifyBuildingPrice=Ke.injectCode(Game.modifyBuildingPrice,null,"if(OmniCookies.vars.skipModifyPrice) {\n\t\t\tOmniCookies.vars.skipModifyPrice = false;\n\t\t\treturn price;\n\t\t}","before")}),wi=new Ze(function(){d("Bank",function(){for(var e=Game.Objects.Bank.minigame,t=l("bankContent"),n=l("bankHeader"),a=l("bankGraphBox"),s=0;4>s;s++)t.insertBefore(n.children[0],n);n.insertBefore(a,n.children[0]);var o=document.createElement("div");for(var r in o.style.display="table",e.goodsById){var d=document.createElement("div");d.style.display="inline-block",d.style.paddingRight="4px",d.style.paddingLeft="4px";var c=document.getElementById("bankGood-"+r+"-sym"),p=document.getElementById("bankGood-"+r+"-val"),u=document.getElementById("bankGood-"+r+"-stock"),m=document.getElementById("bankGood-"+r+"-stockMax"),f=document.getElementById("bankGood-"+r+"-avg"),k=document.getElementById("bankGood-"+r+"-viewHide"),h=document.getElementById("bankGood-"+r+"_Max"),y=document.getElementById("bankGood-"+r+"_-All"),b=e.goodsById[r],v=b.l.getElementsByClassName("icon")[0];d.appendChild(b.l),d.appendChild(v),o.appendChild(d);var C=document.createElement("table");C.style.display="inline-block",C.style.overflow="hidden";var x=document.createElement("tr"),O=document.createElement("td");x.appendChild(O),O.setAttribute("rowspan","2"),O.style.verticalAlign="center";var w=document.createElement("td");x.appendChild(w);var S=document.createElement("td");x.appendChild(S);var G=document.createElement("td");x.appendChild(G),C.appendChild(x);var B=document.createElement("tr"),L=document.createElement("td");B.appendChild(L);var M=document.createElement("td");B.appendChild(M);var T=document.createElement("td");B.appendChild(T),C.appendChild(B);var j=document.createElement("table");j.style.display="inline-block";var P=document.createElement("tr"),A=document.createElement("tr"),F=document.createElement("td");P.appendChild(F);var I=document.createElement("td");P.appendChild(I);var E=document.createElement("td");A.appendChild(E),j.appendChild(P),j.appendChild(A),v.style.zIndex="",v.style.transform="",v.style.position="",v.style.margin="-6px -14px",v.style.float="left",b.l.style.width="fit-content",b.l.style.background="linear-gradient(to right,#333,#222,#111,#000)",b.l.style.width="auto";var D=b.l.children[b.l.children.length-1];D.remove(),k.style.position="relative",k.style.display="inline-block",k.style.paddingTop="0px",k.style.paddingBottom="0px",k.style.width="25px",I.appendChild(k),h.style.verticalAlign="bottom",y.style.verticalAlign="bottom",h.style.margin="0px 0px",y.style.margin="0px 0px",h.style.background="#000",y.style.background="#000",F.appendChild(h),E.appendChild(y);var U=b.l.children[0];U.style.height="32px",U.appendChild(C),U.appendChild(j),C.setAttribute("onmouseout",U.getAttribute("onmouseout")),C.setAttribute("onmouseover",U.getAttribute("onmouseover")),U.removeAttribute("onmouseout"),U.removeAttribute("onmouseover");var N=c.parentElement;N.style.width="40px",N.style.padding="1px 0px",N.removeChild(c);var R=document.createElement("div");R.innerHTML=N.innerHTML.trim(),N.innerHTML="",N.style.background="unset",R.style.fontSize="13px",N.appendChild(R),O.appendChild(N),O.style.verticalAlign="middle",O.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset";var _=document.createElement("div"),H=document.createElement("div");H.style.paddingRight="2px",_.className="bankSymbol",_.style.margin="0px 1px",_.style.padding="2px 0px",_.style.textAlign="right",_.style.width="60px",_.style.overflow="hidden",_.style.background="unset",w.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",H.appendChild(c),_.appendChild(H),w.appendChild(_);var W=p.parentElement;p.style.marginLeft="4px",W.style.margin="0px 0px",W.style.background="unset",W.style.width="50px",W.style.textAlign="left",W.style.display="inline-block",S.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",W.innerHTML="",W.appendChild(p),S.appendChild(W);var q=m.parentElement;q.style.margin="0px 0px",q.style.background="",q.style.width="50px",q.style.display="inline-block",q.style.background="unset",G.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",q.innerHTML="",q.appendChild(m),m.innerHTML=m.innerHTML.replace("/",""),G.appendChild(q);var z=document.createElement("div");z.className="bankSymbol",z.id="bankGood-"+b.id+"-ownedStockBox",z.style.margin="0px 0px",z.style.padding="2px 0px",z.style.width="50px",z.style.overflow="hidden",z.style.background="unset",T.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",z.appendChild(u),T.appendChild(z);var $=document.createElement("div");$.className="bankSymbol",$.id="bankGood-"+b.id+"-boughtValueBox",$.style.margin="0px 0px",$.style.padding="2px 0px",$.style.width="50px",$.style.overflow="hidden",$.style.background="unset",$.style.textAlign="left",M.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",M.appendChild($);var X=document.createElement("div"),V=document.createElement("div");V.style.paddingRight="2px",V.id="bankGood-"+b.id+"-profitSym",V.style.visibility="hidden",V.innerHTML="--.--%",V.style.fontWeight="normal",X.className="bankSymbol",X.style.margin="0px 1px",X.style.padding="2px 0px",X.style.textAlign="right",X.style.width="60px",X.style.overflow="hidden",X.style.background="unset",L.style.boxShadow="0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset",X.appendChild(V),L.appendChild(X)}n.appendChild(o),e.draw=Ke.injectCode(e.draw,".vals[0]*M.graphScale))+'px) scale(0.5)';","\nif(!me.ownedStockBoxL) me.ownedStockBoxL = l('bankGood-'+me.id+'-ownedStockBox');\n\t\t\t\n\t\t\tif(me.stockBoxL.classList.contains('green') && !me.ownedStockBoxL.classList.contains('green')) me.ownedStockBoxL.classList.add('green');\n\t\t\telse if(!me.stockBoxL.classList.contains('green') && me.ownedStockBoxL.classList.contains('green')) me.ownedStockBoxL.classList.remove('green');\n\t\t\tif(me.stockBoxL.classList.contains('green')) me.stockBoxL.classList.remove('green');\n\t\t\t\n\t\t\tme.stockMaxL.innerHTML = me.stockMaxL.innerHTML.replace('/', '');\n\t\t\t\n\t\t\tif(!me.profitSpanL) me.profitSpanL = l('bankGood-'+me.id+'-profitSym');\n\t\t\tif(OmniCookies.settings.stockValueData) {\n\t\t\t\tme.profitSpanL.style.visibility = 'visible';\n\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[me.id];\n\t\t\t\tif(avg && avg.totalValue > 0) {\n\t\t\t\t\tlet percent = (me.val/avg.avgValue - 1) * 100;\n\t\t\t\t\tme.profitSpanL.innerHTML = Beautify(percent, 2) + '%';\n\t\t\t\t\tme.profitSpanL.style.paddingRight = '2px';\n\t\t\t\t\tif (percent>=0) {me.profitSpanL.classList.add('bankSymbolUp');me.profitSpanL.classList.remove('bankSymbolDown');}\n\t\t\t\t\telse if (percent<0) {me.profitSpanL.classList.remove('bankSymbolUp');me.profitSpanL.classList.add('bankSymbolDown');}\n\t\t\t\t\telse {\n\t\t\t\t\t\tme.profitSpanL.classList.remove('bankSymbolUp');\n\t\t\t\t\t\tme.profitSpanL.classList.remove('bankSymbolDown');\n\t\t\t\t\t\tme.profitSpanL.style.paddingRight = '12px';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.profitSpanL.classList.remove('bankSymbolUp');\n\t\t\t\t\tme.profitSpanL.classList.remove('bankSymbolDown');\n\t\t\t\t\tme.profitSpanL.innerHTML = '--.--%';\n\t\t\t\t\tme.profitSpanL.style.paddingRight = '12px';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tme.profitSpanL.style.visibility = 'hidden';\n\t\t\t}","after",{M:e}),Game.Logic=Ke.injectCode(Game.Logic,"OmniCookies.vars.prevShortcut = activeShortcut;","if(activeShortcut != OmniCookies.vars.prevShortcut) {\n\t\t\t\tfor(let goodId in Game.Objects['Bank'].minigame.goodsById) {\n\t\t\t\t\tlet buyButton = document.getElementById('bankGood-'+goodId+'_Max');\n\t\t\t\t\tlet sellButton = document.getElementById('bankGood-'+goodId+'_-All');\n\t\t\t\t\tlet amount = 1;\n\t\t\t\t\tswitch(activeShortcut) {\n\t\t\t\t\t\tcase 0: amount = 1; break;\n\t\t\t\t\t\tcase 1: amount = 10; break;\n\t\t\t\t\t\tcase 2: amount = 100; break;\n\t\t\t\t\t\tcase 3: amount = -1; break;\n\t\t\t\t\t}\n\t\t\t\t\tif(amount == -1) {\n\t\t\t\t\t\tbuyButton.innerHTML = 'Max';\n\t\t\t\t\t\tsellButton.innerHTML = 'All';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuyButton.innerHTML = amount.toString();\n\t\t\t\t\t\tsellButton.innerHTML = amount.toString();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n","before");var Y=[null,"\nlet oldN = n;\n\t\t\tswitch(OmniCookies.vars.prevShortcut) {\n\t\t\t\tcase 0: n = 1; break;\n\t\t\t\tcase 1: n = 10; break;\n\t\t\t\tcase 2: n = 100; break;\n\t\t\t\tcase 3: n = 10000; break;\n\t\t\t}\n\t\t\tn *= Math.sign(oldN);","before"];e.buyGood=Ke.injectCode.apply(Ke,g([e.buyGood],Y,[{M:e}])),e.sellGood=Ke.injectCode.apply(Ke,g([e.sellGood],Y,[{M:e}])),e.tradeTooltip=Ke.injectCode.apply(Ke,g([e.tradeTooltip],Y,[{M:e}])),e.toRedraw=2})}),Si=new Ze(function(){Game.Loop=Ke.injectCodes(Game.Loop,[["Timer.say('DRAW');","//","before"],["Timer.say('END DRAW');","//","before"]]),Game.Draw=Ke.injectCodes(Game.Draw,[[null,"\nTimer.say('DRAW');","before"],[null,"Timer.say('END DRAW');\n","after"]])}),Gi=Object.freeze({__proto__:null,Patch:Ze,scrollbarStyle:Je,smoothBuildings:Qe,scrollingBuildings:ei,buildingTooltips:ii,buffTooltips:ti,miscGrandmaFixes:ni,statsUpgradeCategories:ai,displaySeasonUnlock:si,skruuiaRebalance:oi,cursedFingerTweaks:ri,tooltipWobble:di,cycliusGains:ci,stockInfo:pi,fancyBuildings:ui,fancyCursors:mi,fancyWrinklers:gi,buySellBulk:fi,updateBulkAll:ki,dangerousStocks:hi,cycliusInfo:yi,toggleCyclius:bi,optiCookies:vi,dangerousBrokers:Ci,heavenlyCookies:xi,buildingPriceBuff:Oi,alternateStockMarket:wi,drawTimerFix:Si}),Bi=function(){function e(e,i,t){this.settingName=e,this.options=i,this.desc=t,this.id="OmniCookiesButton_"+this.settingName}return e.prototype.display=function(){var e=document.createElement("div"),i=+qe[this.settingName],t=this.options[i];t||(t={text:"ERROR! No option "+i,off:!0});var n=document.createElement("a");n.id=this.id,n.className="option"+(t.off?" off":""),n.onclick=this.toggleFunction(),n.innerHTML=t.text,e.appendChild(n);var a=document.createElement("label");return a.innerHTML=this.desc,e.appendChild(a),e},e.prototype.toggleFunction=function(){var e=this.settingName,i=this.options,t=this.id;return function(){qe[e]++,qe[e]>=i.length&&(qe[e]=0);var n=document.getElementById(t),a=i[qe[e]];a.off?n.classList.add("off"):n.classList.remove("off"),a.func&&a.func(),n.innerHTML=a.text,PlaySound("snd/tick.mp3")}},e}(),Li=function(e){function i(i,t,n,a){var s=e.call(this,i,[n,t],a)||this;return s.onOption=t,s.offOption=n,n.off=!0,s}return m(i,e),i}(Bi),Mi=function(){function e(e,i,t,n,a,s){this.settingName=e,this.title=i,this.min=t,this.max=n,this.step=a,this.format=s}return e.prototype.display=function(){var e=Math.round,i=qe[this.settingName],t=document.createElement("div");t.className="sliderBox";var n=document.createElement("div");n.style.float="left",n.innerHTML=this.title,t.appendChild(n);var a=document.createElement("div");a.id="OmniCookiesSlider_"+this.settingName+"RightText",a.style.float="right",a.innerHTML=this.format(i),t.appendChild(a);var s=document.createElement("input");s.id="OmniCookiesSlider_"+this.settingName+"Slider",s.style.clear="both",s.type="range",s.min=this.min.toString(),s.max=this.max.toString(),s.step=this.step.toString(),s.value=i.toString();var o=this.format,r=this.settingName;return s.onchange=function(i){var t=i.target;qe[r]=e(+t.value),a.innerHTML=o(+t.value)},s.oninput=function(i){var t=i.target;qe[r]=e(+t.value),a.innerHTML=o(+t.value)},s.onmouseup=function(){PlaySound("snd/tick.mp3")},t.appendChild(s),t},e}(),Ti=function(){function e(e){this.text=e}return e.prototype.display=function(){var e=document.createElement("div");return e.className="listing",e.style.padding="5px 16px",e.style.opacity="0.7",e.style.fontSize="17px",e.style.fontFamily="\"Kavoon\", Georgia, serif",e.appendChild(document.createTextNode(this.text)),e},e}(),ji=function(){function e(e){this.text=e}return e.prototype.display=function(){var e=document.createElement("div");return e.className="title",e.innerHTML=this.text,e},e}(),Pi=function(){function e(e){this.elements=e}return e.prototype.display=function(){var e=document.createElement("div");e.className="listing";for(var i,t=0,n=this.elements;t<n.length;t++)i=n[t],e.appendChild(i.display());return e},e}(),Ai=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return m(i,e),i.prototype.display=function(){var i=e.prototype.display.call(this);return i.style.display=Game.sesame?i.style.display:"none",i},i}(Pi),Fi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return m(i,e),i.prototype.display=function(){var i=e.prototype.display.call(this);return i.style.display=Game.sesame?i.style.display:"none",i},i}(Ti),Ii=function(){function e(e){this.elements=e}return e.prototype.display=function(){for(var e,i=document.createDocumentFragment(),t=0,n=this.elements;t<n.length;t++)e=n[t],i.appendChild(e.display());return i},e}(),Ei=new Ii([new ji("Omniscient Cookies "+Ne),new Ti("Graphical tweaks"),new Pi([new Li("autoScrollbar",{text:"Autohide center scrollbar ON",func:function(){return r("auto")}},{text:"Autohide center scrollbar OFF",func:function(){return r("scroll")}},"(the scrollbar in the center view will hide itself when appropriate)"),new Li("scrollingBuildings",{text:"Scroll buildings ON"},{text:"Scroll buildings OFF"},"(hovering over the left/right edges of buildings produces a scroll effect)"),new Li("smoothBuildings",{text:"Smooth buildings ON"},{text:"Smooth buildings OFF"},"(buildings draw every frame, instead of every 3 frames)"),new Li("betterBuildingTooltips",{text:"Improved building tooltips ON",func:function(){return ii.apply()}},{text:"Improved building tooltips OFF"},"(building tooltips in the shop look a little better)"),new Li("betterGrandmas",{text:"Grandma fixes ON",func:function(){return ni.apply()}},{text:"Grandma fixes OFf"},"(text and ordering fixes for grandma synergy upgrades; disabling requires refresh)"),new Li("bringGrandmaToWork",{text:"Bring grandma to work day ON"},{text:"Bring grandma to work day OFF"},"(synergy grandmas make an appearance in their respective building views)"),new Li("separateTechs",{text:"Separate techs ON",func:function(){return ai.apply()}},{text:"Separate techs OFF"},"(gives tech upgrades their own upgrade category under cookies)"),new Li("separateSeasons",{text:"Separate seasons ON",func:function(){return ai.apply()}},{text:"Separate seasons OFF"},"(gives seasonal upgrades their own upgrade category under cookies)"),new Li("displaySeasons",{text:"Display seasonal sources ON",func:function(){return si.apply()}},{text:"Display seasonal sources OFF"},"(shows source season in upgrade tooltips)"),new Li("fancyMilkSelect",{text:"Fancy milk select ON"},{text:"Fancy milk select OFF",func:function(){s(1),Re.lastMilk=-1,Re.lastAutoMilk=-1}},"(milk selector icon changes with selected milk)"),new Li("tooltipWobble",{text:"Tooltip wobble ON"},{text:"Tooltip wobble OFF",func:function(){return Game.tooltip.tt.className="framed"}},"(enables the tooltip wobble animation)"),new Li("improveAscendMeter",{text:"Fancy ascend meter ON"},{text:"Fancy ascend meter OFF",func:function(){return Game.ascendMeter.style.removeProperty("width")}},"(meter and number total update faster and smoother)"),new Li("heavenlyCookies",{text:"Heavenly cookies ON",func:function(){return xi.apply()}},{text:"Heavenly cookies OFF"},"(certain heavenly upgrades act like cookie upgrades)"),new Bi("buildingsBypassFancy",[{text:"Buildings always FANCY"},{text:"Buildings always FAST"},{text:"Buildings always DEFAULT",off:!0}],"(buildings follow this setting rather than default)"),new Bi("cursorsBypassFancy",[{text:"Cursors always FANCY"},{text:"Cursors always FAST"},{text:"Cursors always DEFAULT",off:!0}],"(cursors follow this setting rather than default)"),new Bi("wrinklersBypassFancy",[{text:"Wrinklers always FANCY"},{text:"Wrinklers always FAST"},{text:"Wrinklers always DEFAULT",off:!0}],"(wrinklers follow this setting rather than default)")]),new Ti("Quality of Life"),new Pi([new Li("enhancedBulk",{text:"Enhanced bulk ON",func:function(){return ki()}},{text:"Enhanced bulk OFF",func:function(){return ki()}},"(allows partial and maximum bulk purchases)"),new Li("buffTooltipDuration",{text:"Show buff duration in tooltip ON"},{text:"Show buff duration in tooltip OFF"},"(buffs will show their current duration in their tooltip)")]),new Ti("Stock Market"),new Pi([new Li("stockValueData",{text:"Stock value data ON"},{text:"Stock value data OFF"},"(displays information about how profitable your stocks are)"),new Li("dangerousStocks",{text:"Dangerous stocks ON"},{text:"Dangerous stocks OFF"},"(stock market affects total cookies earned)"),new Li("dangerousBrokers",{text:"Dangerous brokers ON",func:function(){return Ci.apply()}},{text:"Dangerous brokers OFF"},"(hiring brokers reduces your Stock Market profits)"),new Li("alternateStockMarket",{text:"Alternate layout ON",func:function(){return wi.apply()}},{text:"Alternate layout OFF"},"(a more compact layout for goods; disabling requires refresh)")]),new Ti("Pantheon"),new Pi([new Li("detailedCyclius",{text:"Cyclius details ON",func:function(){return bi()}},{text:"Cyclius details OFF",func:function(){return bi()}},"(shows Cyclius' current cycles in his tooltip)"),new Li("zonedCyclius",{text:"Zoned Cyclius ON",func:function(){return Game.recalculateGains=1}},{text:"Zoned Cyclius OFF",func:function(){return Game.recalculateGains=1}},"(offsets Cyclius based on your time zone, towards GMT+1)"),new Li("trueCyclius",{text:"True Cyclius ON"},{text:"True Cyclius OFF"},"(cosmetic; Cyclius shows off his power with style)"),new Li("skruuiaRebalance",{text:"Skruuia rebalance ON"},{text:"Skruuia rebalance OFF"},"(Skruuia's bonus applies to wrinkler suck rate rather than wrinkler pop multiplier)")]),new Ti("Grimoire"),new Pi([new Li("improveMagicMeter",{text:"Improved magic meter ON"},{text:"Improved magic meter OFF"},"(slight improvements to the magic meter; disabling requires refresh)")]),new Ti("Experimental"),new Pi([new Li("optimizeBuildings",{text:"Buildings draw smart ON"},{text:"Buildings draw smart OFF"},"(buildings attempt to skip unnecessary draw frames)"),new Li("preserveWrinklers",{text:"Preserve wrinklers ON"},{text:"Preserve wrinklers OFF"},"(attempts to preserve all wrinkler data on game save/load)"),new Li("cursedFinger",{text:"Cursed Finger tweaks ON",func:function(){return ri.apply()}},{text:"Cursed Finger tweaks OFF",func:function(){return ri.remove()}},"(CF does not snapshot and counts as real passive CpS)"),new Li("buildingPriceBuff",{text:"Building price buff ON",func:function(){Oi.apply(),Game.storeToRefresh=1}},{text:"Building price buff OFF",func:function(){Game.storeToRefresh=1}},"(building price modifiers instead affect price scaling; <span class=\"warning\">balance warning</span>)"),new Li("optiCookies",{text:"OptiCookies ON",func:function(){return vi.apply()}},{text:"OptiCookies OFF"},"(a couple of small performance tweaks; disabling requires refresh)")]),new Fi("Debug"),new Ai([new Li("drawTimerFix",{text:"Draw timer fix ON",func:function(){return Si.apply()}},{text:"Draw timer fix OFF"},"(adjusts placement of Timer.say for Game.Draw)")])]),Di=Object.freeze({__proto__:null,OptionedButton:Bi,BooleanButton:Li,Slider:Mi,Header:Ti,Title:ji,Listing:Pi,SesameListing:Ai,SesameHeader:Fi,ConfigMenu:Ii,customOptionsMenu:function(){if("prefs"==Game.onMenu){var e=Ei.display();l("menu").childNodes[2].insertBefore(e,l("menu").childNodes[2].childNodes[l("menu").childNodes[2].childNodes.length-1])}}}),Ui=function(){return function(e,i){void 0===i&&(i=function(){return!0}),this.func=e,this.enabled=i}}(),Ni=function(){function e(e){void 0===e&&(e={}),this.routines=e}return e.prototype.run=function(){for(var e in this.routines)this.routines[e].enabled&&this.routines[e].enabled()&&this.routines[e].func()},e.prototype.register=function(e,i){this.routines[e]=new Ui(i)},e}(),Ri=function(){return function(){}}(),_i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.improveAscendMeter=new Ui(function(){var e=Game.ascendMeter,i=Game.ascendNumber,t=Game.HowMuchPrestige(Game.cookiesReset),n=Fe(Game.HowMuchPrestige(Game.cookiesReset+Game.cookiesEarned)),a=n-Fe(t),s=window.Spice;"undefined"!=typeof s&&s.settings.numericallyStableHeavenlyChipGains&&(a=s.stableHeavenlyChipGains());var o=Game.HowManyCookiesReset(Fe(t+a+1))-Game.HowManyCookiesReset(Fe(t+a)),r=Game.HowManyCookiesReset(n+1)-(Game.cookiesEarned+Game.cookiesReset),d=1-r/o;Re.ascendMeterPercent||(Re.ascendMeterPercent=d),Re.ascendMeterLevel||(Re.ascendMeterLevel=a),a!=Re.ascendMeterLevel&&(Re.levelDiff+=a-Re.ascendMeterLevel,Re.ascendMeterLevel=a),Game.ascendMeterPercent=Re.ascendMeterPercent;var c=.1*(Re.levelDiff+d-Game.ascendMeterPercent);Game.ascendMeterPercent+=c;var p=!1,u=!1;2<=Game.ascendMeterPercent&&(p=!0),-1>=Game.ascendMeterPercent&&(u=!0),1<=Game.ascendMeterPercent&&(Re.levelDiff-=Fe(Game.ascendMeterPercent)),0>Game.ascendMeterPercent&&(Re.levelDiff-=Fe(Game.ascendMeterPercent)),0>Game.ascendMeterPercent&&(Game.ascendMeterPercent=1-xe(Game.ascendMeterPercent)),Game.ascendMeterPercent%=1,e.style.transform="";var m=100*Game.ascendMeterPercent;m=p?100:m,m=u?0:m,e.style.width=m+"%",i.textContent="+"+window.SimpleBeautify(a-Re.levelDiff),Re.ascendMeterPercent=Game.ascendMeterPercent},function(){if(qe.improveAscendMeter)return!0;var e=Game.ascendMeter;return e.style.removeProperty("width"),!1}),i.updateSkruuiaRebalance=new Ui(function(){var e=1;if(qe.skruuiaRebalance&&Game.hasGod){var i=Game.hasGod("scorn");1===i?e=1.15:2===i?e=1.1:3===i?e=1.05:void 0}var t=Game.Objects.Temple.minigame;t&&("undefined"==typeof t.effs&&(t.effs={}),e!=t.effs.wrinklerEat&&(Game.recalculateGains=1),t.effs.wrinklerEat=e)}),i.bulkStoreRefresh=new Ui(function(){return Game.storeToRefresh=1},function(){return qe.enhancedBulk&&0==Game.T%10}),i.wrinklerDeselect=new Ui(function(){Game.wrinklers.forEach(function(e){return e.selected=0<e.phase?e.selected:0})}),i}return m(i,e),i}(Ri),Hi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return m(i,e),i}(Ni),Wi=new Hi(new _i()),qi=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.updateMilkIcon=new Ui(function(){0==Game.milkType&&Game.Milk!=Re.lastAutoMilk?(s(0),Re.lastAutoMilk=Game.Milk):Game.milkType!=Re.lastMilk&&(s(Game.milkType),Re.lastMilk=Game.milkType)},function(){return qe.fancyMilkSelect}),i.grimoireMeterFix=new Ui(function(){var e=Number.parseFloat;this.hasRun=!0;var i=document.getElementById("grimoireBar");if(i){var t=document.getElementById("grimoireBarFull");if(i.className.includes("meterContainer")){t.style.height="8px",t.style.transform="scale(2,2)",t.style.transformOrigin="0 0";var n=document.createElement("div");n.className=i.className,n.style.overflow="hidden",n.style.height="100%",i.className="",i.style.position="relative",i.replaceChild(n,t),n.appendChild(t)}t.style.width=e(t.style.width)/2+"%"}},function(){return qe.improveMagicMeter||this.hasRun}),i.trueCyclius=new Ui(function(){var e=document.getElementById("templeGod3");if(e){var i=e.getElementsByClassName("usesIcon")[0],t=Game.hasGod("ages");if(t){if(i.classList.contains("shadowFilter")){var a=document.createElement("div");a.classList.add("templeIcon"),a.classList.add("shadowFilter"),a.style.margin="unset",i.classList.remove("shadowFilter"),i.style.animation="none",e.removeChild(i),e.appendChild(a),a.appendChild(i),Re.patchedTrueCyclius=!0}var s=0,o=0;qe.trueCyclius?(1===t?s=3:2===t?s=12:3===t?s=24:void 0,o=n(s,qe.zonedCyclius)-we/2,i.style.setProperty("transform","rotate("+o+"rad)")):i.style.removeProperty("transform")}else Re.patchedTrueCyclius&&i.style.removeProperty("transform")}else Re.patchedTrueCyclius=!1}),i}return m(i,e),i}(Ri),zi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return m(i,e),i}(Ni),$i=new zi(new qi()),Xi=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.resetSaveData=new Ui(function(){return $e.reset()}),i.resetScroll=new Ui(function(){for(var e in Game.Objects){var i=Game.Objects[e];i.scrollOffX&&(i.scrollOffX=0)}}),i}return m(i,e),i}(Ri),Vi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return m(i,e),i}(Ni),Yi=new Vi(new Xi()),Ki=Object.freeze({__proto__:null,RoutineFunction:Ui,Routine:Ni,RoutineCollection:Ri,logicRoutine:Wi,drawRoutine:$i,resetRoutine:Yi}),Zi={Farm:{building:Game.Objects.Farm,frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(40*(Math.random()-.5)),y:e.y+Fe(10*(Math.random()-.5))+5,z:e.y+.1,id:i,pic:"farmerGrandma.png",frame:-1,grandma:!0}}},Mine:{building:Game.Objects.Mine,frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(25*(Math.random()-.5))+10,y:e.y+Fe(5*(Math.random()-.4))+2,z:e.y+.1,id:i,pic:"minerGrandma.png",frame:-1,grandma:!0}}},Factory:{building:Game.Objects.Factory,frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(50*(Math.random()-.5)),y:e.y,z:e.y+.1,id:i,pic:"workerGrandma.png",frame:-1,grandma:!0}}},Bank:{building:Game.Objects.Bank,frequency:k/2,drawGrandma:function(e,i){return{x:e.x+Fe(40*(Math.random()-.5)),y:e.y+Fe(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"bankGrandma.png",frame:-1,grandma:!0}}},Temple:{building:Game.Objects.Temple,frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(25*(Math.random()-.5)),y:e.y+Fe(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"templeGrandma.png",frame:-1,grandma:!0}}},"Wizard tower":{building:Game.Objects["Wizard tower"],frequency:3,drawGrandma:function(e,i){return{x:e.x+Fe(35*(Math.random()-.5))+20,y:Fe(12*(Math.random()-.5))+60,z:e.y+50,id:i,pic:"witchGrandma.png",frame:-1,grandma:!0}}},Shipment:{building:Game.Objects.Shipment,frequency:.5,drawGrandma:function(e,i){var t="0.1"==(i-e.id).toFixed(1)?-1:1,n=e.x+Fe(5*(Math.random()*t))+15*t,a=e.y+Fe(20*Math.random())+-1*(15*t);return{x:n,y:a,z:a+i%1,id:i,pic:"cosmicGrandma.png",frame:-1,grandma:!0}}},"Alchemy lab":{building:Game.Objects["Alchemy lab"],frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(45*(Math.random()-.5)),y:e.y+Fe(4*(Math.random()-.5)),z:e.y+.1,id:i,pic:"transmutedGrandma.png",frame:-1,grandma:!0}}},Portal:{building:Game.Objects.Portal,frequency:we/2,drawGrandma:function(e,i){var t=Fe(70*Math.random());return{x:e.x+Fe(35*(Math.random()-.5)),y:t,z:999+t+i,id:i,pic:"alteredGrandma.png",frame:-1,grandma:!0}}},"Time machine":{building:Game.Objects["Time machine"],frequency:1,drawGrandma:function(e,i){return c("https://gamrguy.github.io/OmniscientCookies/img/timemachine_front.png"),[{x:e.x-5,y:e.y-2,z:999+e.id,id:i,pic:"grandmasGrandma.png",frame:-1,grandma:!0},{x:e.x,y:e.y,z:1e3+e.id,id:i+.01,pic:"https://gamrguy.github.io/OmniscientCookies/img/timemachine_front.png",frame:-1}]}},"Antimatter condenser":{building:Game.Objects["Antimatter condenser"],frequency:1,drawGrandma:function(e,i){return{x:e.x,y:e.y-6,z:999+e.id,id:i,pic:"antiGrandma.png",frame:-1,grandma:!0}}},Prism:{building:Game.Objects.Prism,frequency:1,drawGrandma:function(e,i){return{x:e.x+Fe(45*(Math.random()-.5)),y:e.y+Fe(8*(Math.random()-.5))+8,z:e.y+.1,id:i,pic:"rainbowGrandma.png",frame:-1,grandma:!0}}},Chancemaker:{building:Game.Objects.Chancemaker,frequency:2,drawGrandma:function(e,i){return{x:e.x+Fe(50*(Math.random()-.5)),y:70,z:777+e.id,id:i,pic:"luckyGrandma.png",frame:-1,grandma:!0}}},"Fractal engine":{building:Game.Objects["Fractal engine"],frequency:we/4,drawGrandma:function(e,i){var t=Math.sign,n=(i-e.id).toFixed(1);this.prevX&&"0.1"!=n&&n!=this.prevID||(this.prevX=0,this.prevY=0);var a=e.x+Fe(35*(Math.random()-.5)),s=Fe(70*Math.random());return this.prevX&&30>xe(a-this.prevX)&&(a+=30*t(a-e.x)),this.prevY&&30>xe(s-this.prevY)&&(s+=30*t(e.y-s)),this.prevX=a,this.prevY=s,this.prevID=n,{x:a,y:s,z:999+s+i,id:i,pic:"metaGrandma.png",frame:-1,grandma:!0}}},Idleverse:{building:Game.Objects.Idleverse,frequency:we/1.5,drawGrandma:function(e,i){return{x:e.x+Fe(15*(Math.random()-.5)),y:e.y+Fe(15*(Math.random()-.5))-25,z:e.y+1,id:i,pic:"alternateGrandma.png",frame:-1,grandma:!0}}}},Ji=Object.freeze({__proto__:null,registerSupport:function(e,i){Zi[e.building.name]&&u("Replacing custom grandma support for '"+e.building.name+"'!"),Zi[e.building.name]=e,i&&(Re.bannedGrandmas[i]=!0)},tryDrawGrandmas:function(e,t,n){var a=Zi[e.name];if(a){var s=!a.frequency||0>=a.frequency?1:a.frequency,r=o(e),d=f(n,s),c=f(n-1,s),p=d-c;p=Fe(Be(0,De(p,r-d)));for(var u=[],m=0;m<p;m++)n+=.1,u=u.concat(a.drawGrandma(t,n));return u}},grandmaProperties:Zi}),Qi="Omniscient Cookies",et=Ne,it=He,tt=Di,nt=Gi,at=Xe,st=Ki,ot=qe,rt=$e,lt=[choose(["nice grandmas","hard-working grandmas","old ladies"]),"farmers","miners","workers",choose(["bankers","brokers","financial advisors","accountants"]),"priestesses","witches",choose(["aliens","bounty hunters","spice traders","kessel runners"]),choose(["full-cookie alchemists","golden grans"]),choose(["elder abominations","flesh piles","doughy beings"]),choose(["time policemas","nice old lady's nice old ladies"]),"antimatter constructs","living rainbows","leprechauns","Cyriak wannabes",choose(["NaNnies","[Error: cookie is not defined]s","['g','r','a','n']s"]),choose(["spaghetti bakers","pancake flippers","not-cookie productionists","pastry panhandlers"])],dt=choose(Game.ObjectsById.slice(1,18)),ct=0;ct=dt==Game.Objects.Grandma?Game.Objects.Grandma.amount:it.getNumSynergyGrandmas(dt);var pt="Your <b>"+ct+" "+lt[dt.id-1]+"</b> missed you!";(0==dt.amount||0>=ct)&&(pt=". . . but nobody came");var ut,mt=["And then he said,<br>'Let there be cookies'","Some dude called "+choose(["theGameMaster1234","RobotLucca","gamrguy","theMineMaster2","DeadlyFez"])+" made this","That ascend meter was getting antsy",pt,"The cookies have eyes.<br>Watch yourself out there","Over the river and through the cookies","Thank you for choosing the "+choose(["Typescript","Cppkies"])+" edition of Omniscient Cookies!<br>(No warranties, no refunds)","What do Omniscient Cookies taste like?<br>Study reveals a flavor 'somewhere between amateur Javascript and messy programming'","Also try <a href=\"https://github.com/staticvariablejames/SpicedCookies/\" target=\"_blank\">Spiced Cookies</a>!","You stared into the cookie,<br>and the cookie stared back","Check out the <a href=\"https://github.com/gamrguy/OmniscientCookies/\" target=\"_blank\">GitHub page</a>!"],gt={init:function(){nt.smoothBuildings.apply(),nt.scrollingBuildings.apply(),nt.buffTooltips.apply(),nt.tooltipWobble.apply(),nt.cycliusGains.apply(),nt.stockInfo.apply(),nt.fancyBuildings.apply(),nt.fancyCursors.apply(),nt.fancyWrinklers.apply(),nt.skruuiaRebalance.apply(),nt.dangerousStocks.apply(),nt.cycliusInfo.apply(),Ke.on("draw",function(){return st.drawRoutine.run()}),Ke.on("logic",function(){return st.logicRoutine.run()}),Ke.on("reset",function(){return st.resetRoutine.run()}),Ke.on("optionsMenu",function(){return tt.customOptionsMenu()}),Game.Notify("Loaded "+Qi+" "+et,"<q>"+choose(mt)+"</q>",[10,31],6)},save:function(){return JSON.stringify({settings:ot.save(),saveData:rt.save()})},load:function(e){var i=JSON.parse(e);ot.load(i.settings),rt.load(i.saveData),nt.buySellBulk.apply(),nt.scrollbarStyle.toggle(ot.autoScrollbar),nt.buildingTooltips.toggle(ot.betterBuildingTooltips),nt.miscGrandmaFixes.toggle(ot.betterGrandmas),nt.cursedFingerTweaks.toggle(ot.cursedFinger),nt.displaySeasonUnlock.toggle(ot.displaySeasons),nt.statsUpgradeCategories.toggle(ot.separateTechs||ot.separateSeasons),nt.optiCookies.toggle(ot.optiCookies),nt.dangerousBrokers.toggle(ot.dangerousBrokers),nt.heavenlyCookies.toggle(ot.heavenlyCookies),nt.buildingPriceBuff.toggle(ot.buildingPriceBuff),nt.alternateStockMarket.toggle(ot.alternateStockMarket),nt.drawTimerFix.toggle(ot.drawTimerFix)}},ft=Object.freeze({__proto__:null,name:Qi,version:et,Util:it,Config:tt,Patches:nt,Logger:at,Routines:st,GrandmaSupport:Ji,vars:Re,settings:ot,saveData:rt,mod:gt});window.OmniCookies?(at.warn("Mod loaded twice???"),ut=window.OmniCookies):(Ke.onLoad.push(function(){Game.registerMod(Qi,gt)}),ut=ft,window.OmniCookies=ft);var kt=ut;return kt});
//# sourceMappingURL=main.js.map
