{"version":3,"file":"main.js","sources":["../src/GrandmaSupport.ts","../src/Patches.ts","../src/Util.ts","../src/Logger.ts","../src/Config.ts","../src/Vars.ts","../src/Settings.ts","../src/SaveData.ts","../src/Routines.ts","../src/OmniCookies.ts","../src/index.ts"],"sourcesContent":["import * as Util from \"./Util\";\r\nimport * as Logger from \"./Logger\";\r\n\r\nexport interface Icon {\r\n\tframe: number\r\n\r\n\t/** ID of the image (should be unique) */\r\n\tid: number\r\n\r\n\t/** Asset name to use */\r\n\tpic: string\r\n\r\n\t/** Horizontal offset */\r\n\tx: number\r\n\r\n\t/** Vertical offset */\r\n\ty: number\r\n\r\n\t/** Depth offset */\r\n\tz: number\r\n\r\n\t/** Whether this image is a hoverable grandma */\r\n\tgrandma?: boolean\r\n}\r\n\r\n/** Defines synergy grandma drawing behavior */\r\nexport interface Properties {\r\n\t/** Building to tie in with */\r\n\tbuilding: Game.Object\r\n\r\n\t/** \r\n\t * Buildings-to-grandmas ratio  \r\n\t * If this is less than 1, draw more per building  \r\n\t * If this is greater than 1, draw less per building\r\n\t * \r\n\t * Must be greater than 0\r\n\t */\r\n\tfrequency?: number\r\n\r\n\t/**\r\n\t * @param {Icon} basePic Base building icon, for positioning grandmas\r\n\t * @param {number} id Unique identifier for this particular grandma\r\n\t * @returns {Icon|Icon[]} New images to draw for the drawn grandma\r\n\t */\r\n\tdrawGrandma: (basePic: Icon, id: number) => Icon | Icon[]\r\n}\r\n\r\n/**\r\n * Registers support for a custom Bring Grandma to Work Day display\r\n * \r\n * @param props Grandma support properties\r\n */\r\nexport function registerSupport(props: Properties) {\r\n\tif(grandmaProperties[props.building.name]) {\r\n\t\tLogger.warn(`Replacing custom grandma support for '${props.building.name}'!`);\r\n\t}\r\n\tgrandmaProperties[props.building.name] = props;\r\n}\r\n\r\n/**\r\n * Calculates the amount of grandmas that have been drawn  \r\n * given a number of buildings and a frequency.\r\n * \r\n * This is NOT mathematically independent.  \r\n * To get the true values, compare against the previous calc\r\n * and subtract 1 if the difference is >= 2.\r\n * \r\n * @param num Amount of buildings\r\n * @param freq Amount of buildings per grandma\r\n * @returns Amount of grandmas\r\n */\r\nfunction grandmaAmountCalc(num: number, freq: number) {\r\n\tlet lastPerc = Math.abs(((num-1)/freq)%1);\r\n\tlet count = num/freq;\r\n\r\n\t// did we skip a number?\r\n\tif(Math.floor(count - lastPerc) < count) count += 1;\r\n\r\n\treturn Math.floor(count);\r\n}\r\n\r\n/**\r\n * Attempts to draw a synergy grandma on supported buildings.\r\n * \r\n * @param building Building to draw grandmas on\r\n * @param basePic Base building sprite\r\n * @param id Which building this is\r\n * @returns Grandma icons to draw\r\n */\r\nexport function tryDrawGrandmas(building: Game.Object, basePic: Icon, id: number): Icon[] {\r\n\tlet props = grandmaProperties[building.name];\r\n\tif(!props) return;\r\n\tlet freq = (!props.frequency || props.frequency <= 0) ? 1 : props.frequency;\r\n\tlet currentGrandmas = Util.getNumSynergyGrandmas(building);\r\n\r\n\t// This math is ridiculous but seriously just go with it\r\n\tlet drawnGrandmas = grandmaAmountCalc(id, freq);\r\n\tlet prevDrawnGrandmas = grandmaAmountCalc(id-1, freq);\r\n\tlet num = drawnGrandmas-prevDrawnGrandmas;\r\n\tif(drawnGrandmas - prevDrawnGrandmas >= 2) drawnGrandmas--;\r\n\tnum = Math.floor(Math.max(0, Math.min(num, currentGrandmas - drawnGrandmas)));\r\n\r\n\tlet grandmas: Icon[] = [];\r\n\tfor(let i = 0; i < num; i++) {\r\n\t\tid += 0.1;\r\n\t\tgrandmas = grandmas.concat(props.drawGrandma(basePic, id));\r\n\t}\r\n\treturn grandmas;\r\n}\r\n\r\nexport let grandmaProperties: Record<string, Properties> = {\r\n\t'Farm': {\r\n\t\tbuilding: Game.Objects['Farm'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*40),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*10)+5,\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'farmerGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Mine': {\r\n\t\tbuilding: Game.Objects['Mine'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*25)+10,\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.4)*5)+2,\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'minerGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Factory': {\r\n\t\tbuilding: Game.Objects['Factory'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*50),\r\n\t\t\t\ty: basePic.y,\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'workerGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Bank': {\r\n\t\tbuilding: Game.Objects['Bank'],\r\n\t\tfrequency: Math.E/2,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*40),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*4),\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'bankGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Temple': {\r\n\t\tbuilding: Game.Objects['Temple'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*25),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*4),\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'templeGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Wizard tower': {\r\n\t\tbuilding: Game.Objects['Wizard tower'],\r\n\t\tfrequency: 3,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*35)+20,\r\n\t\t\t\ty: Math.floor((Math.random()-0.5)*12)+60,\r\n\t\t\t\tz: basePic.y+50,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'witchGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Shipment': {\r\n\t\tbuilding: Game.Objects['Shipment'],\r\n\t\tfrequency: 0.5,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\tlet dir = (id - basePic.id).toFixed(1) == '0.1' ? -1 : 1;\r\n\t\t\tlet x = basePic.x + Math.floor(Math.random()*dir*5)+(15*dir);\r\n\t\t\tlet y = basePic.y + Math.floor(Math.random()*20)+(15*dir*-1);\r\n\t\t\treturn {\r\n\t\t\t\tx: x,\r\n\t\t\t\ty: y,\r\n\t\t\t\tz: y+(id%1),\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'cosmicGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Alchemy lab': {\r\n\t\tbuilding: Game.Objects['Alchemy lab'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*45),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*4),\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'transmutedGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Portal': {\r\n\t\tbuilding: Game.Objects['Portal'],\r\n\t\tfrequency: Math.PI/2,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\tlet y = Math.floor((Math.random())*70);\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*35),\r\n\t\t\t\ty: y,\r\n\t\t\t\tz: 999+y+id,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'alteredGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Time machine': {\r\n\t\tbuilding: Game.Objects['Time machine'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\t// Load the front of the time machine, to overlay the grandma's grandma\r\n\t\t\tlet spriteName = 'https://gamrguy.github.io/OmniscientCookies/img/timemachine_front.png';\r\n\t\t\tUtil.loadCustomAsset(spriteName);\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tx: basePic.x - 5,\r\n\t\t\t\t\ty: basePic.y-2,\r\n\t\t\t\t\tz: 999+basePic.id,\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\tpic: 'grandmasGrandma.png',\r\n\t\t\t\t\tframe: -1,\r\n\t\t\t\t\tgrandma: true\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tx: basePic.x,\r\n\t\t\t\t\ty: basePic.y,\r\n\t\t\t\t\tz: 1000+basePic.id,\r\n\t\t\t\t\tid: id + 0.01,\r\n\t\t\t\t\tpic: spriteName,\r\n\t\t\t\t\tframe: -1\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t},\r\n\t'Antimatter condenser': {\r\n\t\tbuilding: Game.Objects['Antimatter condenser'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x,\r\n\t\t\t\ty: basePic.y-6,\r\n\t\t\t\tz: 999+basePic.id,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'antiGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Prism': {\r\n\t\tbuilding: Game.Objects['Prism'],\r\n\t\tfrequency: 1,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*45),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*8)+8,\r\n\t\t\t\tz: basePic.y+0.1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'rainbowGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Chancemaker': {\r\n\t\tbuilding: Game.Objects['Chancemaker'],\r\n\t\tfrequency: 2,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*50),\r\n\t\t\t\ty: 70,\r\n\t\t\t\tz: 777+basePic.id,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'luckyGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Fractal engine': {\r\n\t\tbuilding: Game.Objects['Fractal engine'],\r\n\t\tfrequency: Math.PI/4,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\tlet realID = (id - basePic.id).toFixed(1);\r\n\t\t\tif(!this.prevX || (realID == '0.1') || realID == this.prevID) { \r\n\t\t\t\tthis.prevX = 0; \r\n\t\t\t\tthis.prevY = 0; \r\n\t\t\t}\r\n\t\t\tlet x = basePic.x + Math.floor((Math.random()-0.5)*35);\r\n\t\t\tlet y = Math.floor((Math.random())*70);\r\n\t\t\tif(this.prevX && Math.abs(x - this.prevX) < 30) x += Math.sign(x - basePic.x) * 30;\r\n\t\t\tif(this.prevY && Math.abs(y - this.prevY) < 30) y += Math.sign(basePic.y - y) * 30;\r\n\t\t\tthis.prevX = x;\r\n\t\t\tthis.prevY = y;\r\n\t\t\tthis.prevID = realID;\r\n\t\t\treturn {\r\n\t\t\t\tx: x,\r\n\t\t\t\ty: y,\r\n\t\t\t\tz: 999+y+id,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'metaGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'Idleverse': {\r\n\t\tbuilding: Game.Objects['Idleverse'],\r\n\t\tfrequency: Math.PI/1.5,\r\n\t\tdrawGrandma(basePic, id) {\r\n\t\t\treturn {\r\n\t\t\t\tx: basePic.x + Math.floor((Math.random()-0.5)*15),\r\n\t\t\t\ty: basePic.y + Math.floor((Math.random()-0.5)*15) - 25,\r\n\t\t\t\tz: basePic.y + 1,\r\n\t\t\t\tid: id,\r\n\t\t\t\tpic: 'alternateGrandma.png',\r\n\t\t\t\tframe: -1,\r\n\t\t\t\tgrandma: true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import * as Util from './Util'\r\nimport { settings } from './Settings'\r\nimport { vars } from './Vars'\r\n\r\nclass Patch {\r\n\tpatchFunc: () => void\r\n\tremoveFunc: () => void\r\n\tapplied: boolean\r\n\tconstructor(patchFunc: () => void, removeFunc?: () => void) {\r\n\t\tthis.patchFunc = patchFunc;\r\n\t\tthis.removeFunc = removeFunc;\r\n\t\tthis.applied = false;\r\n\t}\r\n\tapply() {\r\n\t\tif(this.applied) return;\r\n\t\tthis.patchFunc();\r\n\t\tthis.applied = true;\r\n\t}\r\n\tremove() {\r\n\t\tif(!this.applied || !this.removeFunc) return;\r\n\t\tthis.removeFunc();\r\n\t\tthis.applied = false;\r\n\t}\r\n\ttoggle(force?: boolean) {\r\n\t\tlet toState = !this.applied;\r\n\t\tif(typeof force != 'undefined') toState = force;\r\n\t\tif(toState) this.apply();\r\n\t\telse this.remove();\r\n\t}\r\n}\r\n\r\n/** Toggles the center view's scrollbar style */\r\nexport let scrollbarStyle = new Patch(\r\n\t() => Util.scrollbarStyle('auto'),\r\n\t() => Util.scrollbarStyle('scroll')\r\n)\r\n\r\n/** Patches UpdateMenu to add in the custom options */\r\nexport let updateMenu = new Patch(function() {\r\n\tGame.UpdateMenu = Util.replaceCode(Game.UpdateMenu, [\r\n\t\t{\r\n\t\t\tpattern: /}$/,\r\n\t\t\treplacement: 'OmniCookies.Config.customOptionsMenu();$&'\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Patches DrawBuildings to perform the smoothBuildings setting */\r\nexport let smoothBuildings = new Patch(function() {\r\n\tGame.DrawBuildings = Util.replaceCode(Game.DrawBuildings, [\r\n\t\t{\r\n\t\t\tpattern: 'Game.drawT%3==0',\r\n\t\t\treplacement: 'OmniCookies.settings.smoothBuildings || $&'\r\n\t\t}\r\n\t])\r\n})\r\n\r\n/** \r\n * Patches buildings to support the scroll feature.  \r\n * Also contains the necessary patches for BYGTWD.  \r\n * Because reasons.\r\n */\r\nexport let scrollingBuildings = new Patch(function() {\r\n\tlet drawPattern: Util.CodeReplacement[] = [\r\n\t\t{   // Resize the canvas when it actually needs to\r\n\t\t\tpattern: 'if \\(this.toResize\\)',\r\n\t\t\treplacement: 'if (this.toResize || this.canvas.width != this.canvas.clientWidth || this.canvas.height != this.canvas.clientHeight)'\r\n\t\t},\r\n\t\t{   // Force draw on resize\r\n\t\t\tpattern: 'this.toResize=false;',\r\n\t\t\treplacement: '$&;this.forceDraw=true;'\r\n\t\t},\r\n\t\t{   // Do some tracking and determine whether this canvas actually needs to redraw\r\n\t\t\tpattern: `if (typeof(bg)=='string') ctx.fillPattern`,\r\n\t\t\treplacement: `\r\n\t\t\t\tlet synergyAmount = OmniCookies.settings.bringGrandmaToWork ? OmniCookies.Util.getNumSynergyGrandmas(this) : -1;\r\n\t\t\t\tif(OmniCookies.settings.optimizeBuildings && !this.hasUnloadedImages && !this.forceDraw && !this.lastMouseOn && !this.mouseOn && (this.lastAmount == this.amount) && (this.name == 'Grandma' ? true : this.lastSynergyAmount == synergyAmount)) return;\r\n\t\t\t\tthis.forceDraw = false;\r\n\t\t\t\tthis.lastAmount = this.amount;\r\n\t\t\t\tthis.lastMouseOn = this.mouseOn;\r\n\t\t\t\tthis.lastSynergyAmount = synergyAmount;\r\n\t\t\t\tthis.hasUnloadedImages = Game.Loader.assetsLoaded.indexOf(this.art.bg) == -1;\r\n\t\t\t\tlet hasGrandmas = false;\r\n\t\t\t\t$&`\r\n\t\t},\r\n\t\t{   // Check for unloaded building pics\r\n\t\t\tpattern: 'var sprite=Pic(pic.pic);',\r\n\t\t\treplacement: '$&\\nthis.hasUnloadedImages = this.hasUnloadedImages || sprite == Game.Loader.blank;'\r\n\t\t},\r\n\t\t{   // Scroll the background with the scroll offset\r\n\t\t\tpattern: '0,0,this.canvas.width,this.canvas.height,128,128',\r\n\t\t\treplacement: '$&,-this.scrollOffX'\r\n\t\t},\r\n\t\t{   // Modify building image bounds based on scroll offset\r\n\t\t\tpattern: 'var maxI=Math.floor(this.canvas.width',\r\n\t\t\treplacement: 'var minI=Math.max(0, Math.floor((-50 + this.scrollOffX) / (w/rows)));\\nvar maxI=Math.floor((this.canvas.width + 50 + this.scrollOffX)'\r\n\t\t},\r\n\t\t{   // Reset sprites\r\n\t\t\tpattern: 'var i=this.pics.length;',\r\n\t\t\treplacement: 'this.pics = [];\\nvar i=minI;'\r\n\t\t},\r\n\t\t{   // Offset sprites\r\n\t\t\tpattern: \"var usedPic=(typeof(pic)=='string'?pic:pic(this,i));\",\r\n\t\t\treplacement: \"x-=this.scrollOffX;\\n$&\"\r\n\t\t},\r\n\t\t{   // Scroll when mouse hovers over outer 100px of building view\r\n\t\t\tpattern: 'var selected=-1;',\r\n\t\t\treplacement: `\r\n\t\t\t\tvar speed = 20;\r\n\t\t\t\tif(!OmniCookies.settings.smoothBuildings) speed *= 3;\r\n\t\t\t\tif(this.mousePos[0] >= (this.canvas.width) - 100 && maxI <= this.amount + rows * 3) {\r\n\t\t\t\t\tthis.scrollOffX += Math.floor(speed * ((this.mousePos[0] - (this.canvas.width - 100)) / 100));\r\n\t\t\t\t}\r\n\t\t\t\tif(this.mousePos[0] <= 100 && this.scrollOffX > 0) {\r\n\t\t\t\t\tthis.scrollOffX -= Math.floor(speed * (1 - this.mousePos[0] / 100));\r\n\t\t\t\t}\r\n\t\t\t\tif(this.scrollOffX < 0 || !OmniCookies.settings.scrollingBuildings) this.scrollOffX = 0;\r\n\t\t\t\t$&`\r\n\t\t},\r\n\t\t{   // Reimplement delay on grandma hover shake\r\n\t\t\tpattern: 'ctx.drawImage(sprite,Math.floor(pic.x+Math.random()*4-2),Math.floor(pic.y+Math.random()*4-2));',\r\n\t\t\treplacement: `\r\n\t\t\t\tif(Game.drawT%3==0) {\r\n\t\t\t\t\tthis.lastRandX = Math.random()*4;\r\n\t\t\t\t\tthis.lastRandY = Math.random()*4;\r\n\t\t\t\t}\r\n\t\t\t\tctx.drawImage(sprite,Math.floor(pic.x+this.lastRandX-2),Math.floor(pic.y+this.lastRandY-2));`\r\n\t\t},\r\n\t\t{   // Bring Grandma To Work Day\r\n\t\t\tpattern: 'this.pics.push({x:Math.floor(x),y:Math.floor(y),z:y,pic:usedPic,id:i,frame:frame});',\r\n\t\t\treplacement: `$&\r\n\t\t\t\tif(OmniCookies.settings.bringGrandmaToWork) {\r\n\t\t\t\t\tlet grandmas = OmniCookies.GrandmaSupport.tryDrawGrandmas(this, this.pics[this.pics.length-1], i);\r\n\t\t\t\t\tif(grandmas && grandmas.length > 0){\r\n\t\t\t\t\t\thasGrandmas = true;\r\n\t\t\t\t\t\tthis.pics = this.pics.concat(grandmas);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t`\r\n\t\t},\r\n\t\t{   // Enable grandma hovering on supported buildings\r\n\t\t\tpattern: `if (this.name=='Grandma')`,\r\n\t\t\treplacement: `if (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && hasGrandmas))`\r\n\t\t},\r\n\t\t{   // Count hovered grandmas as grandmas\r\n\t\t\tpattern: `if (selected==i && this.name=='Grandma')`,\r\n\t\t\treplacement: `if (selected==i && (this.name=='Grandma' || (OmniCookies.settings.bringGrandmaToWork && pic.grandma)))`\r\n\t\t},\r\n\t\t{   // Don't let non-grandma things occlude hover detection\r\n\t\t\tpattern: `if (this.mousePos[0]>=pic.x-marginW && this.m`,\r\n\t\t\treplacement: `\r\n\t\t\t\tif(this.name == 'Grandma' ? false : !pic.grandma) continue;\r\n\t\t\t$&`\r\n\t\t},\r\n\t\t{   // Give grandma-supported buildings their own set of grandma seeds\r\n\t\t\tpattern: `Math.seedrandom(Game.seed+' '+pic.id/*+' '+pic.id*/);`,\r\n\t\t\treplacement: `Math.seedrandom(Game.seed+' '+pic.id+(this.name == 'Grandma' ? '' : ' '+this.name));`\r\n\t\t}\r\n\t];\r\n\tlet mutePattern: Util.CodeReplacement[] = [\r\n\t\t{   // Force draw on unmute\r\n\t\t\tpattern: 'this.muted=val;',\r\n\t\t\treplacement: '$&\\nthis.forceDraw=true;'\r\n\t\t}\r\n\t];\r\n\tlet redrawPattern: Util.CodeReplacement[] = [\r\n\t\t{   // Force draw on \"redraw\"\r\n\t\t\tpattern: 'me.pics=[];',\r\n\t\t\treplacement: `$&\r\n\t\t\t\tif(OmniCookies.settings.optimizeBuildings) {\r\n\t\t\t\t\tme.forceDraw = true;\r\n\t\t\t\t}\r\n\t\t\t`\r\n\t\t}\r\n\t];\r\n\r\n\tfor(let i in Game.Objects) {\r\n\t\tlet building = (Game.Objects[i] as any);\r\n\t\tif(building.id != 0) {\r\n\t\t\tbuilding.scrollOffX = 0;\r\n\t\t\tbuilding.lastRandX = 0;\r\n\t\t\tbuilding.lastRandY = 0;\r\n\t\t\tbuilding.lastOffX = 0;\r\n\t\t\tbuilding.lastMouseOn = building.mouseOn;\r\n\t\t\tbuilding.lastAmount = building.amount;\r\n\t\t\tbuilding.lastSynergyAmount = 0;\r\n\t\t\tbuilding.hasUnloadedImages = true;\r\n\t\t\tbuilding.forceDraw = true;\r\n\t\t\r\n\t\t\tbuilding.draw = Util.replaceCode(building.draw, drawPattern);\r\n\t\t\tbuilding.mute = Util.replaceCode(building.mute, mutePattern);\r\n\t\t\tbuilding.redraw = Util.replaceCode(building.redraw, redrawPattern);\r\n\t\t}\r\n\t};\r\n\r\n\t// Inject into Object to affect all future building types\r\n\tGame.Object = Util.replaceCode(Game.Object, drawPattern);\r\n\tGame.Object = Util.replaceCode(Game.Object, [\r\n\t\t{   // Define variables\r\n\t\t\tpattern: '//building canvas',\r\n\t\t\treplacement: `\r\n\t\t\t\tthis.scrollOffX = 0;\r\n\t\t\t\tthis.lastRandX = 0;\r\n\t\t\t\tthis.lastRandY = 0;\r\n\t\t\t\tthis.lastOffX = 0;\r\n\t\t\t\tthis.lastMouseOn = this.mouseOn;\r\n\t\t\t\tthis.lastAmount = this.amount;\r\n\t\t\t\tthis.lastSynergyAmount = 0;\r\n\t\t\t\tthis.hasUnloadedImages = true;\r\n\t\t\t\tthis.forceDraw = true;\r\n\t\t\t$&`\r\n\t\t}\r\n\t]);\r\n\tGame.Object = Util.replaceCode(Game.Object, mutePattern);\r\n\tGame.Object = Util.replaceCode(Game.Object, redrawPattern);\r\n\r\n\t// Bring Your Grandma to Work Day\r\n\tGame.Objects['Grandma'].art.pic = Util.replaceCode((Game.Objects['Grandma'].art.pic as ((building: Game.Object, i: number) => string)), [\r\n\t\t{   // Keep abnormal grandmas off the lawn during BYGTWD\r\n\t\t\tpattern: `if (Game.Has('Far`,\r\n\t\t\treplacement: `if(!OmniCookies.settings.bringGrandmaToWork) {\r\n\t\t\t$&`\r\n\t\t},\r\n\t\t{   // After all, they have somewhere better to be!\r\n\t\t\tpattern: `metaGrandma');`,\r\n\t\t\treplacement: `$&\r\n\t\t\t}`\r\n\t\t},\r\n\t\t{   // Script grannies and seasonal grannies get to stay home\r\n\t\t\tpattern: `if (Game.Has('Alternate grandmas')) list.push('alternateGrandma');`,\r\n\t\t\treplacement: `if(!OmniCookies.settings.bringGrandmaToWork) $&`\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Patches building tooltips to look a bit better in some cases */\r\nexport let buildingTooltips = new Patch(function() {\r\n\tlet tooltipPattern: Util.CodeReplacement[] = [\r\n\t\t{\r\n\t\t\tpattern: `if (synergiesStr!='') synergiesStr+=', ';`,\r\n\t\t\treplacement: `if (OmniCookies.settings.betterBuildingTooltips || synergiesStr != '')\r\n\t\t\t\tsynergiesStr += OmniCookies.settings.betterBuildingTooltips \r\n\t\t\t\t\t? '<br>&nbsp;&nbsp;&nbsp;&nbsp;- '\r\n\t\t\t\t\t: ', ';`\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: `synergiesStr+=i+' +'+Beautify(synergiesWith[i]*100,1)+'%';`,\r\n\t\t\treplacement: `synergiesStr+=i+' '+\r\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '<b>' : '')+\r\n\t\t\t'+'+Beautify(synergiesWith[i]*100,1)+'%'+\r\n\t\t\t(OmniCookies.settings.betterBuildingTooltips ? '</b>' : '');`\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: `synergiesStr=\\'...also boosting some other buildings : '+synergiesStr+' - all`,\r\n\t\t\treplacement: `synergiesStr=\\'...also boosting some other buildings'+\r\n\t\t\t(OmniCookies.settings.betterBuildingTooltips \r\n\t\t\t\t? ': '+synergiesStr+'<br>&bull; ' \r\n\t\t\t\t: ' : '+synergiesStr+' - ')+'all`\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: `<div class=\"data\"`,\r\n\t\t\treplacement: `$& '+(OmniCookies.settings.betterBuildingTooltips ? 'style=\"white-space:nowrap;\"' : '')+'`\r\n\t\t}\r\n\t];\r\n\r\n\tfor(var i in Game.Objects) {\r\n\t\tvar building = Game.Objects[i];\r\n\t\tbuilding.tooltip = Util.replaceCode(building.tooltip, tooltipPattern);\r\n\t}\r\n\r\n\tGame.Object = Util.replaceCode(Game.Object, tooltipPattern);\r\n})\r\n\r\n/** Patches buff tooltips to show remaining time */\r\nexport let buffTooltips = new Patch(function() {\r\n\tvars.buffsById = [];\r\n\r\n\t// *angry programmer noises*\r\n\tinterface BuffWithID extends Game.Buff {\r\n\t\tid: number\r\n\t}\r\n\r\n\t// Edit existing buffs from loaded savegame\r\n\t// This is messy and I hate it\r\n\tfor(let i in Game.buffs) {\r\n\t\tlet buff = (Game.buffs[i] as BuffWithID);\r\n\t\tvars.buffsById[buff.id] = buff;\r\n\t\tlet onmouseover: any = function() {\r\n\t\t\tif (!Game.mouseDown) {\r\n\t\t\t\tGame.setOnCrate(this);\r\n\t\t\t\tGame.tooltip.dynamic=1;\r\n\t\t\t\tGame.tooltip.draw(this, function(){return vars.GetBuffTooltipFunc(buff.id)();},'left');\r\n\t\t\t\tGame.tooltip.wobble();\r\n\t\t\t}\r\n\t\t}\r\n\t\tonmouseover = onmouseover.toString().replace('function() {', '').replace(/}$/, '').replace('buff.id', buff.id);\r\n\t\tGame.buffsL.getElementsByClassName('crate enabled buff')[buff.id].setAttribute('onmouseover', onmouseover);\r\n\t}\r\n\r\n\tGame.gainBuff = Util.replaceCode(Game.gainBuff, [\r\n\t\t{   // Place buff somewhere we can access it later\r\n\t\t\tpattern: 'Game.buffsL.',\r\n\t\t\treplacement: 'OmniCookies.vars.buffsById[buff.id] = buff;$&'\r\n\t\t},\r\n\t\t{   // Update buff desc to new max time\r\n\t\t\tpattern: '//new duration is set to new',\r\n\t\t\treplacement: `$&\r\n\t\t\t\tvar tempBuff=type.func(buff.time/Game.fps,arg1,arg2,arg3);\r\n\t\t\t\tbuff.desc = tempBuff.desc;\r\n\t\t\t`\r\n\t\t},\r\n\t\t{   // Use dynamic tooltip instead of static tooltip\r\n\t\t\tpattern: Game.gainBuff.toString().substr(1037,202), // yes really\r\n\t\t\treplacement: `Game.getDynamicTooltip('(OmniCookies.vars.GetBuffTooltipFunc('+buff.id+'))', 'left', true)`\r\n\t\t}\r\n\t]);\r\n\r\n\t// Create a test for header width\r\n\tvar div = document.createElement('div');\r\n\tdiv.className = 'prompt';\r\n\tvar test = document.createElement('h3');\r\n\tdiv.id = 'OmniCookies_width_test';\r\n\tdiv.appendChild(test);\r\n\tdiv.style.visibility = 'hidden';\r\n\tdocument.getElementById('game').appendChild(div);\r\n\r\n\t// Why am I storing this on-demand? Better not to ask\r\n\tvars.GetBuffTooltipFunc = function(buffId: number) {\r\n\t\treturn function() {\r\n\t\t\tlet buff = (vars.buffsById[buffId] as any);\r\n\r\n\t\t\t// Use the test header to create buffer room for the feather images\r\n\t\t\ttest.textContent = buff.name;\r\n\t\t\tlet width = Math.max(200, test.clientWidth + 78);\r\n\r\n\t\t\tlet buffDesc = buff.desc.replace(Game.sayTime(buff.maxTime,-1),'$&');\r\n\t\t\tlet text = '<div class=\"prompt\" style=\"white-space:nowrap;min-width:'+width+'px;text-align:center;font-size:11px;margin:8px 0px;\"><h3>'+buff.name+'</h3>'+'<div class=\"line\"></div>'+buffDesc;\r\n\t\t\tif(settings.buffTooltipDuration) \r\n\t\t\t\ttext += '<div class=\"line\"></div>'+Game.sayTime(buff.time,-1)+' left';\r\n\t\t\ttext += '</div>';\r\n\t\t\treturn text;\r\n\t\t};\r\n\t}\r\n\r\n\t// Patch Stretch Time success roll to update buff description\r\n\tlet patchGrimoire = setInterval(function() {\r\n\t\tlet minigame = Game.Objects['Wizard tower'].minigame;\r\n\t\tif(minigame) {\r\n\t\t\tminigame.spells['stretch time'].win = Util.replaceCode(minigame.spells['stretch time'].win, [\r\n\t\t\t\t{   // Update all instances of the previous maximum time\r\n\t\t\t\t\t// This means it'll catch Cursed Finger\r\n\t\t\t\t\tpattern: 'me.maxTime+=gain;',\r\n\t\t\t\t\treplacement: `\r\n\t\t\t\t\tlet timePattern = RegExp(Game.sayTime(me.maxTime,-1), 'g');\r\n\t\t\t\t\tme.desc = me.desc.replace(timePattern, Game.sayTime(me.maxTime + gain,-1));\r\n\t\t\t\t\t$&`\r\n\t\t\t\t}\r\n\t\t\t]);\r\n\t\t\tclearInterval(patchGrimoire);\r\n\t\t}\r\n\t}, 250);\r\n})\r\n\r\n/** \r\n * Adds a line break to grandma synergy upgrades\r\n * Fixes the ordering of grandma upgrades in the stats menu\r\n * Makes Script grannies trigger a redraw when bought\r\n */\r\nexport let miscGrandmaFixes = new Patch(function() {\r\n\t// Add a line break between the two effects\r\n\tfor(let i of Game.GrandmaSynergies) {\r\n\t\tlet upgrade = Game.Upgrades[i];\r\n\t\tupgrade.desc = upgrade.desc.replace(/(efficient\\.) /, '$1<br>');\r\n\t\tupgrade.baseDesc = upgrade.desc;\r\n\t}\r\n\r\n\t// Fix the appearance order of these upgrades in the stats menu\r\n\tGame.Upgrades[\"Cosmic grandmas\"].order += 0.2;\r\n\tGame.Upgrades[\"Transmuted grandmas\"].order += 0.2;\r\n\tGame.Upgrades[\"Altered grandmas\"].order += 0.2;\r\n\tGame.Upgrades[\"Grandmas' grandmas\"].order += 0.2;\r\n\r\n\t// Fix the appearance order of buildings in the synergy tooltip list\r\n\tGame.GrandmaSynergies.sort(function(a, b) {\r\n\t\treturn Game.Upgrades[a].order - Game.Upgrades[b].order;\r\n\t});\r\n\r\n\t// Script grannies trigger a redraw\r\n\tlet scriptGrannies = Game.Upgrades['Script grannies'];\r\n\tif(!scriptGrannies.buyFunction) {\r\n\t\tscriptGrannies.buyFunction = function() {\r\n\t\t\tGame.Objects['Grandma'].redraw();\r\n\t\t}\r\n\t} else {\r\n\t\tscriptGrannies.buyFunction = Util.replaceCode(scriptGrannies.buyFunction, [\r\n\t\t\t{   // CCSE injects a buy function into every upgrade for mod hooks\r\n\t\t\t\tpattern: '{',\r\n\t\t\t\treplacement: `$&\\nGame.Objects['Grandma'].redraw();`\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n\r\n\t// Fix Portals and Grandmas not reporting their synergy status\r\n\tGame.Objects['Portal'].tooltip = Util.replaceCode(Game.Objects['Portal'].tooltip, [\r\n\t\t{\r\n\t\t\tpattern: `synergiesWith[other.plural]+=boost/(other.storedTotalCps*Game.globalCpsMult);`,\r\n\t\t\treplacement: `synergiesWith[other.plural] += (me.amount * 0.05)/other.baseCps;`\r\n\t\t}\r\n\t])\r\n\tGame.Objects['Grandma'].tooltip = Util.replaceCode(Game.Objects['Grandma'].tooltip, [\r\n\t\t{\r\n\t\t\tpattern: `for (var i in Game.GrandmaSynergies)`,\r\n\t\t\treplacement: `let selfBoost = 0;\r\n\t\t\t\tif(Game.Has('One mind')) selfBoost += (me.amount * 0.02)/me.baseCps;\r\n\t\t\t\tif(Game.Has('Communal brainsweep')) selfBoost += (me.amount * 0.02)/me.baseCps;\r\n\t\t\t\tif(!synergiesWith[me.plural]) synergiesWith[me.plural] = 0;\r\n\t\t\t\tsynergyBoost += selfBoost;\r\n\t\t\t\tsynergiesWith[me.plural] += selfBoost;\r\n\t\t\t$&`\r\n\t\t}\r\n\t])\r\n})\r\n\r\n/** Adds support for Tech and Seasonal upgrade categories */\r\nexport let statsUpgradeCategories = new Patch(function() {\r\n\tGame.UpdateMenu = Util.replaceCode(Game.UpdateMenu, [\r\n\t\t{   // Declare techUpgrades var\r\n\t\t\tpattern: 'var cookieUpgrades=\\'\\';',\r\n\t\t\treplacement: `$&\r\n\t\t\t\tvar techUpgrades = '';\r\n\t\t\t\tvar seasonalUpgrades = '';\r\n\t\t\t`\r\n\t\t},\r\n\t\t{   // Redirect tech/seasonal upgrades to the new accumulator string\r\n\t\t\tpattern: 'else if (me.pool==\\'cookie\\'',\r\n\t\t\treplacement: `else if (OmniCookies.settings.separateTechs && me.pool == \\'tech\\') techUpgrades+=str2;\r\n\t\t\t\telse if(OmniCookies.settings.separateSeasons && me.unlockAt && (me.unlockAt.season || me.unlockAt.displaySeason)) seasonalUpgrades+=str2;\r\n\t\t\t$&`\r\n\t\t},\r\n\t\t{   // Display the new category\r\n\t\t\tpattern: `cookieUpgrades+'</div>'):'')+`,\r\n\t\t\treplacement: `$&\r\n\t\t\t\t(techUpgrades!=''?('<div class=\"listing\"><b>Technologies</b></div>'+\r\n\t\t\t\t'<div class=\"listing crateBox\">'+techUpgrades+'</div>'):'')+\r\n\t\t\t\t(seasonalUpgrades!=''?('<div class=\"listing\"><b>Seasonal</b></div>'+\r\n\t\t\t\t'<div class=\"listing crateBox\">'+seasonalUpgrades+'</div>'):'')+\r\n\t\t\t`\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Enables displaying seasonal unlock sources */\r\nexport let displaySeasonUnlock = new Patch(function() {\r\n\tlet allSanta = Game.santaDrops.slice(0, Game.santaDrops.length);\r\n\tallSanta.push('A festive hat');\r\n\tallSanta.push('Santa\\'s dominion');\r\n\r\n\tGame.crateTooltip = Util.replaceCode(Game.crateTooltip, [\r\n\t\t{   // Oh god why\r\n\t\t\tpattern: `\\tmysterious=0`,\r\n\t\t\treplacement: `\\tvar $&`\r\n\t\t},\r\n\t\t{\t// Uncomments unlockAt.season\r\n\t\t\tpattern: /(\\/\\*|\\*\\/)/g,\r\n\t\t\treplacement: ''\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: `else if (me.unlockAt.season)`,\r\n\t\t\treplacement: `else if (OmniCookies.settings.displaySeasons && me.unlockAt.season)`\r\n\t\t},\r\n\t\t{   // Implements a cosmetic season unlockAt\r\n\t\t\tpattern: 'else if (me.unlockAt.text)',\r\n\t\t\treplacement: `\r\n\t\t\t\telse if (OmniCookies.settings.displaySeasons && me.unlockAt.displaySeason)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar it=Game.seasons[me.unlockAt.displaySeason];\r\n\t\t\t\t\tdesc='<div style=\"font-size:80%;text-align:center;\">From <div class=\"icon\" style=\"vertical-align:middle;display:inline-block;'+(Game.Upgrades[it.trigger].icon[2]?'background-image:url('+Game.Upgrades[it.trigger].icon[2]+');':'')+'background-position:'+(-Game.Upgrades[it.trigger].icon[0]*48)+'px '+(-Game.Upgrades[it.trigger].icon[1]*48)+'px;transform:scale(0.5);margin:-16px;\"></div> '+it.name+'</div><div class=\"line\"></div>'+desc;\r\n\t\t\t\t}\r\n\t\t\t$&`\r\n\t\t}\r\n\t]);\r\n\r\n\tinterface UnlockDisplaySeason extends Game.UnlockRequirement {\r\n\t\tdisplaySeason: string\r\n\t}\r\n\tfunction addCosmeticSeason(upgrade: string | Game.Upgrade, season: string) {\r\n\t\tif(typeof upgrade == 'string') upgrade = Game.Upgrades[upgrade];\r\n\t\tif(!upgrade.unlockAt) upgrade.unlockAt = {cookies:0,name:upgrade.name};\r\n\t\t(upgrade.unlockAt as UnlockDisplaySeason).displaySeason = season;\r\n\t}\r\n\tfor(let name of Game.reindeerDrops) {\r\n\t\taddCosmeticSeason(name, 'christmas');\r\n\t}\r\n\tfor(let name of allSanta) {\r\n\t\taddCosmeticSeason(name, 'christmas');\r\n\t}\r\n\tfor(let name of Game.halloweenDrops) {\r\n\t\taddCosmeticSeason(name, 'halloween');\r\n\t}\r\n\tfor(let name of Game.easterEggs) {\r\n\t\taddCosmeticSeason(name, 'easter');\r\n\t}\r\n})\r\n\r\n/** Allows disabling the Skruuia wrinkler popping bonus */\r\nexport let skruuiaRebalance = new Patch(function() {\r\n\tGame.UpdateWrinklers = Util.replaceCode(Game.UpdateWrinklers, [\r\n\t\t{\r\n\t\t\tpattern: /(var godLvl=)(Game\\.hasGod\\('scorn'\\))(;\\s*if \\(godLvl==1\\) me\\.sucked\\*=1\\.15;)/m,\r\n\t\t\treplacement: `$1OmniCookies.settings.skruuiaRebalance ? 0 : $2$3`\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/**\r\n * Reworks Cursed Finger a bit\r\n * - Removes the \"snapshotting\" behavior\r\n * - Gain seconds of true passive CpS\r\n */\r\nexport let cursedFingerTweaks = new Patch(function() {\r\n\tvars.cursedPs = Game.cookiesPs;\r\n\tvars.cursedPsMult = Game.globalCpsMult;\r\n\r\n\tlet cursedFinger = Game.buffTypesByName['cursed finger'];\r\n\tcursedFinger.func = Util.replaceCode(cursedFinger.func, [\r\n\t\t{   // Remove multiply by 0 - don't worry, just moving it\r\n\t\t\tpattern: `multCpS:0,`,\r\n\t\t\treplacement: `multCpS:1,`\r\n\t\t},\r\n\t\t{   // Small description edit\r\n\t\t\tpattern: `<br>but each click is worth `,\r\n\t\t\treplacement: `<br>but each click generates `\r\n\t\t}\r\n\t]);\r\n\r\n\tcursedFingerPart2.apply();\r\n\r\n\t// Fix pre-existing cursed finger\r\n\tlet cursedBuff = (Game.hasBuff('Cursed finger') as any); // AAAAAAAAAA\r\n\tif(cursedBuff) {\r\n\t\tcursedBuff.multCpS = 1;\r\n\t\tcursedBuff.desc = cursedBuff.desc.replace('is worth', 'generates');\r\n\t\tGame.recalculateGains = 1;\r\n\t}\r\n}, function() {\r\n\t// Inverse of the original patch\r\n\tlet cursedFinger = Game.buffTypesByName['cursed finger'];\r\n\tcursedFinger.func = Util.replaceCode(cursedFinger.func, [\r\n\t\t{\r\n\t\t\tpattern: `multCpS:1,`,\r\n\t\t\treplacement: `multCpS:0,`\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: `<br>but each click generates `,\r\n\t\t\treplacement: `<br>but each click is worth `\r\n\t\t}\r\n\t]);\r\n\r\n\t// Put the x0 multiplier back, update buff power, fix desc\r\n\tlet cursedBuff = (Game.hasBuff('Cursed finger') as any); // AAAAAAAAAA\r\n\tif(cursedBuff) {\r\n\t\tcursedBuff.multCpS = 0;\r\n\t\tcursedBuff.desc = cursedBuff.desc.replace('generates', 'is worth');\r\n\t\tcursedBuff.power = vars.cursedPs * cursedBuff.maxTime/Game.fps;\r\n\t\tGame.recalculateGains = 1;\r\n\t}\r\n});\r\n\r\n/** One-time patches for Cursed Finger, not undo-able */\r\nlet cursedFingerPart2 = new Patch(function() {\r\n\tGame.CalculateGains = Util.replaceCode(Game.CalculateGains, [\r\n\t\t{   // See? Told you.\r\n\t\t\tpattern: `Game.computedMouseCps=Game.mouseCps();`,\r\n\t\t\treplacement: `$&\r\n\t\t\t\tif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\r\n\t\t\t\t\tOmniCookies.vars.cursedPs = Game.cookiesPs;\r\n\t\t\t\t\tOmniCookies.vars.cursedPsMult = Game.globalCpsMult;\r\n\t\t\t\t\tGame.globalCpsMult = 0;\r\n\t\t\t\t\tGame.cookiesPs = 0;\r\n\t\t\t\t\tGame.computedMouseCps = 0;\r\n\t\t\t\t}`\r\n\t\t}\r\n\t]);\r\n\r\n\t// Inject into and then replace the cookie click event\r\n\tlet bigCookie = document.getElementById('bigCookie');\r\n\tbigCookie.removeEventListener('click', (Game.ClickCookie as EventListener));\r\n\tGame.ClickCookie = Util.replaceCode(Game.ClickCookie, [\r\n\t\t{   // Replace click gains with cursed gains\r\n\t\t\tpattern: `Game.handmadeCookies+=amount;`,\r\n\t\t\treplacement: `$&\r\n\t\t\t\tif(OmniCookies.settings.cursedFinger && Game.hasBuff('Cursed finger')) {\r\n\t\t\t\t\tGame.Dissolve(amount);\r\n\t\t\t\t\tGame.handmadeCookies-=amount;\r\n\t\t\t\t\tamount = OmniCookies.vars.cursedPs * Game.buffs['Cursed finger'].maxTime/Game.fps;\r\n\t\t\t\t\tGame.cookiesPs = OmniCookies.vars.cursedPs;\r\n\t\t\t\t\tGame.globalCpsMult = OmniCookies.vars.cursedPsMult;\r\n\t\t\t\t\tOmniCookies.Util.gainInstantPassiveCpS(Game.buffs['Cursed finger'].maxTime/Game.fps);\r\n\t\t\t\t\tGame.cookiesPs = 0;\r\n\t\t\t\t\tGame.globalCpsMult = 0;\r\n\t\t\t\t}`\r\n\t\t}\r\n\t]);\r\n\tAddEvent(bigCookie, 'click', (Game.ClickCookie as EventListener));\r\n})\r\n\r\n/** Enable tooltip wobbling */\r\nexport let tooltipWobble = new Patch(function() {\r\n\tGame.tooltip.wobble = Util.replaceCode(Game.tooltip.wobble, [\r\n\t\t{\r\n\t\t\tpattern: `if (false)`,\r\n\t\t\treplacement: `if (OmniCookies.settings.tooltipWobble)`\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Replaces cyclius gain function with our own */\r\nexport let cycliusGains = new Patch(function() {\r\n\tGame.CalculateGains = Util.replaceCode(Game.CalculateGains, [\r\n\t\t{\r\n\t\t\tpattern: /\\(Date\\.now\\(\\)\\/1000\\/\\(60\\*60\\*(\\d+)\\)\\)\\*Math\\.PI\\*2/g,\r\n\t\t\treplacement: 'OmniCookies.Util.cycliusCalc($1, OmniCookies.settings.zonedCyclius)'\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Displays information about how much you bought your stocks for */\r\nexport let stockInfo = new Patch(function() {\r\n\tUtil.onMinigameLoaded('Bank', function() {\r\n\t\tlet stockMarket = Game.Objects['Bank'].minigame;\r\n\t\tstockMarket.buyGood = Util.replaceCode(stockMarket.buyGood, [\r\n\t\t\t{   // Calculate new average when buying stock\r\n\t\t\t\tpattern: 'return true;',\r\n\t\t\t\treplacement: `\r\n\t\t\t\t\tlet realCostInS = costInS * overhead;\r\n\t\t\t\t\tif(!OmniCookies.saveData.stockAverages[id] || me.stock == n) {\r\n\t\t\t\t\t\tOmniCookies.saveData.stockAverages[id] = {\r\n\t\t\t\t\t\t\tavgValue: realCostInS,\r\n\t\t\t\t\t\t\ttotalValue: realCostInS*n\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\r\n\t\t\t\t\t\tavg.totalValue += realCostInS*n;\r\n\t\t\t\t\t\tavg.avgValue = avg.totalValue/me.stock;\r\n\t\t\t\t\t}\r\n\t\t\t\t$&`\r\n\t\t\t}\r\n\t\t], `var M = Game.Objects['Bank'].minigame;`);\r\n\t\tstockMarket.sellGood = Util.replaceCode(stockMarket.sellGood, [\r\n\t\t\t{   // Subtract total bought stock value when selling\r\n\t\t\t\tpattern: `return true;`,\r\n\t\t\t\treplacement: `\r\n\t\t\t\t\tif(OmniCookies.saveData.stockAverages[id]) {\r\n\t\t\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[id];\r\n\t\t\t\t\t\tavg.totalValue -= avg.avgValue*n;\r\n\t\t\t\t\t}\r\n\t\t\t\t$&`\r\n\t\t\t}\r\n\t\t], `var M = Game.Objects['Bank'].minigame;`);\r\n\t\t/*stockMarket.goodTooltip = OmniCookies.replaceCode(stockMarket.goodTooltip, [\r\n\t\t\t{   // Shows the current total bought value on the tooltip\r\n\t\t\t\t// Disabled for now due to ugly text wrapping\r\n\t\t\t\tpattern: /me\\.name\\+' \\(worth <b>\\$'\\+Beautify\\(val\\*me\\.stock,2\\)\\+'<\\/b>/,\r\n\t\t\t\treplacement: `$&, bought for <b>$$'+Beautify(OmniCookies.saveData.stockAverages[id] ? OmniCookies.saveData.stockAverages[id].totalValue : 0, 2)+'</b>`\r\n\t\t\t}\r\n\t\t]), `var M = Game.Objects['Bank'].minigame;`;*/\r\n\t\tstockMarket.drawGraph = Util.replaceCode(stockMarket.drawGraph, [\r\n\t\t\t{   // Draw line for profit threshold\r\n\t\t\t\tpattern: /}$/,\r\n\t\t\t\treplacement: `\r\n\t\t\t\t\tif(OmniCookies.settings.stockValueData && M.hoverOnGood != -1) {\r\n\t\t\t\t\t\tlet me = M.goodsById[M.hoverOnGood];\r\n\t\t\t\t\t\tif(me.stock > 0 && OmniCookies.saveData.stockAverages[M.hoverOnGood]) {\r\n\t\t\t\t\t\t\tctx.strokeStyle='#00ff00'; // green\r\n\t\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\t\tlet lineHeight = Math.floor(height-OmniCookies.saveData.stockAverages[M.hoverOnGood].avgValue*M.graphScale)+0.5;\r\n\t\t\t\t\t\t\tctx.moveTo(width-1, lineHeight);\r\n\t\t\t\t\t\t\tctx.lineTo(width-span*rows-1, lineHeight);\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t$&`\r\n\t\t\t}\r\n\t\t], `var M = Game.Objects['Bank'].minigame;`);\r\n\t\tstockMarket.draw = Util.replaceCode(stockMarket.draw, [\r\n\t\t\t{   // Add a new display for the average bought value\r\n\t\t\t\tpattern: `//if (me.stock>0) me.stockL.style.color='#fff';`,\r\n\t\t\t\treplacement: `\r\n\t\t\t\t\tif(OmniCookies.settings.stockValueData) {\r\n\t\t\t\t\t\tif(!me.avgL) {\r\n\t\t\t\t\t\t\tlet avgSpan = document.createElement('span');\r\n\t\t\t\t\t\t\tavgSpan.id = 'bankGood-'+me.id+'-avg';\r\n\t\t\t\t\t\t\tavgSpan.innerHTML = '(-)';\r\n\t\t\t\t\t\t\tdocument.getElementById('bankGood-'+me.id+'-stockBox').appendChild(avgSpan);\r\n\t\t\t\t\t\t\tme.avgL = avgSpan;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(OmniCookies.saveData.stockAverages[me.id] && me.stock > 0) {\r\n\t\t\t\t\t\t\tme.avgL.style.visibility = 'visible';\r\n\t\t\t\t\t\t\tlet avg = OmniCookies.saveData.stockAverages[me.id];\r\n\t\t\t\t\t\t\tme.avgL.innerHTML = ' ($$'+Beautify(avg.avgValue,2)+')';\r\n\t\t\t\t\t\t\tif(avg.avgValue < me.val) {\r\n\t\t\t\t\t\t\t\tme.avgL.classList.remove('red');\r\n\t\t\t\t\t\t\t\tme.avgL.classList.add('green');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tme.avgL.classList.remove('green');\r\n\t\t\t\t\t\t\t\tme.avgL.classList.add('red');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tme.avgL.style.visibility = 'hidden';\r\n\t\t\t\t\t\t\tme.avgL.innerHTML = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif(me.avgL) {\r\n\t\t\t\t\t\t\tme.avgL.remove();\r\n\t\t\t\t\t\t\tme.avgL = undefined;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t$&`\r\n\t\t\t}\r\n\t\t], `var M = Game.Objects['Bank'].minigame;`);\r\n\t\tstockMarket.toRedraw = 1;\r\n\t});\r\n})\r\n\r\n/** Allows buildings to bypass the Fancy graphics setting */\r\nexport let fancyBuildings = new Patch(function() {\r\n\tGame.Draw = Util.replaceCode(Game.Draw, [\r\n\t\t{\r\n\t\t\tpattern: 'if (Game.prefs.animate && ((Game.prefs.fancy && Game.drawT%1==0)',\r\n\t\t\treplacement: 'if (Game.prefs.animate && ((((Game.prefs.fancy || OmniCookies.settings.buildingsBypassFancy == 0) && OmniCookies.settings.buildingsBypassFancy != 1) && Game.drawT%1==0)'\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Allows cursors to bypass the Fancy graphics setting */\r\nexport let fancyCursors = new Patch(function() {\r\n\tGame.DrawBackground = Util.replaceCode(Game.DrawBackground, [\r\n\t\t{\r\n\t\t\tpattern: /(var fancy=)(Game\\.prefs\\.fancy)(;)/,\r\n\t\t\treplacement: '$1($2 || OmniCookies.settings.cursorsBypassFancy == 0) && OmniCookies.settings.cursorsBypassFancy != 1$3'\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** Allows wrinklers to bypass the Fancy graphics setting */\r\nexport let fancyWrinklers = new Patch(function() {\r\n\t// Thanks Orteil -_-\r\n\t(window as any).inRect = function(x: number,y: number, rect: any): boolean {\r\n\t\t//find out if the point x,y is in the rotated rectangle rect{w,h,r,o} (width,height,rotation in radians,y-origin) (needs to be normalized)\r\n\t\t//I found this somewhere online I guess\r\n\t\tlet dx = x+Math.sin(-rect.r)*(-(rect.h/2-rect.o)),dy=y+Math.cos(-rect.r)*(-(rect.h/2-rect.o));\r\n\t\tlet h1 = Math.sqrt(dx*dx + dy*dy);\r\n\t\tlet currA = Math.atan2(dy,dx);\r\n\t\tlet newA = currA - rect.r;\r\n\t\tlet x2 = Math.cos(newA) * h1;\r\n\t\tlet y2 = Math.sin(newA) * h1;\r\n\t\tif (x2 > -0.5 * rect.w && x2 < 0.5 * rect.w && y2 > -0.5 * rect.h && y2 < 0.5 * rect.h) return true;\r\n\t\treturn false;\r\n\t};\r\n\r\n\tGame.UpdateWrinklers = Util.replaceCode(Game.UpdateWrinklers, [\r\n\t\t{\r\n\t\t\tpattern: /Game\\.prefs\\.fancy/g,\r\n\t\t\treplacement: `($& || OmniCookies.settings.wrinklersBypassFancy == 0) && OmniCookies.settings.wrinklersBypassFancy != 1`\r\n\t\t}\r\n\t]);\r\n})\r\n\r\n/** \r\n * Properly displays the (seemingly intended) feature of partial buying in bulk.\r\n * Also makes the ALL button worth ALL, not 1000\r\n * Also allows using the ALL button in buy mode.\r\n */\r\nexport let buySellBulk = new Patch(function() {\r\n\tlet rebuildPattern = [\r\n\t\t{\r\n\t\t\tpattern: `l('productPriceMult'+me.id).textContent=(Game.buyBulk>1)?('x'+Game.buyBulk+' '):'';`,\r\n\t\t\treplacement: `\r\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\r\n\t\t\t\t\tlet bulkAmount = -1;\r\n\t\t\t\t\tlet bulkPrice = -1;\r\n\t\t\t\t\tif(Game.buyMode == -1) {\r\n\t\t\t\t\t\tbulkAmount = (Game.buyBulk > -1) ? Math.min(Game.buyBulk, me.amount) : me.amount;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(me, Game.buyBulk);\r\n\t\t\t\t\t\tbulkAmount = bulk.maxAmount;\r\n\t\t\t\t\t\tbulkPrice = bulk.maxPrice;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tl('productPriceMult'+me.id).textContent = bulkAmount > 1 ? 'x' + bulkAmount + ' ' : '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$&\r\n\t\t\t\t}\r\n\t\t\t`\r\n\t\t}\r\n\t];\r\n\tlet refreshPattern = [\r\n\t\t{   // Set bulk buy price to maximum bulk price\r\n\t\t\tpattern: `if (Game.buyMode==1) this.bulkPrice=this.getSumPrice(Game.buyBulk);`,\r\n\t\t\treplacement: `if (Game.buyMode==1) {\r\n\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\r\n\t\t\t\t\tlet bulk = OmniCookies.Util.calcMaxBuyBulk(this,Game.buyBulk);\r\n\t\t\t\t\tthis.bulkPrice = bulk.maxPrice > 0 ? bulk.maxPrice : this.price;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.bulkPrice=this.getSumPrice(Game.buyBulk);\r\n\t\t\t\t}\r\n\t\t\t}`\r\n\t\t},\r\n\t\t{   // Sell ALL buildings, not only up to 1000\r\n\t\t\tpattern: `else if (Game.buyMode==-1 && Game.buyBulk==-1) this.bulkPrice=this.getReverseSumPrice(1000);`,\r\n\t\t\treplacement: `else if (Game.buyMode==-1 && Game.buyBulk==-1) this.bulkPrice=this.getReverseSumPrice(OmniCookies.settings.enhancedBulk ? this.amount : 1000);`\r\n\t\t}\r\n\t];\r\n\r\n\tfor(let i in Game.Objects) {\r\n\t\tlet building = Game.Objects[i];\r\n\r\n\t\tbuilding.rebuild = Util.replaceCode(building.rebuild, rebuildPattern);\r\n\t\tbuilding.refresh = Util.replaceCode(building.refresh, refreshPattern);\r\n\t}\r\n\r\n\tGame.Object = Util.replaceCode(Game.Object, rebuildPattern);\r\n\tGame.Object = Util.replaceCode(Game.Object, refreshPattern);\r\n\r\n\tGame.storeBulkButton = Util.replaceCode(Game.storeBulkButton, [\r\n\t\t{   // Allow using max button in buy mode\r\n\t\t\tpattern: `if (Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;`,\r\n\t\t\treplacement: `\r\n\t\t\t\tif(id == 0 || id == 1) {\r\n\t\t\t\t\tlet text = 'all';\r\n\t\t\t\t\tif(OmniCookies.settings.enhancedBulk) {\r\n\t\t\t\t\t\tif(Game.buyMode == -1) text = 'ALL';\r\n\t\t\t\t\t\telse text = 'MAX';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tl('storeBulkMax').textContent = text;\r\n\t\t\t\t}\r\n\t\t\t\tif (!OmniCookies.settings.enhancedBulk && Game.buyMode==1 && Game.buyBulk==-1) Game.buyBulk=100;`\r\n\t\t},\r\n\t\t{   // Max button is always visible\r\n\t\t\tpattern: `l('storeBulkMax').style.visibility='hidden';`,\r\n\t\t\treplacement: `if(!OmniCookies.settings.enhancedBulk) $&`\r\n\t\t}\r\n\t]);\r\n\r\n\tGame.Logic = Util.replaceCode(Game.Logic, [\r\n\t\t{   // Record the current shortcut\r\n\t\t\tpattern: `if (!Game.promptOn)`,\r\n\t\t\treplacement: `\r\n\t\t\t\tlet activeShortcut = (OmniCookies.Util.holdingButton(16)*2) | (OmniCookies.Util.holdingButton(17));\r\n\t\t\t$&`\r\n\t\t},\r\n\t\t{   // Always cause a setting update if there is a change in shortcut\r\n\t\t\tpattern: `if ((Game.keys[16] || Game.keys[17]) && !Game.buyBulkShortcut)`,\r\n\t\t\treplacement: `if (activeShortcut != OmniCookies.vars.prevShortcut && (OmniCookies.settings.enhancedBulk ? true : activeShortcut == 2 || activeShortcut == 1))`\r\n\t\t},\r\n\t\t{   // Only set Game.buyBulkOld when previously not holding either key\r\n\t\t\tpattern: `Game.buyBulkOld=Game.buyBulk;`,\r\n\t\t\treplacement: `if(OmniCookies.vars.prevShortcut == 0) Game.buyBulkOld=Game.buyBulk;`\r\n\t\t},\r\n\t\t{   // If holding both keys, switch to MAX/ALL\r\n\t\t\tpattern: `if (Game.keys[17]) Game.buyBulk=10;`,\r\n\t\t\treplacement: `$&\r\n\t\t\t\tif(activeShortcut == 3 && OmniCookies.settings.enhancedBulk) Game.buyBulk = -1;\r\n\t\t\t`\r\n\t\t},\r\n\t\t{   // Record state\r\n\t\t\tpattern: `//handle cookies`,\r\n\t\t\treplacement: `\r\n\t\t\t\tOmniCookies.vars.prevShortcut = activeShortcut;\r\n\t\t\t$&`\r\n\t\t}\r\n\t])\r\n\t\r\n\tupdateBulkAll();\r\n})\r\n\r\n/** Updates the bulk buy selection for when the option is toggled */\r\nexport let updateBulkAll = function() {\r\n\tif(Game.buyMode == 1) {\r\n\t\tif(Game.buyBulk == -1 && !settings.enhancedBulk) Game.storeBulkButton(4);\r\n\t\tl('storeBulkMax').style.visibility = settings.enhancedBulk ? 'visible' : 'hidden';\r\n\t}\r\n\tlet text = 'all';\r\n\tif(settings.enhancedBulk) {\r\n\t\tif(Game.buyMode == -1) text = 'ALL';\r\n\t\telse text = 'MAX';\r\n\t}\r\n\tl('storeBulkMax').textContent = text;\r\n\tGame.RefreshStore();\r\n}\r\n\r\n/** \r\n * Fix stock market to use established cookie manipulation options\r\n * You can now lose some of your earned cookies this way - or gain them!\r\n */ \r\nexport let dangerousStocks = new Patch(function() {\r\n\tUtil.onMinigameLoaded('Bank', function() {\r\n\t\tlet stockMarket = Game.Objects['Bank'].minigame;\r\n\t\tstockMarket.buyGood = Util.replaceCode(stockMarket.buyGood, [\r\n\t\t\t{   // Use Dissolve instead of Spend (to withhold cookies earned)\r\n\t\t\t\tpattern: `Game.Spend(cost*n);`,\r\n\t\t\t\treplacement: `\r\n\t\t\t\t\tif(OmniCookies.settings.dangerousStocks) {\r\n\t\t\t\t\t\tGame.Dissolve(cost*n);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$&\r\n\t\t\t\t\t}\r\n\t\t\t\t`\r\n\t\t\t}\r\n\t\t], `let M = Game.Objects['Bank'].minigame;`);\r\n\t\tstockMarket.sellGood = Util.replaceCode(stockMarket.sellGood, [\r\n\t\t\t{   // Start using Game.Earn again (to reinstate cookies earned)\r\n\t\t\t\tpattern: '//Game.Earn',\r\n\t\t\t\treplacement: `if(OmniCookies.settings.dangerousStocks) Game.Earn`\r\n\t\t\t},\r\n\t\t\t{   // Stop using direct setting\r\n\t\t\t\tpattern: /\\tGame\\.cookies/gm,\r\n\t\t\t\treplacement: `if(!OmniCookies.settings.dangerousStocks) $&`\r\n\t\t\t}\r\n\t\t], `let M = Game.Objects['Bank'].minigame;`);\r\n\t});\r\n})\r\n\r\n/** Adds a displayed value for each of Cyclius' cycles. */\r\nexport let cycliusInfo = new Patch(function() {\r\n\tUtil.onMinigameLoaded('Temple', function() {\r\n\t\tlet pantheon = Game.Objects['Temple'].minigame;\r\n\t\tlet functionPattern = [\r\n\t\t\t{   // Allow functions to be used as descriptions\r\n\t\t\t\tpattern: /\\+me\\.desc(\\w+)\\+/g,\r\n\t\t\t\treplacement: `+((typeof me.desc$1 == 'function') ? me.desc$1() : me.desc$1)+`\r\n\t\t\t}\r\n\t\t];\r\n\t\tpantheon.godTooltip = Util.replaceCode(pantheon.godTooltip, \r\n\t\t\tfunctionPattern, `let M = Game.Objects['Temple'].minigame;`);\r\n\t\tpantheon.slotTooltip = Util.replaceCode(pantheon.slotTooltip, \r\n\t\t\tfunctionPattern, `let M = Game.Objects['Temple'].minigame;`);\r\n\r\n\t\t// Display Cyclius values\r\n\t\tlet cycliusFunc = function(interval: number): () => string {\r\n\t\t\treturn function() {\r\n\t\t\t\tlet effect = '';\r\n\t\t\t\tif(settings.detailedCyclius) {\r\n\t\t\t\t\tlet mult = 0.15*Math.sin(Util.cycliusCalc(interval, settings.zonedCyclius)) * 100;\r\n\t\t\t\t\tlet color = mult > 0 ? 'green' : 'red';\r\n\t\t\t\t\tlet sign = mult > 0 ? '+' : '';\r\n\t\t\t\t\tlet num = Beautify(mult,2);\r\n\t\t\t\t\tif(num == \"0\") color = ''; // if Beautify gives 0\r\n\t\t\t\t\tif(mult < -0.1 && num == \"0\") color = 'red'; // if Beautify gives a bad 0\r\n\t\t\t\t\tif(mult < 0 && !num.includes('-')) num = '-' + num; // if Beautify forgets to give a -\r\n\t\t\t\t\teffect = `<div style=\"display:inline-block;text-align:right;width:50%;\" class=\"${color}\">${sign}${num}% base CpS.</div>`;\r\n\t\t\t\t}\r\n\t\t\t\treturn `<div style=\"display:inline-block;width:49%;\">Effect cycles over ${interval} hours.</div>${effect}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tinterface SpiritWithDescFunc {\r\n\t\t\tdesc1: string | (() => string)\r\n\t\t\tdesc2: string | (() => string)\r\n\t\t\tdesc3: string | (() => string)\r\n\t\t}\r\n\t\tlet cyclius = (pantheon.gods['ages'] as SpiritWithDescFunc);\r\n\t\ttoggleCyclius();\r\n\t\tcyclius.desc1 = cycliusFunc(3);\r\n\t\tcyclius.desc2 = cycliusFunc(12);\r\n\t\tcyclius.desc3 = cycliusFunc(24);\r\n\t});\r\n})\r\n\r\nexport let toggleCyclius = function() {\r\n\tlet pantheon = Game.Objects['Temple'].minigame;\r\n\tlet cyclius = (pantheon.gods['ages'] as any);\r\n\tif(cyclius.activeDescFunc) {\r\n\t\tcyclius.activeDescBackup = cyclius.activeDescFunc;\r\n\t\tcyclius.activeDescFunc = undefined; // I'm sorry\r\n\t} else {\r\n\t\tcyclius.activeDescFunc = cyclius.activeDescBackup;\r\n\t\tcyclius.activeDescBackup = undefined; // I'm really, really sorry\r\n\t}\r\n}\r\n\r\n/** Miscellaneous performance enhancements */\r\nexport let optiCookies = new Patch(function() {\r\n\t// fix forcing a store refresh every 5 draw frames if player has zero and non-zero switches\r\n\tGame.Draw = Util.replaceCode(Game.Draw, [\r\n\t\t{\r\n\t\t\tpattern: `if (price<lastPrice) Game.storeToRefresh=1;`,\r\n\t\t\treplacement: `if (price<lastPrice && price!=0) Game.upgradesToRebuild=1;`\r\n\t\t}\r\n\t]);\r\n\r\n\t// use fast calc instead of loop calc\r\n\tfor(let obj of Game.ObjectsById) {\r\n\t\tobj.getSumPrice=function(amount) {\r\n\t\t\treturn Util.quickCalcBulkPrice(this, amount);\r\n\t\t}\r\n\t\tobj.getReverseSumPrice=function(amount) {\r\n\t\t\treturn Util.quickCalcBulkPrice(this, amount, true);\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport let dangerousBrokers = new Patch(function() {\r\n\tUtil.onMinigameLoaded('Bank', function() {\r\n\t\tlet market = Game.Objects['Bank'].minigame;\r\n\t\tlet brokerButton = l('bankBrokersBuy');\r\n\t\tlet parent = brokerButton.parentElement;\r\n\r\n\t\tlet newButton = document.createElement('div');\r\n\t\tnewButton.classList.add('bankButton', 'bankButtonBuy', 'bankButtonOff');\r\n\t\tnewButton.id = 'bankBrokersBuy';\r\n\t\tnewButton.innerHTML = \"Hire\";\r\n\t\tnewButton.onclick = (e) => {\r\n\t\t\tif (market.brokers<market.getMaxBrokers() && Game.cookies>=market.getBrokerPrice()) {\r\n\t\t\t\tGame.Spend(market.getBrokerPrice());\r\n\t\t\t\tmarket.brokers+=1;\r\n\t\t\t\tif(settings.dangerousBrokers) market.profit-=1200;\r\n\t\t\t\tPlaySound('snd/cashIn2.mp3',0.6);\r\n\t\t\t\tGame.SparkleOn((e.target) as any);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbrokerButton.remove();\r\n\t\tparent.appendChild(newButton);\r\n\t})\r\n})","import * as Logger from './Logger'\r\n\r\nexport interface CodeReplacement {\r\n\treadonly pattern: string | RegExp\r\n\treadonly replacement: string\r\n}\r\n\r\nexport enum ButtonType {\r\n\tSHIFT = 16,\r\n\tCTRL = 17\r\n}\r\n\r\ninterface BuyBulkData {\r\n\t/** The total price of buying this many buildings */\r\n\treadonly totalPrice: number\r\n\r\n\t/** The maximum price that can be afforded by the player */\r\n\treadonly maxPrice: number\r\n\r\n\t/** The maximum amount of buildings that can be afforded by the player */\r\n\treadonly maxAmount: number\r\n}\r\n\r\n/** \r\n * Used for replace-patching functions.  \r\n * Replacements are applied in order.  \r\n * Logs a warning if any of them fail, but does not abort the process.\r\n * \r\n * @param {Function} targetFunction Function to patch\r\n * @param {CodeReplacement[]} listReplacements Replacements to apply\r\n * @param {string} preEvalScript Code to run before evaluating the result\r\n * @returns {Function} The new, edited function\r\n */\r\nexport function replaceCode<T extends Function>(targetFunction: T, listReplacements: CodeReplacement[], preEvalScript?: string): T {\r\n\tlet code = targetFunction.toString();\r\n\tlet newCode = code;\r\n\tfor(let i in listReplacements) {\r\n\t\tlet patt = listReplacements[i].pattern;\r\n\t\tlet repl = listReplacements[i].replacement;\r\n\t\tif((typeof patt == 'string' && !newCode.includes(patt)) \r\n\t\t\t|| (typeof patt == 'object' && !newCode.match(patt))) {\r\n\t\t\tLogger.warn(`Replacement pattern '${patt}' not found`);\r\n\t\t}\r\n\t\tnewCode = newCode.replace(patt, repl);\r\n\t}\r\n\tlet func: T;\r\n\teval((preEvalScript ? preEvalScript : '') + 'func = ' + newCode);\r\n\treturn func;\r\n}\r\n\r\n/**\r\n * Calculates the price and maximum buildings that can be bought from buying in bulk\r\n * \r\n * @param {Game.Object} building Building to buy\r\n * @param {number} amount Number of buildings to buy\r\n * @returns {BuyBulkData} Total and maximum affordable price and number of buildings\r\n */\r\nexport function calcMaxBuyBulk(building: Game.Object, amount: number): BuyBulkData {\r\n\tlet totalPrice = 0;\r\n\tlet maxPrice = 0;\r\n\tlet maxAmount = 0;\r\n\tif(amount == -1) amount = Infinity;\r\n\r\n\t// if you have infinity, you can get infinity. yep\r\n\t// will you have infinity? if you're cheating maybe lol\r\n\t// oh but please don't do this while the vanilla game still uses for loops\r\n\t// you'll just crash anyways\r\n\tif(Game.cookies == Infinity && amount == Infinity) {\r\n\t\treturn { totalPrice: Infinity, maxPrice: Infinity, maxAmount: amount };\r\n\t}\r\n\t\r\n\ttotalPrice = quickCalcBulkPrice(building, amount);\r\n\tmaxAmount = Math.min(amount, quickCalcMaxBuy(building) + building.free);\r\n\tmaxPrice = quickCalcBulkPrice(building, maxAmount);\r\n\t\r\n\treturn { totalPrice: totalPrice, maxPrice: maxPrice, maxAmount: maxAmount };\r\n}\r\n\r\n/**\r\n * Calculates the maximum number of buildings that can be currently bought in O(1) time.\r\n * Thanks to staticvariablejames on the Discord server!\r\n * @param {Game.Object} building Game.Object to calculate maximum buy count of\r\n * @returns {number} Maximum number of this building that can be bought\r\n */\r\nexport function quickCalcMaxBuy(building: Game.Object): number {\r\n\tlet cookies = Game.cookies;\r\n\tcookies /= Game.modifyBuildingPrice(building.name, building.basePrice);\r\n\tlet boughtCount = building.amount - building.free;\r\n\tlet priceInc = Game.priceIncrease;\r\n\treturn Math.floor(Math.log(priceInc**boughtCount + (priceInc - 1)*cookies)/Math.log(priceInc) - building.amount);\r\n}\r\n\r\n/**\r\n * Calculates the price of buying buildings in O(1) time.\r\n * Starts from the current number of buildings.\r\n * @param {Game.Object} building Building to calculate price of\r\n * @param {number} bulk Number of buildings to buy\r\n * @param {boolean} sell Whether to instead calculate selling the buildings\r\n * @returns {number} Amount of cookies this many buildings is worth\r\n */\r\nexport function quickCalcBulkPrice(building: Game.Object, bulk: number, sell?: boolean): number {\r\n\tlet buildingCount = Math.max(0, building.amount - building.free);\r\n\tlet sum: number;\r\n\tif(sell) {\r\n\t\tif(buildingCount <= 0) return 0;\r\n\t\tbuildingCount--;\r\n\t\tsum = powerSumRange(Game.priceIncrease, Math.max(0, buildingCount-bulk), buildingCount);\r\n\t} else {\r\n\t\tsum = powerSumRange(Game.priceIncrease, buildingCount, buildingCount + bulk-1);\r\n\t}\r\n\tsum = Game.modifyBuildingPrice(building.name, sum*building.basePrice);\r\n\tif(sell) sum *= building.getSellMultiplier();\r\n\treturn Math.ceil(sum);\r\n}\r\n\r\n/**\r\n * \r\n * @param {number} x Base\r\n * @param {number} start Starting exponent\r\n * @param {number} end Ending exponent\r\n * @returns {number} Sum of exponents x^start to x^end, inclusive\r\n */\r\nexport function powerSumRange(x: number, start: number, end: number): number {\r\n\tif(x < 0) return -1;           // please don't\r\n\tif(x == 0) return 0;           // obviously\r\n\tif(x == 1) return end - start; // come on man\r\n\tif(start == end) return x**start; // really, this is getting old\r\n\t\r\n\tlet sum1 = (x**(start) - 1)/(x - 1); // sum from 0 to start-1\r\n\tlet sum2 = (x**(end+1) - 1)/(x - 1);   // sum from 0 to end\r\n\treturn sum2 - sum1; // sum from start to end\r\n}\r\n\r\n/**\r\n * Returns the progress of a cycle, starting from Jan 1, 1970, 00:00:00, UTC time.\r\n * @param {number} interval Length of cycle in hours\r\n * @param {boolean} zoned Whether to offset the cycle as though it were GMT+1 time\r\n * @returns {number} Rotation of current cycle in radians\r\n */\r\nexport function cycliusCalc(interval: number, zoned?: boolean): number {\r\n\tlet cycle = (Date.now()/1000/(60*60*interval));\r\n\tif(zoned) {\r\n\t\tcycle += (new Date().getTimezoneOffset() + 60)/60/interval\r\n\t}\r\n\tcycle %= 1;\r\n\treturn cycle*Math.PI*2;\r\n}\r\n\r\n/**\r\n * Loads data from an object into another object.\r\n * @param {object} data Data to be loaded from\r\n * @param {object} into Object to load data into\r\n */\r\nexport function loadData(data: object, into: object): void {\r\n\tif(data) {\r\n\t\tfor(let key of Object.keys(data)) {\r\n\t\t\tif(key in into) {\r\n\t\t\t\t// convert from old boolean buttons to new optioned buttons\r\n\t\t\t\t// for these buttons in particular, 0 was \"on\" and 2 is now \"off\"\r\n\t\t\t\tif(typeof data[key] == 'boolean' && typeof into[key] == 'number') {\r\n\t\t\t\t\tdata[key] = data[key] ? 0 : 2;\r\n\t\t\t\t}\r\n\t\t\t\tinto[key] = data[key];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Switches the milk selector's icon to the given milk type\r\n * @param {number} milkID\r\n */\r\nexport function switchMilkIcon(milkID: number): void {\r\n\tlet milkSelect = Game.Upgrades['Milk selector'] as Game.SelectorSwitch;\r\n\tif(milkID == 0) milkSelect.icon = Game.Milk.icon;\r\n\telse milkSelect.icon = milkSelect.choicesFunction()[milkID].icon;\r\n\tGame.upgradesToRebuild = 1;\r\n}\r\n\r\n/**\r\n * Gets the number of grandmas from this building's synergy upgrade.\r\n * @param {Game.Object} building \r\n * @returns {number} Number of synergy grandmas\r\n */\r\nexport function getNumSynergyGrandmas(building: Game.Object): number {\r\n\tif(building.grandma && building.grandma.bought) {\r\n\t\treturn Math.floor(Game.Objects['Grandma'].amount / (building.id - 1));\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\n/**\r\n * Instantly applies the given amount of passive CpS.\r\n * This includes updating wrinkler bellies and building stats.\r\n * Used by the revamped Cursed Finger.\r\n * @param {number} seconds \r\n */\r\nexport function gainInstantPassiveCpS(seconds: number): void {\r\n\tlet cookies = Game.cookiesPs * seconds;\r\n\r\n\t// Suck the cookies\r\n\tfor(let wrinkler of Game.wrinklers) {\r\n\t\tif(wrinkler.phase == 2) {\r\n\t\t\twrinkler.sucked += cookies * Game.cpsSucked;\r\n\t\t\tGame.cookiesSucked += cookies * Game.cpsSucked;\r\n\t\t}\r\n\t}\r\n\tcookies *= 1 - Game.cpsSucked;\r\n\r\n\t// Update building total cookies baked stats\r\n\tfor (let obj of Game.ObjectsById) {\r\n\t\tobj.totalCookies += obj.storedTotalCps * Game.globalCpsMult * seconds;\r\n\t}\r\n\r\n\tGame.Earn(cookies);\r\n}\r\n\r\n/**\r\n * Changes the overflowY styling of the center scrollbar\r\n * @param style overflowY styling to use\r\n */\r\nexport function scrollbarStyle(style: string) {\r\n\tvar center = document.getElementById('centerArea');\r\n\tcenter.style.overflowY = style;\r\n}\r\n\r\n/** \r\n * Performs the given function when the given building's minigame has loaded \r\n * @param obj Name of building\r\n * @param func Function to run\r\n */\r\nexport function onMinigameLoaded(obj: string, func: () => void) {\r\n\tlet interval = setInterval(function() {\r\n\t\tif(Game.Objects[obj].minigameLoaded) {\r\n\t\t\tfunc();\r\n\t\t\tclearInterval(interval);\r\n\t\t}\r\n\t}, 250);\r\n}\r\n\r\n/**\r\n * Queues loading of a custom image asset\r\n * @param img URL of image to load\r\n */\r\nexport function loadCustomAsset(img: string) {\r\n\tif(!Game.Loader.assetsLoading[img] && !Game.Loader.assetsLoaded[img]) {\r\n\t\tGame.Loader.assets[img] = ({} as any);\r\n\t\tGame.Loader.Replace(img, img);\r\n\t\tGame.Loader.assetsLoading.push(img);\r\n\t}\r\n}\r\n\r\n/** Returns whether the given button is being held */\r\nexport function holdingButton(btn: ButtonType): number {\r\n\treturn Game.keys[btn] == undefined ? 0 : Game.keys[btn];\r\n}","import { name } from \"./Vars\"\n\nexport function log(message: any) {\n\tconsole.log(`[${name}] ${message}`)\n}\nexport function warn(message: any) {\n\tconsole.warn(`[${name}] ${message}`)\n}\nexport function error(message: any) {\n\tconsole.error(`[${name}] ${message}`)\n}","import { settings } from './Settings'\r\nimport { name, vars, version } from './Vars'\r\nimport * as Util from './Util'\r\nimport * as Patches from './Patches'\r\n\r\ninterface ButtonOption {\r\n\t/** Text to display while this option is selected */\r\n\ttext: string\r\n\r\n\t/** Function to run when this option is selected */\r\n\tfunc?: () => void\r\n\r\n\t/** Whether this option should display as \"off\" */\r\n\toff?: boolean\r\n}\r\n\r\ninterface ConfigElement {\r\n\tdisplay: () => HTMLElement\r\n}\r\n\r\nclass OptionedButton implements ConfigElement {\r\n\tsettingName: string\r\n\toptions: ButtonOption[]\r\n\tdesc: string\r\n\tconstructor(settingName: string, options: ButtonOption[], desc: string) {\r\n\t\tthis.settingName = settingName;\r\n\t\tthis.options = options;\r\n\t\tthis.desc = desc;\r\n\t}\r\n\tdisplay(): HTMLDivElement {\r\n\t\tlet div = document.createElement('div');\r\n\t\r\n\t\tlet set = Number(settings[this.settingName]);\r\n\t\tlet selected = this.options[set];\r\n\t\tlet buttonId = \"OmniCookiesButton_\" + this.settingName;\r\n\t\tlet a = document.createElement('a');\r\n\t\ta.id = buttonId;\r\n\t\ta.className = 'option' + (selected.off ? ' off' : '');\r\n\r\n\t\tlet sett = this.settingName;\r\n\t\tlet opt = this.options;\r\n\t\ta.onclick = this.toggleFunction(buttonId, sett, opt);\r\n\t\ta.textContent = selected.text;\r\n\t\tdiv.appendChild(a);\r\n\r\n\t\tlet label = document.createElement('label');\r\n\t\tlabel.textContent = this.desc;\r\n\t\tdiv.appendChild(label);\r\n\r\n\t\treturn div;\r\n\t}\r\n\r\n\ttoggleFunction(buttonId: string, settingName: string, options: ButtonOption[]): () => void {\r\n\t\treturn () => {\r\n\t\t\tsettings[settingName]++;\r\n\t\t\tif(settings[settingName] >= options.length) settings[settingName] = 0;\r\n\t\t\tlet element = document.getElementById(buttonId);\r\n\t\t\tlet selected = options[settings[settingName]];\r\n\t\t\tif(selected.off) element.classList.add('off');\r\n\t\t\telse element.classList.remove('off');\r\n\t\t\tif(selected.func) selected.func();\r\n\t\t\telement.innerHTML = selected.text;\r\n\t\t\tPlaySound('snd/tick.mp3');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass BooleanButton extends OptionedButton {\r\n\tsettingName: string\r\n\tonOption: ButtonOption\r\n\toffOption: ButtonOption\r\n\tdesc: string\r\n\tconstructor(settingName: string, onOption: ButtonOption, offOption: ButtonOption, desc: string) {\r\n\t\tsuper(settingName, [offOption, onOption], desc);\r\n\t\tthis.onOption = onOption;\r\n\t\tthis.offOption = offOption;\r\n\t\toffOption.off = true;\r\n\t}\r\n}\r\n\r\nclass Header implements ConfigElement {\r\n\ttext: string\r\n\tconstructor(text: string) {\r\n\t\tthis.text = text;\r\n\t}\r\n\tdisplay(): HTMLDivElement {\r\n\t\tvar div = document.createElement('div');\r\n\t\tdiv.className = 'listing';\r\n\t\tdiv.style.padding = '5px 16px';\r\n\t\tdiv.style.opacity = '0.7';\r\n\t\tdiv.style.fontSize = '17px';\r\n\t\tdiv.style.fontFamily = '\\\"Kavoon\\\", Georgia, serif';\r\n\t\tdiv.appendChild(document.createTextNode(this.text));\r\n\t\treturn div;\r\n\t}\r\n}\r\n\r\nclass Title implements ConfigElement {\r\n\ttext: string\r\n\tconstructor(text: string) {\r\n\t\tthis.text = text;\r\n\t}\r\n\tdisplay(): HTMLDivElement {\r\n\t\tlet title = document.createElement('div');\r\n\t\ttitle.className = 'title';\r\n\t\ttitle.textContent = this.text;\r\n\t\treturn title;\r\n\t}\r\n}\r\n\r\nclass Listing implements ConfigElement {\r\n\telements: ConfigElement[]\r\n\tconstructor(elements: ConfigElement[]) {\r\n\t\tthis.elements = elements;\r\n\t}\r\n\tdisplay(): HTMLDivElement {\r\n\t\tlet div = document.createElement('div');\r\n\t\tdiv.className = 'listing';\r\n\t\tfor(let element of this.elements) {\r\n\t\t\tdiv.appendChild(element.display());\r\n\t\t}\r\n\t\treturn div;\r\n\t}\r\n}\r\n\r\nclass ConfigMenu {\r\n\telements: ConfigElement[]\r\n\tconstructor(elements: ConfigElement[]) {\r\n\t\tthis.elements = elements;\r\n\t}\r\n\tdisplay(): DocumentFragment {\r\n\t\tlet frag = document.createDocumentFragment();\r\n\t\tfor(let element of this.elements) {\r\n\t\t\tfrag.appendChild(element.display());\r\n\t\t}\r\n\t\treturn frag;\r\n\t}\r\n}\r\n\r\nlet menuDisplay = new ConfigMenu([\r\n\tnew Title(`${name} ${version}`),\r\n\tnew Header(\"Graphical tweaks\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('autoScrollbar', \r\n\t\t\t{ text: 'Autohide center scrollbar ON', func: () => Util.scrollbarStyle('auto') },\r\n\t\t\t{ text: 'Autohide center scrollbar OFF', func: () => Util.scrollbarStyle('scroll') },\r\n\t\t\t'(the scrollbar in the center view will hide itself when appropriate)'\r\n\t\t),\r\n\t\tnew BooleanButton('scrollingBuildings',\r\n\t\t\t{ text: 'Scroll buildings ON' },\r\n\t\t\t{ text: 'Scroll buildings OFF' },\r\n\t\t\t'(hovering over the left/right edges of buildings produces a scroll effect)'\r\n\t\t),\r\n\t\tnew BooleanButton('smoothBuildings',\r\n\t\t\t{ text: 'Smooth buildings ON' },\r\n\t\t\t{ text: 'Smooth buildings OFF' },\r\n\t\t\t'(buildings draw every frame, instead of every 3 frames)'\r\n\t\t),\r\n\t\tnew BooleanButton('betterBuildingTooltips',\r\n\t\t\t{ text: 'Improved building tooltips ON', func: () => Patches.buildingTooltips.apply() },\r\n\t\t\t{ text: 'Improved building tooltips OFF' },\r\n\t\t\t'(building tooltips in the shop look a little better)'\r\n\t\t),\r\n\t\tnew BooleanButton('betterGrandmas',\r\n\t\t\t{ text: 'Grandma fixes ON', func: () => Patches.miscGrandmaFixes.apply() },\r\n\t\t\t{ text: 'Grandma fixes OFf' },\r\n\t\t\t'(text and ordering fixes for grandma synergy upgrades; disabling requires refresh)'\r\n\t\t),\r\n\t\tnew BooleanButton('bringGrandmaToWork',\r\n\t\t\t{ text: 'Bring grandma to work day ON' },\r\n\t\t\t{ text: 'Bring grandma to work day OFF' },\r\n\t\t\t'(synergy grandmas make an appearance in their respective building views)'\r\n\t\t),\r\n\t\tnew BooleanButton('separateTechs',\r\n\t\t\t{ text: 'Separate techs ON', func: () => Patches.statsUpgradeCategories.apply() },\r\n\t\t\t{ text: 'Separate techs OFF' },\r\n\t\t\t'(gives tech upgrades their own upgrade category under cookies)'\r\n\t\t),\r\n\t\tnew BooleanButton('separateSeasons',\r\n\t\t\t{ text: 'Separate seasons ON', func: () => Patches.statsUpgradeCategories.apply() },\r\n\t\t\t{ text: 'Separate seasons OFF' },\r\n\t\t\t'(gives seasonal upgrades their own upgrade category under cookies)'\r\n\t\t),\r\n\t\tnew BooleanButton('displaySeasons',\r\n\t\t\t{ text: 'Display seasonal sources ON', func: () => Patches.displaySeasonUnlock.apply() },\r\n\t\t\t{ text: 'Display seasonal sources OFF' },\r\n\t\t\t'(shows source season in upgrade tooltips)'\r\n\t\t),\r\n\t\tnew BooleanButton('fancyMilkSelect',\r\n\t\t\t{ text: 'Fancy milk select ON' },\r\n\t\t\t{ \r\n\t\t\t\ttext: 'Fancy milk select OFF',\r\n\t\t\t\tfunc: () => {\r\n\t\t\t\t\tUtil.switchMilkIcon(1);\r\n\t\t\t\t\tvars.lastMilk = -1;\r\n\t\t\t\t\tvars.lastAutoMilk = -1;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'(milk selector icon changes with selected milk)'\r\n\t\t),\r\n\t\tnew BooleanButton('tooltipWobble',\r\n\t\t\t{ text: 'Tooltip wobble ON' },\r\n\t\t\t{ text: 'Tooltip wobble OFF', func: () => (Game.tooltip as any).tt.className = 'framed' },\r\n\t\t\t'(enables the tooltip wobble animation)'\r\n\t\t),\r\n\t\tnew BooleanButton('improveAscendMeter',\r\n\t\t\t{ text: 'Fancy ascend meter ON' },\r\n\t\t\t{\r\n\t\t\t\ttext: 'Fancy ascend meter OFF', \r\n\t\t\t\tfunc: () => (Game.ascendMeter as HTMLElement).style.removeProperty('width') \r\n\t\t\t},\r\n\t\t\t'(meter and number total update faster and smoother)'\r\n\t\t),\r\n\t\tnew OptionedButton('buildingsBypassFancy',\r\n\t\t\t[\r\n\t\t\t\t{ text: 'Buildings always FANCY' },\r\n\t\t\t\t{ text: 'Buildings always FAST' },\r\n\t\t\t\t{ text: 'Buildings always DEFAULT', off: true }\r\n\t\t\t],\r\n\t\t\t'(buildings follow this setting rather than default)'\r\n\t\t),\r\n\t\tnew OptionedButton('cursorsBypassFancy',\r\n\t\t\t[\r\n\t\t\t\t{ text: 'Cursors always FANCY' },\r\n\t\t\t\t{ text: 'Cursors always FAST' },\r\n\t\t\t\t{ text: 'Cursors always DEFAULT', off: true }\r\n\t\t\t],\r\n\t\t\t'(cursors follow this setting rather than default)'\r\n\t\t),\r\n\t\tnew OptionedButton('wrinklersBypassFancy',\r\n\t\t\t[\r\n\t\t\t\t{ text: 'Wrinklers always FANCY' },\r\n\t\t\t\t{ text: 'Wrinklers always FAST' },\r\n\t\t\t\t{ text: 'Wrinklers always DEFAULT', off: true }\r\n\t\t\t],\r\n\t\t\t'(wrinklers follow this setting rather than default)'\r\n\t\t)\r\n\t]),\r\n\tnew Header(\"Quality of Life\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('enhancedBulk',\r\n\t\t\t{ text: 'Enhanced bulk ON', func: () => Patches.updateBulkAll() },\r\n\t\t\t{ text: 'Enhanced bulk OFF', func: () => Patches.updateBulkAll() },\r\n\t\t\t'(allows partial and maximum bulk purchases)'\r\n\t\t),\r\n\t\tnew BooleanButton('buffTooltipDuration',\r\n\t\t\t{ text: 'Show buff duration in tooltip ON' }, \r\n\t\t\t{ text: 'Show buff duration in tooltip OFF' },\r\n\t\t\t'(buffs will show their current duration in their tooltip)'\r\n\t\t)\r\n\t]),\r\n\tnew Header(\"Stock Market\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('stockValueData',\r\n\t\t\t{ text: 'Stock value data ON' },\r\n\t\t\t{ text: 'Stock value data OFF' },\r\n\t\t\t'(displays information about how profitable your stocks are)'\r\n\t\t),\r\n\t\tnew BooleanButton('dangerousStocks',\r\n\t\t\t{ text: 'Dangerous stocks ON' },\r\n\t\t\t{ text: 'Dangerous stocks OFF' },\r\n\t\t\t'(stock market affects total cookies earned)'\r\n\t\t),\r\n\t\tnew BooleanButton('dangerousBrokers',\r\n\t\t\t{ text: 'Dangerous brokers ON', func: () => Patches.dangerousBrokers.apply() },\r\n\t\t\t{ text: 'Dangerous brokers OFF' },\r\n\t\t\t'(hiring brokers reduces your Stock Market profits)'\r\n\t\t)\r\n\t]),\r\n\tnew Header(\"Pantheon\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('detailedCyclius',\r\n\t\t\t{ text: 'Cyclius details ON', func: () => Patches.toggleCyclius() },\r\n\t\t\t{ text: 'Cyclius details OFF', func: () => Patches.toggleCyclius() },\r\n\t\t\t'(shows Cyclius\\' current cycles in his tooltip)'\r\n\t\t),\r\n\t\tnew BooleanButton('zonedCyclius',\r\n\t\t\t{ text: 'Zoned Cyclius ON', func: () => Game.recalculateGains = 1 },\r\n\t\t\t{ text: 'Zoned Cyclius OFF', func: () => Game.recalculateGains = 1 },\r\n\t\t\t'(offsets Cyclius based on your time zone, towards GMT+1)'\r\n\t\t),\r\n\t\tnew BooleanButton('trueCyclius',\r\n\t\t\t{ text: 'True Cyclius ON' },\r\n\t\t\t{ text: 'True Cyclius OFF' },\r\n\t\t\t'(cosmetic; Cyclius shows off his power with style)'\r\n\t\t),\r\n\t\tnew BooleanButton('skruuiaRebalance',\r\n\t\t\t{ text: 'Skruuia rebalance ON' },\r\n\t\t\t{ text: 'Skruuia rebalance OFF' },\r\n\t\t\t'(Skruuia\\'s bonus applies to wrinkler suck rate rather than wrinkler pop multiplier)'\r\n\t\t)\r\n\t]),\r\n\tnew Header(\"Grimoire\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('improveMagicMeter',\r\n\t\t\t{ text: 'Improved magic meter ON' },\r\n\t\t\t{ text: 'Improved magic meter OFF' },\r\n\t\t\t'(slight improvements to the magic meter; disabling requires refresh)'\r\n\t\t)\r\n\t]),\r\n\tnew Header(\"Experimental\"),\r\n\tnew Listing([\r\n\t\tnew BooleanButton('optimizeBuildings',\r\n\t\t\t{ text: 'Buildings draw smart ON' },\r\n\t\t\t{ text: 'Buildings draw smart OFF' },\r\n\t\t\t'(experimental; buildings attempt to skip unnecessary draw frames)'\r\n\t\t),\r\n\t\tnew BooleanButton('preserveWrinklers',\r\n\t\t\t{ text: 'Preserve wrinklers ON' },\r\n\t\t\t{ text: 'Preserve wrinklers OFF' },\r\n\t\t\t'(experimental; attempts to preserve all wrinkler data on game save/load)'\r\n\t\t),\r\n\t\tnew BooleanButton('cursedFinger',\r\n\t\t\t{ text: 'Cursed Finger tweaks ON', func: () => Patches.cursedFingerTweaks.apply() },\r\n\t\t\t{ text: 'Cursed Finger tweaks OFF', func: () => Patches.cursedFingerTweaks.remove() },\r\n\t\t\t'(experimental; CF does not snapshot and counts as real passive CpS)'\r\n\t\t),\r\n\t\tnew BooleanButton('optiCookies',\r\n\t\t\t{ text: 'OptiCookies ON', func: () => Patches.optiCookies.apply() },\r\n\t\t\t{ text: 'OptiCookies OFF' },\r\n\t\t\t'(experimental; a couple of small performance tweaks; disabling requires refresh)'\r\n\t\t)\r\n\t])\r\n])\r\n\r\nexport function customOptionsMenu(): void {\r\n\tif(!(Game.onMenu == 'prefs')) return;\r\n\r\n\tlet frag = menuDisplay.display();\r\n\r\n\tl('menu').childNodes[2].insertBefore(frag, l('menu').childNodes[2].childNodes[l('menu').childNodes[2].childNodes.length - 1]);\r\n}","export let name = 'Omniscient Cookies'\r\nexport let version = 'v2.0.0'\r\n\r\ninterface Vars {\r\n\tlastMilk: number\r\n\tlastAutoMilk: any\r\n\tbuffsById: Game.Buff[]\r\n\tcursedPs: number\r\n\tcursedPsMult: number\r\n\tascendMeterLevel: number\r\n\tascendMeterPercent: number\r\n\tlevelDiff: number\r\n\tpatchedTrueCyclius: boolean\r\n\tprevShortcut: 0 | 1 | 2 | 3\r\n\tGetBuffTooltipFunc?: Function\r\n}\r\n\r\nexport let vars: Vars = {\r\n\tlastMilk: -1,\r\n\tlastAutoMilk: undefined,\r\n\tbuffsById: [],\r\n\tcursedPs: 0,\r\n\tcursedPsMult: 0,\r\n\tascendMeterLevel: undefined,\r\n\tascendMeterPercent: undefined,\r\n\tlevelDiff: 0,\r\n\tpatchedTrueCyclius: false,\r\n\tprevShortcut: 0\r\n}","import { version } from \"./Vars\";\r\nimport { loadData } from \"./Util\";\r\n\r\nexport enum BypassFancySetting {\r\n\tDefault = 0, Fast = 1, Fancy = 2\r\n}\r\n\r\nclass Settings {\r\n\t/** Current Omniscient Cookies version */\r\n\tversion: string;\r\n\r\n\t/** Whether the scrollbar will automatically hide itself */\r\n\tautoScrollbar: boolean;\r\n\r\n\t/** Whether buildings will scroll when hovering over the outer 100px */\r\n\tscrollingBuildings: boolean;\r\n\r\n\t/** Whether buildings will draw every frame (instead of every 3 frames) */\r\n\tsmoothBuildings: boolean;\r\n\r\n\t/** Whether to show buff duration in buff tooltips */\r\n\tbuffTooltipDuration: boolean;\r\n\r\n\t/** Whether to improve building tooltips */\r\n\tbetterBuildingTooltips: boolean;\r\n\r\n\t/** Whether to fix various grandma-related nitpicks */\r\n\tbetterGrandmas: boolean;\r\n\r\n\t/** Whether to give tech upgrades their own stats category */\r\n\tseparateTechs: boolean;\r\n\r\n\t/** Whether to enhance the bulk buy/sell experience */\r\n\tenhancedBulk: boolean;\r\n\r\n\t/** How buildings will override the Fancy setting */\r\n\tbuildingsBypassFancy: BypassFancySetting\r\n\r\n\t/** How cursors will override the Fancy setting */\r\n\tcursorsBypassFancy: BypassFancySetting\r\n\r\n\t/** How wrinklers will override the Fancy setting */\r\n\twrinklersBypassFancy: BypassFancySetting\r\n\r\n\t/** Whether buildings will attempt to skip unnecessary frames */\r\n\toptimizeBuildings: boolean\r\n\r\n\t/** Whether to attempt to restore wrinklers to exact specifications */\r\n\tpreserveWrinklers: boolean\r\n\r\n\t/** Whether to show Cyclius' cycles in his tooltip */\r\n\tdetailedCyclius: boolean\r\n\r\n\t/** Whether to offset Cyclius as though it were always GMT+1 time */\r\n\tzonedCyclius: boolean\r\n\r\n\t/** Whether to make Cyclius' sprite rotate with his cycles */\r\n\ttrueCyclius: boolean\r\n\r\n\t/** Whether to display information about average bought stock values */\r\n\tstockValueData: boolean\r\n\r\n\t/** Whether buying or selling on the stock market will affect total cookies baked */\r\n\tdangerousStocks: boolean\r\n\r\n\t/** Whether to use the tooltip wobble animation */\r\n\ttooltipWobble: boolean\r\n\r\n\t/** Whether the milk selector's icon will reflect the current milk */\r\n\tfancyMilkSelect: boolean\r\n\r\n\t/** Whether to apply slight graphical improvements to the Grimoire's magic meter */\r\n\timproveMagicMeter: boolean\r\n\r\n\t/** Whether Skruuia's bonus should affect wrinkler suck rate rather than wrinkler pop multiplier */\r\n\tskruuiaRebalance: boolean\r\n\r\n\t/** Whether to apply a graphical overhaul to the ascend meter */\r\n\timproveAscendMeter: boolean\r\n\r\n\t/** Whether to display seasonal requirements on related upgrades */\r\n\tdisplaySeasons: boolean\r\n\r\n\t/** Whether to give seasonal upgrades their own stats category */\r\n\tseparateSeasons: boolean\r\n\r\n\t/** Whether to show grandmas at work */\r\n\tbringGrandmaToWork: boolean\r\n\r\n\t/**\r\n\t * Whether to rework Cursed Finger to:\r\n\t * - Not snapshot\r\n\t * - Count as true passive CpS\r\n\t */\r\n\tcursedFinger: boolean\r\n\r\n\t/** Whether to apply experimental performance enhancements */\r\n\toptiCookies: boolean\r\n\r\n\t/** Whether to make stock brokers decrease Stock Market profits */\r\n\tdangerousBrokers: boolean\r\n\r\n\t/** Initializes to the default settings */\r\n\tconstructor() {\r\n\t\tthis.version = version;\r\n\t\tthis.autoScrollbar = true;\r\n\t\tthis.scrollingBuildings = true;\r\n\t\tthis.smoothBuildings = true;\r\n\t\tthis.buffTooltipDuration = true;\r\n\t\tthis.betterBuildingTooltips = true;\r\n\t\tthis.betterGrandmas = true;\r\n\t\tthis.separateTechs = true;\r\n\t\tthis.enhancedBulk = true;\r\n\t\tthis.buildingsBypassFancy = BypassFancySetting.Default;\r\n\t\tthis.cursorsBypassFancy = BypassFancySetting.Default;\r\n\t\tthis.wrinklersBypassFancy = BypassFancySetting.Default;\r\n\t\tthis.optimizeBuildings = false;\r\n\t\tthis.preserveWrinklers = false;\r\n\t\tthis.detailedCyclius = true;\r\n\t\tthis.zonedCyclius = false;\r\n\t\tthis.trueCyclius = false;\r\n\t\tthis.stockValueData = true;\r\n\t\tthis.dangerousStocks = false;\r\n\t\tthis.tooltipWobble = false;\r\n\t\tthis.fancyMilkSelect = true;\r\n\t\tthis.improveMagicMeter = true;\r\n\t\tthis.skruuiaRebalance = false;\r\n\t\tthis.improveAscendMeter = true;\r\n\t\tthis.displaySeasons = true;\r\n\t\tthis.separateSeasons = false;\r\n\t\tthis.bringGrandmaToWork = true;\r\n\t\tthis.cursedFinger = false;\r\n\t\tthis.optiCookies = false;\r\n\t\tthis.dangerousBrokers = false;\r\n\t}\r\n\r\n\tset(setting: string, value: any) {\r\n\t\tif(typeof value == typeof this[setting]) this[setting] = value;\r\n\t}\r\n\r\n\tget(setting: string) {\r\n\t\treturn this[setting];\r\n\t}\r\n\r\n\tsave() {\r\n\t\treturn this;\r\n\t}\r\n\r\n\tload(obj: Settings) {\r\n\t\tif(!obj.version) return;\r\n\t\t// In the future, if settings change, test against save version\r\n\t\telse {\r\n\t\t\tloadData(obj, this);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport let settings = new Settings();","import { version } from \"./Vars\"\r\nimport { settings } from \"./Settings\"\r\nimport { loadData } from \"./Util\";\r\n\r\ninterface StockAverage {\r\n\tavgValue: number,\r\n\ttotalValue: number\r\n}\r\n\r\nclass SaveData {\r\n\tversion: string\r\n\tstockAverages: StockAverage[]\r\n\tfrozenWrinks: Game.Wrinkler[]\r\n\r\n\tconstructor() {\r\n\t\tthis.version = version;\r\n\t\tthis.stockAverages = [];\r\n\t\tthis.frozenWrinks = null;\r\n\t}\r\n\r\n\tsave() {\r\n\t\tthis.cryosleepWrinklers();\r\n\t\treturn this;\r\n\t}\r\n\r\n\tload(obj: SaveData) {\r\n\t\tloadData(obj, this);\r\n\t\tthis.thawWrinklers();\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.stockAverages = [];\r\n\t\tthis.frozenWrinks = null;\r\n\t}\r\n\r\n\t/** Saves wrinklers to saveData if preserveWrinklers is on */\r\n\tcryosleepWrinklers() {\r\n\t\tif(settings.preserveWrinklers) {\r\n\t\t\tthis.frozenWrinks = Game.wrinklers\r\n\t\t} else {\r\n\t\t\tthis.frozenWrinks = null\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Attempts to restore wrinklers from cryosleep\r\n\t * Does not restore wrinklers if total sucked cookies > 0.1% difference\r\n\t * \r\n\t * @todo Add some kind of offline wrinkler support?\r\n\t */\r\n\tthawWrinklers() {\r\n\t\tif(settings.preserveWrinklers && this.frozenWrinks) {\r\n\t\t\tlet realWrinks = Game.wrinklers;\r\n\t\t\tlet currentWrinks = Game.SaveWrinklers();\r\n\t\t\tGame.wrinklers = this.frozenWrinks;\r\n\t\t\tlet thawedWrinks = Game.SaveWrinklers();\r\n\r\n\t\t\t// If our number of wrinklers has changed, don't run\r\n\t\t\tif(currentWrinks.number != thawedWrinks.number || currentWrinks.shinies != thawedWrinks.shinies)\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\t// Update thawed wrinkler values for how long the game was running\r\n\t\t\tfor(let wrinkler of Game.wrinklers) {\r\n\t\t\t\tif(wrinkler.phase == 2) {\r\n\t\t\t\t\twrinkler.sucked += (Game.cookiesPs/Game.fps)*Game.cpsSucked*Game.loopT;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthawedWrinks = Game.SaveWrinklers();\r\n\r\n\t\t\tlet normalRatio = (currentWrinks.amount == 0 || thawedWrinks.amount == 0)\r\n\t\t\t\t? (currentWrinks.amount == thawedWrinks.amount ? 1 : 0)\r\n\t\t\t\t: Math.min(currentWrinks.amount/thawedWrinks.amount, thawedWrinks.amount/currentWrinks.amount);\r\n\t\t\tlet shinyRatio = (currentWrinks.amountShinies == 0 || thawedWrinks.amountShinies == 0) \r\n\t\t\t\t? (currentWrinks.amountShinies == thawedWrinks.amountShinies ? 1 : 0)\r\n\t\t\t\t: Math.min(currentWrinks.amountShinies/thawedWrinks.amountShinies, thawedWrinks.amountShinies/currentWrinks.amountShinies)\r\n\t\t\t//console.log(Game.T+' '+Game.loopT);\r\n\t\t\t//console.log(currentWrinks.amount + ' ' + thawedWrinks.amount);\r\n\t\t\t//console.log(normalRatio + ' ' + shinyRatio);\r\n\r\n\t\t\t// Allow wrinkler loading if values are within 1% of expected\r\n\t\t\tlet threshold = 0.99;\r\n\t\t\tif(normalRatio < threshold || shinyRatio < threshold) {\r\n\t\t\t\tGame.wrinklers = realWrinks;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport let saveData = new SaveData();","import * as Util from './Util'\r\nimport { saveData } from './SaveData'\r\nimport { settings } from './Settings'\r\nimport { vars } from './Vars'\r\n\r\ndeclare global {\r\n\tinterface Window {\r\n\t\tSpice: any\r\n\t\tSimpleBeautify: Function // WHYYYYYYYYYYYYY\r\n\t}\r\n}\r\n\r\nclass RoutineFunction {\r\n\tfunc: () => void\r\n\tenabled: () => boolean\r\n\tconstructor(func: () => void, enabled: () => boolean = function() { return true; }) {\r\n\t\tthis.func = func;\r\n\t\tthis.enabled = enabled;\r\n\t}\r\n}\r\n\r\nclass Routine {\r\n\troutines: Record<string, RoutineFunction>\r\n\tconstructor(routines: Record<string, RoutineFunction> = {}) { this.routines = routines }\r\n\trun() {\r\n\t\tfor(let r in this.routines) {\r\n\t\t\tif(this.routines[r].enabled && this.routines[r].enabled()) {\r\n\t\t\t\tthis.routines[r].func();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tregister(name: string, func: () => void) {\r\n\t\tthis.routines[name] = new RoutineFunction(func);\r\n\t}\r\n}\r\n\r\nclass RoutineCollection implements Record<string, RoutineFunction> {\r\n\t[routine: string]: RoutineFunction\r\n}\r\n\r\nclass LogicRoutineCollection extends RoutineCollection {\r\n\t/**\r\n\t * Very fancy ascend meter\r\n\t * Basically has to recalculate everything. Thanks game.\r\n\t * At least there's no loops involved so it's not too slow.\r\n\t */\r\n\timproveAscendMeter = new RoutineFunction(function() {\r\n\t\tlet ascendMeter = Game.ascendMeter as HTMLElement; // y o\r\n\t\tlet ascendNumber = Game.ascendNumber as HTMLElement;\r\n\r\n\t\t// Recalculate everything. Thanks game...\r\n\t\tlet chipsOwned=Game.HowMuchPrestige(Game.cookiesReset);\r\n\t\tlet ascendNowToOwn=Math.floor(Game.HowMuchPrestige(Game.cookiesReset+Game.cookiesEarned));\r\n\t\tlet ascendNowToGet=ascendNowToOwn-Math.floor(chipsOwned);\r\n\r\n\t\tlet Spice = window.Spice;\r\n\t\t// Spiced cookies\r\n\t\tif(typeof Spice != 'undefined' && Spice.settings.numericallyStableHeavenlyChipGains) {\r\n\t\t\tif(Spice.additionalHeavenlyChips) {\r\n\t\t\t\t// Stable branch\r\n\t\t\t\tascendNowToGet = Spice.additionalHeavenlyChips();\r\n\t\t\t} else if(Spice.stableHeavenlyChipGains) {\r\n\t\t\t\t// Dev branch\r\n\t\t\t\tascendNowToGet = Spice.stableHeavenlyChipGains();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar nextChipAt=Game.HowManyCookiesReset(Math.floor(chipsOwned+ascendNowToGet+1))-Game.HowManyCookiesReset(Math.floor(chipsOwned+ascendNowToGet));\r\n\t\tvar cookiesToNext=Game.HowManyCookiesReset(ascendNowToOwn+1)-(Game.cookiesEarned+Game.cookiesReset);\r\n\t\tvar percent=1-(cookiesToNext/nextChipAt);\r\n\t\t\r\n\t\tif(!vars.ascendMeterPercent) vars.ascendMeterPercent = percent;\r\n\t\tif(!vars.ascendMeterLevel) vars.ascendMeterLevel = ascendNowToGet;\r\n\t\tif(ascendNowToGet != vars.ascendMeterLevel) {\r\n\t\t\tvars.levelDiff += ascendNowToGet - vars.ascendMeterLevel;\r\n\t\t\tvars.ascendMeterLevel = ascendNowToGet;\r\n\t\t}\r\n\r\n\t\tGame.ascendMeterPercent = vars.ascendMeterPercent;\r\n\r\n\t\t// Adjust by 10% of the level difference each tick\r\n\t\tlet velocity = (vars.levelDiff + percent - Game.ascendMeterPercent) * 0.1;\r\n\t\tGame.ascendMeterPercent += velocity;\r\n\r\n\t\t// Stay at maximum or minimum when going more than a whole bar in a single frame\r\n\t\tlet superspeed = false;\r\n\t\tlet superspeedRev = false;\r\n\t\tif(Game.ascendMeterPercent >= 2) superspeed = true;\r\n\t\tif(Game.ascendMeterPercent <= -1) superspeedRev = true; \r\n\r\n\t\t// Update level difference and fix negative meter values\r\n\t\tif(Game.ascendMeterPercent >= 1) vars.levelDiff -= Math.floor(Game.ascendMeterPercent);\r\n\t\tif(Game.ascendMeterPercent < 0) vars.levelDiff -= Math.floor(Game.ascendMeterPercent);\r\n\t\tif(Game.ascendMeterPercent < 0) Game.ascendMeterPercent = (1 - Math.abs(Game.ascendMeterPercent));\r\n\r\n\t\tGame.ascendMeterPercent %= 1;\r\n\t\tascendMeter.style.transform = '';\r\n\r\n\t\tlet perc = Game.ascendMeterPercent * 100;\r\n\t\tperc = superspeed ? 100 : perc;\r\n\t\tperc = superspeedRev ? 0 : perc;\r\n\r\n\t\tascendMeter.style.width = (perc+'%');\r\n\t\tascendNumber.textContent='+'+window.SimpleBeautify(ascendNowToGet - vars.levelDiff);\r\n\r\n\t\tvars.ascendMeterPercent = Game.ascendMeterPercent;\r\n\t\tascendMeter.style.removeProperty('width');\r\n\t}, () => settings.improveAscendMeter);\r\n\t/**\r\n\t * If enabled, Skruuia modifies wrinkler cookie consumption.\r\n\t * This increases the amount of cookies that get multiplied by the wrinklers.\r\n\t * Mathematically it's the same, but needs Skruuia to stay slotted in.\r\n\t */\r\n\tupdateSkruuiaRebalance = new RoutineFunction(function() {\r\n\t\tlet godEff = 1;\r\n\t\tif(settings.skruuiaRebalance && Game.hasGod) {\r\n\t\t\tlet godLvl = Game.hasGod('scorn');\r\n\t\t\tswitch(godLvl) {\r\n\t\t\t\tcase 1: godEff = 1.15; break;\r\n\t\t\t\tcase 2: godEff = 1.10; break;\r\n\t\t\t\tcase 3: godEff = 1.05; break;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet pantheon = Game.Objects['Temple'].minigame;\r\n\t\tif(pantheon) {\r\n\t\t\tif(typeof pantheon.effs == 'undefined') pantheon.effs = ({} as any);\r\n\t\t\tif(godEff != pantheon.effs['wrinklerEat']) Game.recalculateGains = 1;\r\n\t\t\tpantheon.effs['wrinklerEat'] = godEff;\r\n\t\t}\r\n\t});\r\n\r\n\t/** In enhanced bulk mode, refresh store every 10 frames */\r\n\tbulkStoreRefresh = new RoutineFunction(\r\n\t\t() => Game.storeToRefresh = 1, \r\n\t\t() => settings.enhancedBulk && Game.T%10==0\r\n\t);\r\n}\r\nclass LogicRoutine extends Routine { routines: LogicRoutineCollection }\r\nexport let logicRoutine = new LogicRoutine(new LogicRoutineCollection());\r\n\r\nclass DrawRoutineCollection extends RoutineCollection {\r\n\t/** Update icon of milk selector when switching milk types */\r\n\tupdateMilkIcon = new RoutineFunction(function() {\r\n\t\tif(Game.milkType == 0 && Game.Milk != vars.lastAutoMilk) {\r\n\t\t\tUtil.switchMilkIcon(0);\r\n\t\t\tvars.lastAutoMilk = Game.Milk;\r\n\t\t} else if(Game.milkType != vars.lastMilk) {\r\n\t\t\tUtil.switchMilkIcon(Game.milkType);\r\n\t\t\tvars.lastMilk = Game.milkType;\r\n\t\t}\r\n\t}, () => settings.fancyMilkSelect)\r\n\r\n\t/** Fixes the graphics on the grimoire magic meter */\r\n\tgrimoireMeterFix = new RoutineFunction(function() {\r\n\t\tthis.hasRun = true;\r\n\r\n\t\tlet magicBar = document.getElementById('grimoireBar');\r\n\t\tif(magicBar) {\r\n\t\t\tlet magicMeter = document.getElementById('grimoireBarFull');\r\n\t\t\tif(magicBar.className.includes('meterContainer')) {\r\n\t\t\t\t// Apply horizontal scaling as well as vertical scaling\r\n\t\t\t\tmagicMeter.style.height = '8px';\r\n\t\t\t\tmagicMeter.style.transform = 'scale(2,2)';\r\n\t\t\t\tmagicMeter.style.transformOrigin = '0 0';\r\n\t\t\t\t\r\n\t\t\t\t// Set up a new container element that can hide the overflow\r\n\t\t\t\tlet div = document.createElement('div');\r\n\t\t\t\tdiv.className = magicBar.className;\r\n\t\t\t\tdiv.style.overflow = 'hidden';\r\n\t\t\t\tdiv.style.height = '100%';\r\n\r\n\t\t\t\tmagicBar.className = '';\r\n\t\t\t\tmagicBar.style.position = 'relative';\r\n\t\t\t\tmagicBar.replaceChild(div, magicMeter);\r\n\t\t\t\tdiv.appendChild(magicMeter);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Since we're using double width sprites now, better halve the real width\r\n\t\t\tmagicMeter.style.width = Number.parseFloat(magicMeter.style.width)/2 + '%';\r\n\t\t}\r\n\t}, function() { return settings.improveMagicMeter || this.hasRun; })\r\n\r\n\t/** Rotates Cyclius along with his current cycle */\r\n\ttrueCyclius = new RoutineFunction(function() {\r\n\t\tlet cyclius = document.getElementById('templeGod3');\r\n\t\tif(cyclius) {\r\n\t\t\tlet icon = (cyclius.getElementsByClassName('usesIcon')[0] as HTMLElement);\r\n\t\t\tlet slot = Game.hasGod('ages');\r\n\t\t\tif(slot) {\r\n\t\t\t\t// Modify the icon styling so the drop shadow doesn't move\r\n\t\t\t\t// Simply places the animation on a div and puts the icon in it\r\n\t\t\t\tif(icon.classList.contains('shadowFilter')) {\r\n\t\t\t\t\tlet div = document.createElement('div');\r\n\t\t\t\t\tdiv.classList.add('templeIcon');\r\n\t\t\t\t\tdiv.classList.add('shadowFilter');\r\n\t\t\t\t\tdiv.style.margin = 'unset';\r\n\t\t\t\t\ticon.classList.remove('shadowFilter');\r\n\t\t\t\t\ticon.style.animation = 'none';\r\n\t\t\t\t\tcyclius.removeChild(icon);\r\n\t\t\t\t\tcyclius.appendChild(div);\r\n\t\t\t\t\tdiv.appendChild(icon);\r\n\t\t\t\t\tvars.patchedTrueCyclius = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet interval = 0;\r\n\t\t\t\tlet rotation = 0;\r\n\t\t\t\tif(settings.trueCyclius) {\r\n\t\t\t\t\tswitch(slot) {\r\n\t\t\t\t\t\tcase 1: interval = 3; break;\r\n\t\t\t\t\t\tcase 2: interval = 12; break;\r\n\t\t\t\t\t\tcase 3: interval = 24; break;\r\n\t\t\t\t\t}\r\n\t\t\t\t\trotation = Util.cycliusCalc(interval, settings.zonedCyclius) - Math.PI/2;\r\n\t\t\t\t\ticon.style.setProperty('transform', `rotate(${rotation}rad)`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ticon.style.removeProperty('transform');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif(vars.patchedTrueCyclius) icon.style.removeProperty('transform');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvars.patchedTrueCyclius = false;\r\n\t\t}\r\n\t})\r\n}\r\nclass DrawRoutine extends Routine { routines: DrawRoutineCollection }\r\nexport let drawRoutine = new DrawRoutine(new DrawRoutineCollection());\r\n\r\nclass ResetRoutineCollection extends RoutineCollection {\r\n\t/** Resets the save-specific data */\r\n\tresetSaveData = new RoutineFunction(() => saveData.reset())\r\n\r\n\t/** Sets the scroll of all buildings to 0 */\r\n\tresetScroll = new RoutineFunction(function() {\r\n\t\tfor(let name in Game.Objects) {\r\n\t\t\tlet obj: any = Game.Objects[name];\r\n\t\t\tif(obj.scrollOffX) obj.scrollOffX = 0;\r\n\t\t}\r\n\t})\r\n}\r\nclass ResetRoutine extends Routine { routines: ResetRoutineCollection }\r\nexport let resetRoutine = new ResetRoutine(new ResetRoutineCollection());","import { saveData as _saveData } from \"./SaveData\"\nimport { settings as _settings } from \"./Settings\"\nimport * as _Logger from './Logger'\nimport * as _Util from './Util'\nimport * as _Config from './Config'\nimport * as _Patches from './Patches'\nimport * as _Vars from \"./Vars\"\nimport * as _Routines from \"./Routines\"\nimport * as _GrandmaSupport from \"./GrandmaSupport\"\n\nexport let name = _Vars.name\nexport let version = _Vars.version\n\nexport let Util = _Util\nexport let Config = _Config\nexport let Patches = _Patches\nexport let Logger = _Logger\nexport let Routines = _Routines\nexport let GrandmaSupport = _GrandmaSupport\n\nexport let vars = _Vars.vars\nexport let settings = _settings\nexport let saveData = _saveData\n\n//#region easter eggs lul\nlet grandmaDesc = [\n\tchoose([`nice grandmas`, `hard-working grandmas`, `old ladies`]),\n\t`farmers`,\n\t`miners`,\n\t`workers`,\n\tchoose([`bankers`, `brokers`, `financial advisors`, `accountants`]),\n\t`priestesses`,\n\t`witches`,\n\tchoose([`aliens`, `bounty hunters`, `spice traders`, `kessel runners`]),\n\t`alchemists`,\n\tchoose([`elder abominations`, `flesh piles`, `doughy beings`]),\n\tchoose([`time policemas`, `nice old lady's nice old ladies`]),\n\t`antimatter constructs`,\n\t`living rainbows`,\n\t`leprechauns`,\n\t`Cyriak wannabes`,\n\tchoose([`NaNnies`, `[Error: cookie is not defined]s`, `['g','r','a','n']s`]),\n\tchoose([`spaghetti bakers`, `pancake flippers`, `not-cookie productionists`, `pastry panhandlers`])\n]\nlet buildingChoice = choose(Game.ObjectsById);\nif(buildingChoice == Game.Objects['Cursor']) buildingChoice = Game.Objects['Grandma'];\nlet numGrandmas = 0;\nif(buildingChoice == Game.Objects['Grandma']) numGrandmas = Game.Objects['Grandma'].amount;\nelse numGrandmas = Util.getNumSynergyGrandmas(buildingChoice);\nlet grandmaMessage = `Your ${numGrandmas} ${grandmaDesc[buildingChoice.id-1]} missed you!`\nif(buildingChoice.amount == 0 || numGrandmas <= 0) {\n\tgrandmaMessage = `. . . but nobody came`\n}\nlet startupMessages = [\n\t`And then he said,<br>'Let there be cookies'`,\n\t`Some dude called ${choose(['theGameMaster1234', 'RobotLucca', 'gamrguy', 'theMineMaster2', 'DeadlyFez'])} made this`,\n\t`That ascend meter was getting antsy`,\n\tgrandmaMessage,\n\t`The cookies have eyes.<br>Watch yourself out there`,\n\t`Over the river and through the cookies`,\n\t//`Originally, the name was referring to the building scroll feature, which was the first feature I made. Now it probably more accurately refers to the large and slightly random scope of this mod. Despite this I don't think the name is going to change anytime soon, so you had better get used to it. I wonder if anyone can read this fast? If you're reading this and can, how's your day been? It's lonely back here.`,\n\t`Thank you for choosing the Typescript edition of Omniscient Cookies!<br>(No warranties, no refunds)`,\n\t`What do Omniscient Cookies taste like?<br>Study reveals a flavor 'somewhere between amateur Javascript and messy programming'`,\n\t`Also try <a href=\"https://github.com/staticvariablejames/SpicedCookies/\" target=\"_blank\">Spiced Cookies</a>!`,\n\t`You stared into the cookie,<br>and the cookie stared back`,\n\t`Check out the <a href=\"https://github.com/gamrguy/OmniscientCookies/\" target=\"_blank\">GitHub page</a>!`\n]\n//#endregion\n\nexport let mod: Game.Mod = {\n\tinit: function() {\n\t\tPatches.smoothBuildings.apply();\n\t\tPatches.scrollingBuildings.apply();\n\t\tPatches.buffTooltips.apply();\n\t\tPatches.updateMenu.apply();\n\t\tPatches.tooltipWobble.apply();\n\t\tPatches.cycliusGains.apply();\n\t\tPatches.stockInfo.apply();\n\t\tPatches.fancyBuildings.apply();\n\t\tPatches.fancyCursors.apply();\n\t\tPatches.fancyWrinklers.apply();\n\t\tPatches.skruuiaRebalance.apply();\n\t\tPatches.dangerousStocks.apply();\n\t\tPatches.cycliusInfo.apply();\n\t\n\t\tGame.registerHook('logic', () => Routines.logicRoutine.run());\n\t\tGame.registerHook('draw', () => Routines.drawRoutine.run());\n\t\tGame.registerHook('reset', (hard) => Routines.resetRoutine.run());\n\t\t\n\t\tGame.Notify(`Loaded ${name} ${version}`, '<q>' + choose(startupMessages) + '</q>', [10, 31], 6);\n\t},\n\t\n\tsave: function() {\n\t\treturn JSON.stringify({\n\t\t\tsettings: settings.save(),\n\t\t\tsaveData: saveData.save()\n\t\t});\n\t},\n\t\n\tload: function(str) {\n\t\tlet data = JSON.parse(str);\n\t\tsettings.load(data.settings);\n\t\tsaveData.load(data.saveData);\n\t\n\t\tPatches.buySellBulk.apply();\n\t\n\t\tPatches.scrollbarStyle.toggle(settings.autoScrollbar);\n\t\tPatches.buildingTooltips.toggle(settings.betterBuildingTooltips);\n\t\tPatches.miscGrandmaFixes.toggle(settings.betterGrandmas);\n\t\tPatches.cursedFingerTweaks.toggle(settings.cursedFinger);\n\t\tPatches.displaySeasonUnlock.toggle(settings.displaySeasons);\n\t\tPatches.statsUpgradeCategories.toggle(settings.separateTechs || settings.separateSeasons);\n\t\tPatches.optiCookies.toggle(settings.optiCookies);\n\t\tPatches.dangerousBrokers.toggle(settings.dangerousBrokers);\n\t}\n}","import * as OmniCookies from './OmniCookies'\n\ndeclare global {\n\tinterface Window {\n\t\tOmniCookies: object\n\t}\n}\n\nlet OmniCookiesExport: any\nif(window.OmniCookies) {\n\tOmniCookies.Logger.warn(\"Mod loaded twice???\")\n\tOmniCookiesExport = window.OmniCookies\n} else {\n\tGame.registerMod(OmniCookies.name, OmniCookies.mod)\n\tOmniCookiesExport = OmniCookies\n\twindow.OmniCookies = OmniCookies;\n}\n\nexport default OmniCookiesExport;"],"names":["Math","E","sin","abs","PI","max","floor","min","log","message","console","warn","error","replaceCode","targetFunction","listReplacements","preEvalScript","code","toString","newCode","i","patt","pattern","repl","replacement","includes","match","Logger.warn","replace","func","eval","calcMaxBuyBulk","building","amount","totalPrice","maxPrice","maxAmount","Game","cookies","quickCalcBulkPrice","quickCalcMaxBuy","free","modifyBuildingPrice","name","basePrice","boughtCount","priceInc","priceIncrease","bulk","sell","sum","ceil","buildingCount","powerSumRange","getSellMultiplier","x","start","end","sum1","sum2","cycliusCalc","interval","zoned","cycle","Date","now","getTimezoneOffset","loadData","data","into","key","_a","Object","keys","_i","switchMilkIcon","milkID","milkSelect","Upgrades","icon","Milk","choicesFunction","upgradesToRebuild","getNumSynergyGrandmas","grandma","bought","Objects","id","gainInstantPassiveCpS","seconds","wrinkler","cookiesPs","wrinklers","phase","sucked","cpsSucked","cookiesSucked","obj","_c","ObjectsById","_b","totalCookies","storedTotalCps","globalCpsMult","Earn","scrollbarStyle","style","center","document","getElementById","overflowY","onMinigameLoaded","setInterval","minigameLoaded","clearInterval","loadCustomAsset","img","Loader","assetsLoading","assetsLoaded","assets","Replace","push","holdingButton","btn","customOptionsMenu","onMenu","frag","menuDisplay","display","l","childNodes","insertBefore","length","registerSupport","props","grandmaProperties","grandmaAmountCalc","num","freq","lastPerc","count","tryDrawGrandmas","basePic","frequency","currentGrandmas","Util.getNumSynergyGrandmas","drawnGrandmas","prevDrawnGrandmas","grandmas","concat","drawGrandma","ButtonType","version","vars","lastMilk","lastAutoMilk","buffsById","cursedPs","cursedPsMult","ascendMeterLevel","ascendMeterPercent","levelDiff","patchedTrueCyclius","prevShortcut","BypassFancySetting","autoScrollbar","scrollingBuildings","smoothBuildings","buffTooltipDuration","betterBuildingTooltips","betterGrandmas","separateTechs","enhancedBulk","buildingsBypassFancy","Default","cursorsBypassFancy","wrinklersBypassFancy","optimizeBuildings","preserveWrinklers","detailedCyclius","zonedCyclius","trueCyclius","stockValueData","dangerousStocks","tooltipWobble","fancyMilkSelect","improveMagicMeter","skruuiaRebalance","improveAscendMeter","displaySeasons","separateSeasons","bringGrandmaToWork","cursedFinger","optiCookies","dangerousBrokers","Settings","setting","value","settings","stockAverages","frozenWrinks","SaveData","cryosleepWrinklers","thawWrinklers","realWrinks","currentWrinks","SaveWrinklers","thawedWrinks","number","shinies","fps","loopT","normalRatio","shinyRatio","amountShinies","threshold","saveData","patchFunc","removeFunc","applied","Patch","force","toState","apply","remove","Util.scrollbarStyle","updateMenu","UpdateMenu","Util.replaceCode","DrawBuildings","drawPattern","mutePattern","redrawPattern","scrollOffX","lastRandX","lastRandY","lastOffX","lastMouseOn","mouseOn","lastAmount","lastSynergyAmount","hasUnloadedImages","forceDraw","draw","mute","redraw","art","pic","buildingTooltips","tooltipPattern","tooltip","buffTooltips","buff","buffs","onmouseover_1","mouseDown","setOnCrate","dynamic","GetBuffTooltipFunc","wobble","buffsL","getElementsByClassName","setAttribute","gainBuff","substr","div","createElement","className","test","appendChild","visibility","buffId","textContent","width","clientWidth","buffDesc","desc","sayTime","maxTime","text","time","patchGrimoire","minigame","spells","win","miscGrandmaFixes","GrandmaSynergies","upgrade","baseDesc","order","sort","a","b","scriptGrannies","buyFunction","statsUpgradeCategories","displaySeasonUnlock","addCosmeticSeason","season","unlockAt","displaySeason","allSanta","santaDrops","slice","crateTooltip","name_1","reindeerDrops","name_2","allSanta_1","name_3","_d","halloweenDrops","name_4","_f","easterEggs","_e","UpdateWrinklers","cursedFingerTweaks","buffTypesByName","cursedFingerPart2","cursedBuff","hasBuff","multCpS","recalculateGains","power","CalculateGains","bigCookie","removeEventListener","ClickCookie","AddEvent","cycliusGains","stockInfo","Util.onMinigameLoaded","stockMarket","buyGood","sellGood","drawGraph","toRedraw","fancyBuildings","Draw","fancyCursors","DrawBackground","fancyWrinklers","window","inRect","y","rect","cos","dx","r","h","o","dy","h1","sqrt","currA","atan2","newA","x2","y2","w","buySellBulk","rebuildPattern","refreshPattern","rebuild","refresh","storeBulkButton","Logic","updateBulkAll","buyMode","buyBulk","RefreshStore","cycliusInfo","pantheon","functionPattern","godTooltip","slotTooltip","cycliusFunc","effect","mult","Util.cycliusCalc","color","sign","Beautify","cyclius","gods","toggleCyclius","desc1","desc2","desc3","activeDescFunc","activeDescBackup","getSumPrice","Util.quickCalcBulkPrice","getReverseSumPrice","market","brokerButton","parent","parentElement","newButton","classList","add","innerHTML","onclick","e","brokers","getMaxBrokers","getBrokerPrice","Spend","profit","PlaySound","SparkleOn","target","settingName","options","OptionedButton","set","selected","buttonId","off","sett","opt","toggleFunction","label","element","onOption","offOption","_super","_this","__extends","Header","padding","opacity","fontSize","fontFamily","createTextNode","Title","title","elements","Listing","ConfigMenu","createDocumentFragment","BooleanButton","Patches.buildingTooltips","Patches.miscGrandmaFixes","Patches.statsUpgradeCategories","Patches.displaySeasonUnlock","Util.switchMilkIcon","tt","ascendMeter","removeProperty","Patches.updateBulkAll","Patches.dangerousBrokers","Patches.toggleCyclius","Patches.cursedFingerTweaks","Patches.optiCookies","enabled","routines","Routine","RoutineFunction","ascendNumber","chipsOwned","HowMuchPrestige","cookiesReset","ascendNowToOwn","cookiesEarned","ascendNowToGet","Spice","numericallyStableHeavenlyChipGains","additionalHeavenlyChips","stableHeavenlyChipGains","nextChipAt","HowManyCookiesReset","cookiesToNext","percent","velocity","superspeed","superspeedRev","transform","perc","SimpleBeautify","godEff","hasGod","godLvl","effs","storeToRefresh","T","RoutineCollection","logicRoutine","LogicRoutine","LogicRoutineCollection","milkType","Number","parseFloat","hasRun","magicBar","magicMeter","height","transformOrigin","overflow","position","replaceChild","slot","contains","margin","animation","removeChild","rotation","setProperty","drawRoutine","DrawRoutine","DrawRoutineCollection","reset","resetRoutine","ResetRoutine","ResetRoutineCollection","random","z","frame","dir","toFixed","Util.loadCustomAsset","realID","prevX","prevID","prevY","_Vars.version","Util","_Util","Config","_Config","Patches","_Patches","Logger","_Logger","Routines","_Routines","GrandmaSupport","_GrandmaSupport","_Vars.vars","_settings","_saveData","grandmaDesc","choose","buildingChoice","numGrandmas","grandmaMessage","OmniCookiesExport","startupMessages","mod","init","registerHook","run","Notify","save","JSON","stringify","load","str","parse","toggle","OmniCookies","OmniCookies.Logger","registerMod","OmniCookies.name","OmniCookies.mod"],"mappings":"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"}